---
import DocsLayout from '../../../layouts/DocsLayout.astro';

const content = "<p>\n> <strong>Status: Design spec - not yet implemented</strong>\n</p>\n<p>\n> Multi-workspace coordination for Gas Town and Beads\n</p>\n<h2>Overview</h2>\n<p>\nFederation enables multiple Gas Town instances to reference each other's work,\ncoordinate across organizations, and track distributed projects.\n</p>\n<h2>Why Federation?</h2>\n<p>\nReal enterprise projects don't live in a single repo:\n</p>\n<ul><li><strong>Microservices:</strong> 50 repos, tight dependencies, coordinated releases</li>\n<li><strong>Platform teams:</strong> Shared libraries used by dozens of downstream projects</li>\n<li><strong>Contractors:</strong> External teams working on components you need to track</li>\n<li><strong>Acquisitions:</strong> New codebases that need to integrate with existing work</li>\n</ul>\n<p>\nTraditional tools force you to choose: unified tracking (monorepo) or team\nautonomy (multi-repo with fragmented visibility). Federation provides both:\neach workspace is autonomous, but cross-workspace references are first-class.\n</p>\n<h2>Entity Model</h2>\n<h3>Three Levels</h3>\n<p>\n<pre><code class=\"language-text\">Level 1: Entity    - Person or organization (flat namespace)\nLevel 2: Chain     - Workspace/town per entity\nLevel 3: Work Unit - Issues, tasks, molecules on chains</code></pre>\n</p>\n<h3>URI Scheme</h3>\n<p>\nFull work unit reference (HOP protocol):\n</p>\n<p>\n<pre><code class=\"language-text\">hop://entity/chain/rig/issue-id\nhop://steve@example.com/main-town/greenplace/gp-xyz</code></pre>\n</p>\n<p>\nCross-repo reference (same platform):\n</p>\n<p>\n<pre><code class=\"language-text\">beads://platform/org/repo/issue-id\nbeads://github/acme/backend/ac-123</code></pre>\n</p>\n<p>\nWithin a workspace, short forms are preferred:\n</p>\n<p>\n<pre><code class=\"language-text\">gp-xyz             # Local (prefix routes via routes.jsonl)\ngreenplace/gp-xyz  # Different rig, same chain\n./gp-xyz           # Explicit current-rig ref</code></pre>\n</p>\n<p>\nSee <code>~/gt/docs/hop/GRAPH-ARCHITECTURE.md</code> for full URI specification.\n</p>\n<h2>Relationship Types</h2>\n<h3>Employment</h3>\n<p>\nTrack which entities belong to organizations:\n</p>\n<p>\n<pre><code class=\"language-json\">{\n  &quot;type&quot;: &quot;employment&quot;,\n  &quot;entity&quot;: &quot;alice@example.com&quot;,\n  &quot;organization&quot;: &quot;acme.com&quot;\n}</code></pre>\n</p>\n<h3>Cross-Reference</h3>\n<p>\nReference work in another workspace:\n</p>\n<p>\n<pre><code class=\"language-json\">{\n  &quot;references&quot;: [\n    {\n      &quot;type&quot;: &quot;depends_on&quot;,\n      &quot;target&quot;: &quot;hop://other-entity/chain/rig/issue-id&quot;\n    }\n  ]\n}</code></pre>\n</p>\n<h3>Delegation</h3>\n<p>\nDistribute work across workspaces:\n</p>\n<p>\n<pre><code class=\"language-json\">{\n  &quot;type&quot;: &quot;delegation&quot;,\n  &quot;parent&quot;: &quot;hop://acme.com/projects/proj-123&quot;,\n  &quot;child&quot;: &quot;hop://alice@example.com/town/greenplace/gp-xyz&quot;,\n  &quot;terms&quot;: { &quot;portion&quot;: &quot;backend&quot;, &quot;deadline&quot;: &quot;2025-02-01&quot; }\n}</code></pre>\n</p>\n<h2>Agent Provenance</h2>\n<p>\nEvery agent operation is attributed. See <a href=\"/docs/concepts/identity\">Identity</a> for the\ncomplete BD_ACTOR format convention.\n</p>\n<h3>Git Commits</h3>\n<p>\n<pre><code class=\"language-bash\"># Set per agent session\nGIT_AUTHOR_NAME=&quot;greenplace/crew/joe&quot;\nGIT_AUTHOR_EMAIL=&quot;steve@example.com&quot;  # Workspace owner</code></pre>\n</p>\n<p>\nResult: <code>abc123 Fix bug (greenplace/crew/joe &lt;steve@example.com&gt;)</code>\n</p>\n<h3>Beads Operations</h3>\n<p>\n<pre><code class=\"language-bash\">BD_ACTOR=&quot;greenplace/crew/joe&quot;  # Set in agent environment\nbd create --title=&quot;Task&quot;        # Actor auto-populated</code></pre>\n</p>\n<h3>Event Logging</h3>\n<p>\nAll events include actor:\n</p>\n<p>\n<pre><code class=\"language-json\">{\n  &quot;ts&quot;: &quot;2025-01-15T10:30:00Z&quot;,\n  &quot;type&quot;: &quot;sling&quot;,\n  &quot;actor&quot;: &quot;greenplace/crew/joe&quot;,\n  &quot;payload&quot;: { &quot;bead&quot;: &quot;gp-xyz&quot;, &quot;target&quot;: &quot;greenplace/polecats/Toast&quot; }\n}</code></pre>\n</p>\n<h2>Discovery</h2>\n<h3>Workspace Metadata</h3>\n<p>\nEach workspace has identity metadata:\n</p>\n<p>\n<pre><code class=\"language-json\">// ~/gt/.town.json\n{\n  &quot;owner&quot;: &quot;steve@example.com&quot;,\n  &quot;name&quot;: &quot;main-town&quot;,\n  &quot;public_name&quot;: &quot;steve-greenplace&quot;\n}</code></pre>\n</p>\n<h3>Remote Registration</h3>\n<p>\n<pre><code class=\"language-bash\">gt remote add acme hop://acme.com/engineering\ngt remote list</code></pre>\n</p>\n<h3>Cross-Workspace Queries</h3>\n<p>\n<pre><code class=\"language-bash\">bd show hop://acme.com/eng/ac-123    # Fetch remote issue\nbd list --remote=acme                # List remote issues</code></pre>\n</p>\n<h2>Aggregation</h2>\n<p>\nQuery across relationships without hierarchy:\n</p>\n<p>\n<pre><code class=\"language-bash\"># All work by org members\nbd list --org=acme.com\n\n# All work on a project (including delegated)\nbd list --project=proj-123 --include-delegated\n\n# Agent's full history\nbd audit --actor=greenplace/crew/joe</code></pre>\n</p>\n<h2>Implementation Status</h2>\n<ul><li>[x] Agent identity in git commits</li>\n<li>[x] BD_ACTOR default in beads create</li>\n<li>[x] Workspace metadata file (.town.json)</li>\n<li>[x] Cross-workspace URI scheme (hop://, beads://, local forms)</li>\n<li>[ ] Remote registration</li>\n<li>[ ] Cross-workspace queries</li>\n<li>[ ] Delegation primitives</li>\n</ul>\n<h2>Use Cases</h2>\n<h3>Multi-Repo Projects</h3>\n<p>\nTrack work spanning multiple repositories:\n</p>\n<p>\n<pre><code class=\"language-text\">Project X\n├── hop://team/frontend/fe-123\n├── hop://team/backend/be-456\n└── hop://team/infra/inf-789</code></pre>\n</p>\n<h3>Distributed Teams</h3>\n<p>\nTeam members in different workspaces:\n</p>\n<p>\n<pre><code class=\"language-text\">Alice's Town → works on → Project X\nBob's Town   → works on → Project X</code></pre>\n</p>\n<p>\nEach maintains their own CV/audit trail.\n</p>\n<h3>Contractor Coordination</h3>\n<p>\nPrime contractor delegates to subcontractors:\n</p>\n<p>\n<pre><code class=\"language-text\">Acme/Project\n└── delegates to → Vendor/SubProject\n                   └── delegates to → Contractor/Task</code></pre>\n</p>\n<p>\nCompletion cascades up. Attribution preserved.\n</p>\n<h2>Design Principles</h2>\n<ol><li><strong>Flat namespace</strong> - Entities not nested, relationships connect them</li>\n<li><strong>Relationships over hierarchy</strong> - Graph structure, not tree</li>\n<li><strong>Git-native</strong> - Federation uses git mechanics (remotes, refs)</li>\n<li><strong>Incremental</strong> - Works standalone, gains power with federation</li>\n<li><strong>Privacy-preserving</strong> - Each entity controls their chain visibility</li>\n</ol>\n<h2>Enterprise Benefits</h2>\n<table><tr><td>Challenge</td><td>Without Federation</td><td>With Federation</td></tr>\n</table>\n<table><tr><td>Cross-repo dependencies</td><td>\"Check with backend team\"</td><td>Explicit dependency tracking</td></tr>\n<tr><td>Contractor visibility</td><td>Email updates, status calls</td><td>Live status, same tooling</td></tr>\n<tr><td>Release coordination</td><td>Spreadsheets, Slack threads</td><td>Unified timeline view</td></tr>\n<tr><td>Agent attribution</td><td>Per-repo, fragmented</td><td>Cross-workspace CV</td></tr>\n<tr><td>Compliance audit</td><td>Stitch together logs</td><td>Query across workspaces</td></tr>\n</table>\n<p>\nFederation isn't just about connecting repos - it's about treating distributed\nengineering as a first-class concern, with the same visibility and tooling\nyou'd expect from a monorepo, while preserving team autonomy.\n</p>";
---

<DocsLayout title="Federation Architecture" description="> **Status: Design spec - not yet implemented**">
  <div class="markdown-content" set:html={content} />
</DocsLayout>
