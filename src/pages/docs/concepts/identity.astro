---
import DocsLayout from '../../../layouts/DocsLayout.astro';

const content = "<p>\n> Canonical format for agent identity in Gas Town\n</p>\n<h2>Why Identity Matters</h2>\n<p>\nWhen you deploy AI agents at scale, anonymous work creates real problems:\n</p>\n<ul><li><strong>Debugging:</strong> \"The AI broke it\" isn't actionable. <em>Which</em> AI?</li>\n<li><strong>Quality tracking:</strong> You can't improve what you can't measure.</li>\n<li><strong>Compliance:</strong> Auditors ask \"who approved this code?\" - you need an answer.</li>\n<li><strong>Performance management:</strong> Some agents are better than others at certain tasks.</li>\n</ul>\n<p>\nGas Town solves this with <strong>universal attribution</strong>: every action, every commit,\nevery bead update is linked to a specific agent identity. This enables work\nhistory tracking, capability-based routing, and objective quality measurement.\n</p>\n<h2>BD_ACTOR Format Convention</h2>\n<p>\nThe <code>BD_ACTOR</code> environment variable identifies agents in slash-separated path format.\nThis is set automatically when agents are spawned and used for all attribution.\n</p>\n<h3>Format by Role Type</h3>\n<table><tr><td>Role Type</td><td>Format</td><td>Example</td></tr>\n</table>\n<table><tr><td><strong>Mayor</strong></td><td><code>mayor</code></td><td><code>mayor</code></td></tr>\n<tr><td><strong>Deacon</strong></td><td><code>deacon</code></td><td><code>deacon</code></td></tr>\n<tr><td><strong>Witness</strong></td><td><code>{rig}/witness</code></td><td><code>gastown/witness</code></td></tr>\n<tr><td><strong>Refinery</strong></td><td><code>{rig}/refinery</code></td><td><code>gastown/refinery</code></td></tr>\n<tr><td><strong>Crew</strong></td><td><code>{rig}/crew/{name}</code></td><td><code>gastown/crew/joe</code></td></tr>\n<tr><td><strong>Polecat</strong></td><td><code>{rig}/polecats/{name}</code></td><td><code>gastown/polecats/toast</code></td></tr>\n</table>\n<h3>Why Slashes?</h3>\n<p>\nThe slash format mirrors filesystem paths and enables:\n</p>\n<ul><li>Hierarchical parsing (extract rig, role, name)</li>\n<li>Consistent mail addressing (<code>gt mail send gastown/witness</code>)</li>\n<li>Path-like routing in beads operations</li>\n<li>Visual clarity about agent location</li>\n</ul>\n<h2>Attribution Model</h2>\n<p>\nGas Town uses three fields for complete provenance:\n</p>\n<h3>Git Commits</h3>\n<pre><code class=\"language-bash\">GIT_AUTHOR_NAME=&quot;gastown/crew/joe&quot;      # Who did the work (agent)\n<p>\nGIT_AUTHOR_EMAIL=&quot;steve@example.com&quot;    # Who owns the work (overseer)</code></pre>\n</p>\n<p>\nResult in git log:\n</p>\n<pre><code class=\"language-text\">abc123 Fix bug (gastown/crew/joe &lt;steve@example.com&gt;)</code></pre>\n<strong>Interpretation</strong>:\n<ul><li>The agent <code>gastown/crew/joe</code> authored the change</li>\n<li>The work belongs to the workspace owner (<code>steve@example.com</code>)</li>\n<li>Both are preserved in git history forever</li>\n</ul>\n<h3>Beads Records</h3>\n<pre><code class=\"language-json\">{\n<p>\n  &quot;id&quot;: &quot;gt-xyz&quot;,\n  &quot;created_by&quot;: &quot;gastown/crew/joe&quot;,\n  &quot;updated_by&quot;: &quot;gastown/witness&quot;\n}</code></pre>\n</p>\n<p>\nThe <code>created_by</code> field is populated from <code>BD_ACTOR</code> when creating beads.\nThe <code>updated_by</code> field tracks who last modified the record.\n</p>\n<h3>Event Logging</h3>\n<p>\nAll events include actor attribution:\n</p>\n<pre><code class=\"language-json\">{\n<p>\n  &quot;ts&quot;: &quot;2025-01-15T10:30:00Z&quot;,\n  &quot;type&quot;: &quot;sling&quot;,\n  &quot;actor&quot;: &quot;gastown/crew/joe&quot;,\n  &quot;payload&quot;: { &quot;bead&quot;: &quot;gt-xyz&quot;, &quot;target&quot;: &quot;gastown/polecats/toast&quot; }\n}</code></pre>\n</p>\n<h2>Environment Setup</h2>\n<p>\nGas Town uses a centralized <code>config.AgentEnv()</code> function to set environment\nvariables consistently across all agent spawn paths (managers, daemon, boot).\n</p>\n<h3>Example: Polecat Environment</h3>\n<pre><code class=\"language-bash\"># Set automatically for polecat 'toast' in rig 'gastown'\n<p>\nexport GT_ROLE=&quot;polecat&quot;\nexport GT_RIG=&quot;gastown&quot;\nexport GT_POLECAT=&quot;toast&quot;\nexport BD_ACTOR=&quot;gastown/polecats/toast&quot;\nexport GIT_AUTHOR_NAME=&quot;gastown/polecats/toast&quot;\nexport GT_ROOT=&quot;/home/user/gt&quot;\nexport BEADS_DIR=&quot;/home/user/gt/gastown/.beads&quot;\nexport BEADS_AGENT_NAME=&quot;gastown/toast&quot;\nexport BEADS_NO_DAEMON=&quot;1&quot;  # Polecats use isolated beads context</code></pre>\n</p>\n<h3>Example: Crew Environment</h3>\n<pre><code class=\"language-bash\"># Set automatically for crew member 'joe' in rig 'gastown'\n<p>\nexport GT_ROLE=&quot;crew&quot;\nexport GT_RIG=&quot;gastown&quot;\nexport GT_CREW=&quot;joe&quot;\nexport BD_ACTOR=&quot;gastown/crew/joe&quot;\nexport GIT_AUTHOR_NAME=&quot;gastown/crew/joe&quot;\nexport GT_ROOT=&quot;/home/user/gt&quot;\nexport BEADS_DIR=&quot;/home/user/gt/gastown/.beads&quot;\nexport BEADS_AGENT_NAME=&quot;gastown/joe&quot;\nexport BEADS_NO_DAEMON=&quot;1&quot;  # Crew uses isolated beads context</code></pre>\n</p>\n<h3>Manual Override</h3>\n<p>\nFor local testing or debugging:\n</p>\n<pre><code class=\"language-bash\">export BD_ACTOR=&quot;gastown/crew/debug&quot;\n<p>\nbd create --title=&quot;Test issue&quot;  # Will show created_by: gastown/crew/debug</code></pre>\n</p>\n<p>\nSee <a href=\"reference.md#environment-variables\">reference.md</a> for the complete\nenvironment variable reference.\n</p>\n<h2>Identity Parsing</h2>\n<p>\nThe format supports programmatic parsing:\n</p>\n<pre><code class=\"language-go\">// identityToBDActor converts daemon identity to BD_ACTOR format\n<p>\n// Town level: mayor, deacon\n// Rig level: {rig}/witness, {rig}/refinery\n// Workers: {rig}/crew/{name}, {rig}/polecats/{name}</code></pre>\n</p>\n<table><tr><td>Input</td><td>Parsed Components</td></tr>\n</table>\n<table><tr><td><code>mayor</code></td><td>role=mayor</td></tr>\n<tr><td><code>deacon</code></td><td>role=deacon</td></tr>\n<tr><td><code>gastown/witness</code></td><td>rig=gastown, role=witness</td></tr>\n<tr><td><code>gastown/refinery</code></td><td>rig=gastown, role=refinery</td></tr>\n<tr><td><code>gastown/crew/joe</code></td><td>rig=gastown, role=crew, name=joe</td></tr>\n<tr><td><code>gastown/polecats/toast</code></td><td>rig=gastown, role=polecat, name=toast</td></tr>\n</table>\n<h2>Audit Queries</h2>\n<p>\nAttribution enables powerful audit queries:\n</p>\n<pre><code class=\"language-bash\"># All work by an agent\n<p>\nbd audit --actor=gastown/crew/joe\n</p>\n<h1>All work in a rig</h1>\n<p>\nbd audit --actor=gastown/<em>\n</p>\n<h1>All polecat work</h1>\n<p>\nbd audit --actor=</em>/polecats/<em>\n</p>\n<h1>Git history by agent</h1>\n<p>\ngit log --author=&quot;gastown/crew/joe&quot;</code></pre>\n</p>\n<h2>Design Principles</h2>\n<p>\n1. <strong>Agents are not anonymous</strong> - Every action is attributed\n2. <strong>Work is owned, not authored</strong> - Agent creates, overseer owns\n3. <strong>Attribution is permanent</strong> - Git commits preserve history\n4. <strong>Format is parseable</strong> - Enables programmatic analysis\n5. <strong>Consistent across systems</strong> - Same format in git, beads, events\n</p>\n<h2>CV and Skill Accumulation</h2>\n<h3>Human Identity is Global</h3>\n<p>\nThe global identifier is your <strong>email</strong> - it's already in every git commit. No separate \"entity bead\" needed.\n</p>\n<pre><code class=\"language-text\">steve@example.com                ← global identity (from git author)\n<p>\n├── Town A (home)                ← workspace\n│   ├── gastown/crew/joe         ← agent executor\n│   └── gastown/polecats/toast   ← agent executor\n└── Town B (work)                ← workspace\n    └── acme/polecats/nux        ← agent executor</code></pre>\n</p>\n<h3>Agent vs Owner</h3>\n<table><tr><td>Field</td><td>Scope</td><td>Purpose</td></tr>\n</table>\n<table><tr><td><code>BD_ACTOR</code></td><td>Local (town)</td><td>Agent attribution for debugging</td></tr>\n<tr><td><code>GIT_AUTHOR_EMAIL</code></td><td>Global</td><td>Human identity for CV</td></tr>\n<tr><td><code>created_by</code></td><td>Local</td><td>Who created the bead</td></tr>\n<tr><td><code>owner</code></td><td>Global</td><td>Who owns the work</td></tr>\n</table>\n<strong>Agents execute. Humans own.</strong> The polecat name in <code>completed-by: gastown/polecats/toast</code> is executor attribution. The CV credits the human owner (<code>steve@example.com</code>).\n<h3>Polecats Have Persistent Identities</h3>\n<p>\nPolecats have <strong>persistent identities but ephemeral sessions</strong>. Like employees who\nclock in/out: each work session is fresh (new tmux, new worktree), but the identity\npersists across sessions.\n</p>\n<ul><li><strong>Identity (persistent)</strong>: Agent bead, CV chain, work history</li>\n<li><strong>Session (ephemeral)</strong>: Claude instance, context window</li>\n<li><strong>Sandbox (ephemeral)</strong>: Git worktree, branch</li>\n</ul>\n<p>\nWork credits the polecat identity, enabling:\n</p>\n<ul><li>Performance tracking per polecat</li>\n<li>Capability-based routing (send Go work to polecats with Go track records)</li>\n<li>Model comparison (A/B test different models via different polecats)</li>\n</ul>\n<p>\nSee <a href=\"polecat-lifecycle.md#polecat-identity\">polecat-lifecycle.md</a> for details.\n</p>\n<h3>Skills Are Derived</h3>\n<p>\nYour CV emerges from querying work evidence:\n</p>\n<pre><code class=\"language-bash\"># All work by owner (across all agents)\n<p>\ngit log --author=&quot;steve@example.com&quot;\nbd list --owner=steve@example.com\n</p>\n<h1>Skills derived from evidence</h1>\n<h1>- .go files touched → Go skill</h1>\n<h1>- issue tags → domain skills</h1>\n<h1>- commit patterns → activity types</code></pre></h1>\n<h3>Multi-Town Aggregation</h3>\n<p>\nA human with multiple towns has one CV:\n</p>\n<pre><code class=\"language-bash\"># Future: federated CV query\n<p>\nbd cv steve@example.com\n</p>\n<h1>Discovers all towns, aggregates work, derives skills</code></pre></h1>\n<p>\nSee <code>~/gt/docs/hop/decisions/008-identity-model.md</code> for architectural rationale.\n</p>\n<h2>Enterprise Use Cases</h2>\n<h3>Compliance and Audit</h3>\n<pre><code class=\"language-bash\"># Who touched this file in the last 90 days?\n<p>\ngit log --since=&quot;90 days ago&quot; -- path/to/sensitive/file.go\n</p>\n<h1>All changes by a specific agent</h1>\n<p>\nbd audit --actor=gastown/polecats/toast --since=2025-01-01</code></pre>\n</p>\n<h3>Performance Tracking</h3>\n<pre><code class=\"language-bash\"># Completion rate by agent\n<p>\nbd stats --group-by=actor\n</p>\n<h1>Average time to completion</h1>\n<p>\nbd stats --actor=gastown/polecats/</em> --metric=cycle-time</code></pre>\n</p>\n<h3>Model Comparison</h3>\n<p>\nWhen agents use different underlying models, attribution enables A/B comparison:\n</p>\n<pre><code class=\"language-bash\"># Tag agents by model\n<h1>gastown/polecats/claude-1 uses Claude</h1>\n<h1>gastown/polecats/gpt-1 uses GPT-4</h1>\n<h1>Compare quality signals</h1>\n<p>\nbd stats --actor=gastown/polecats/claude-<em> --metric=revision-count\nbd stats --actor=gastown/polecats/gpt-</em> --metric=revision-count</code></pre>\n</p>\n<p>\nLower revision counts suggest higher first-pass quality.\n</p>";
---

<DocsLayout title="Agent Identity and Attribution" description="> Canonical format for agent identity in Gas Town">
  <div class="markdown-content" set:html={content} />
</DocsLayout>
