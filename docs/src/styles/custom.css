/**
 * Custom Starlight theme to match the main Gas Town Hall site.
 * Based on the steampunk industrial theme from global.css
 */

/* Font imports - Victorian/Industrial typography */
@import url('https://fonts.googleapis.com/css2?family=Cinzel:wght@400;500;600;700&family=Crimson+Text:ital,wght@0,400;0,600;0,700;1,400&family=JetBrains+Mono:wght@400;500;700&display=swap');

/* CSS Custom Properties - Match main site exactly */
:root {
  /* Colors - Steampunk Industrial Palette */
  --color-bg: #e8dcc8;
  --color-bg-alt: #d9c9b0;
  --color-bg-dark: #3e2723;
  --color-surface: #f5e6d3;
  --color-surface-dark: #4a3728;

  /* Text colors */
  --color-text: #2c1810;
  --color-text-muted: #5d4037;
  --color-text-light: #f5e6d3;

  /* Accent colors */
  --color-accent: #8b2500;
  --color-accent-hover: #a0522d;
  --color-accent-light: #d4a574;

  /* Metal colors */
  --color-brass: #cd7f32;
  --color-bronze: #8b4513;
  --color-copper: #b87333;
  --color-steel: #70798c;
  --color-rust: #8b4513;

  /* Functional colors */
  --color-link: #8b2500;
  --color-link-hover: #5d4037;
  --color-border: #8b7355;
  --color-border-dark: #5d4037;
  --color-code-bg: #f0e6d8;

  /* Typography */
  --font-display: 'Cinzel', 'Times New Roman', serif;
  --font-body: 'Crimson Text', Georgia, serif;
  --font-mono: 'JetBrains Mono', 'Courier New', monospace;

  /* Spacing */
  --space-xs: 0.25rem;
  --space-sm: 0.5rem;
  --space-md: 1rem;
  --space-lg: 2rem;
  --space-xl: 4rem;
  --space-2xl: 6rem;

  /* Layout */
  --max-width: 1200px;
  --border-radius: 4px;
  --header-height: 80px;

  /* Animation */
  --ease-out-expo: cubic-bezier(0.16, 1, 0.3, 1);
  --ease-out-back: cubic-bezier(0.34, 1.56, 0.64, 1);
  --ease-in-out-smooth: cubic-bezier(0.4, 0, 0.2, 1);
  --duration-fast: 150ms;
  --duration-normal: 250ms;
  --duration-slow: 400ms;
  --duration-slower: 600ms;

  /* Starlight color overrides - transparent to show body background */
  --sl-color-bg: transparent;
  --sl-color-bg-nav: rgba(62, 39, 35, 0.98);
  --sl-color-bg-sidebar: rgba(245, 230, 211, 0.9);
  --sl-color-bg-inline-code: var(--color-code-bg);

  --sl-color-text: var(--color-text);
  --sl-color-text-accent: var(--color-brass);

  --sl-color-accent: var(--color-brass);
  --sl-color-accent-low: rgba(205, 127, 50, 0.15);
  --sl-color-accent-high: var(--color-bronze);

  --sl-color-white: var(--color-text-light);
  --sl-color-gray-1: #f5e6d3;
  --sl-color-gray-2: #e8dcc8;
  --sl-color-gray-3: #d9c9b0;
  --sl-color-gray-4: #8b7355;
  --sl-color-gray-5: #5d4037;
  --sl-color-gray-6: #3e2723;
  --sl-color-black: #2c1810;

  --sl-font: var(--font-body);
  --sl-font-system-mono: var(--font-mono);
}

/* Dark mode */
:root[data-theme='dark'] {
  --sl-color-bg: #2c1810;
  --sl-color-bg-sidebar: #3e2723;
  --sl-color-text: var(--color-text-light);
}

/* ============================================
   Background Image - Steampunk texture (on body like main site)
   ============================================ */
body {
  background-image:
    linear-gradient(rgba(232, 220, 200, 0.75), rgba(232, 220, 200, 0.75)),
    url('/images/steampunk-bg.webp') !important;
  background-repeat: no-repeat, no-repeat !important;
  background-position:
    center center,
    center center !important;
  background-size: cover, cover !important;
  background-attachment: fixed, fixed !important;
}

@media (max-width: 50rem) {
  body {
    background-attachment: scroll, scroll !important;
    background-position:
      30% center,
      30% center !important;
  }
}

/* Make all page containers transparent to show body background */
.page,
.main-wrapper,
.main-frame,
.content-panel,
.sidebar-pane,
.sidebar-content,
[data-pagefind-body],
.sl-container {
  background: transparent !important;
}

/* ============================================
   Mayor Image - Desktop only, 10% opacity
   ============================================ */
.mayor-overlay {
  position: fixed;
  top: calc(var(--header-height) + 2rem);
  left: max(2rem, calc((100% - var(--max-width)) / 2 + 2rem));
  width: 180px;
  height: auto;
  z-index: 1;
  opacity: 0.1;
  pointer-events: none;
}

@media (max-width: 1024px) {
  .mayor-overlay {
    display: none;
  }
}

/* ============================================
   Header - Dark brown with brass accents
   ============================================ */
header.header {
  background: linear-gradient(to bottom, #5d4037, #3e2723) !important;
  border-bottom: 4px solid var(--color-brass) !important;
  box-shadow:
    inset 0 1px 0 rgba(255, 255, 255, 0.1),
    0 4px 12px rgba(0, 0, 0, 0.3) !important;
}

/* Header decorative bar */
header.header::after {
  content: '';
  position: absolute;
  bottom: -8px;
  left: 0;
  right: 0;
  height: 4px;
  background: linear-gradient(
    to right,
    var(--color-brass),
    var(--color-copper),
    var(--color-brass)
  );
}

/* Site title styling - must match main site .site-header .logo */
.site-title,
[data-sl-title] {
  font-family: var(--font-display) !important;
  font-weight: 700 !important;
  font-size: 1.5rem !important;
  color: var(--color-text-light) !important;
  letter-spacing: 0.1em !important;
  text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5) !important;
  text-transform: none !important;
  text-decoration: none !important;
}

/* Add decorative dashes around title like main site */
.site-title::before {
  content: '— ';
  color: var(--color-brass);
  margin-right: 0.5rem;
}

.site-title::after {
  content: ' —';
  color: var(--color-brass);
  margin-left: 0.5rem;
}

.site-title:hover,
[data-sl-title]:hover {
  color: var(--color-brass) !important;
  text-shadow:
    2px 2px 4px rgba(0, 0, 0, 0.5),
    0 0 20px rgba(205, 127, 50, 0.4) !important;
}

/* Header nav links - must match main site .site-header .nav-links a */
header .nav-links a {
  font-family: var(--font-display) !important;
  font-weight: 500 !important;
  font-size: 0.875rem !important;
  letter-spacing: 0.1em !important;
  text-transform: uppercase !important;
  color: var(--color-text-light) !important;
  text-decoration: none !important;
}

header .nav-links a:hover {
  color: var(--color-brass) !important;
}

/* ============================================
   Sidebar - Transparent background
   ============================================ */

/* Sidebar top-level items - IDENTICAL styling for all */
/* Summary elements (expandable sections) - use flexbox for chevron */
.top-level > li > details > summary {
  display: flex !important;
  align-items: center !important;
  justify-content: space-between !important;
  padding: 0.5rem 0 !important;
  margin: 0 !important;
  border: none !important;
  cursor: pointer !important;
}

/* Chevron icon styling */
.top-level > li > details > summary .caret {
  flex-shrink: 0 !important;
  margin-left: 0.5rem !important;
}

/* ALL top-level text labels - both standalone links and expandable headers */
.top-level > li > a.large,
.top-level > li > a.large span,
.top-level > li > details > summary .large,
.top-level > li > details > summary .group-label {
  font-family: var(--font-display) !important;
  font-size: 1.05rem !important;
  font-weight: 600 !important;
  text-transform: uppercase !important;
  letter-spacing: 0.1em !important;
  color: var(--color-text-muted) !important;
}

/* Top-level standalone links (Overview, Glossary, etc.) */
.top-level > li > a.large {
  display: block !important;
  padding: 0.5rem 0 !important;
  margin: 0 !important;
  border: none !important;
  background: none !important;
}

/* Sidebar links (nested items only - exclude top-level) */
.top-level ul a,
.sidebar-content ul ul a {
  color: var(--color-text) !important;
  font-family: var(--font-body) !important;
  font-size: 1.05rem !important;
  padding: 0.375rem 0.75rem !important;
  border-left: 3px solid transparent !important;
  border-radius: 3px !important;
  transition:
    color var(--duration-fast) ease,
    background var(--duration-fast) ease,
    border-left-color var(--duration-normal) var(--ease-out-expo),
    padding-left var(--duration-normal) var(--ease-out-expo) !important;
}

.top-level ul a:hover,
.sidebar-content ul ul a:hover {
  color: var(--color-accent) !important;
  background: var(--color-bg-alt) !important;
  border-left-color: var(--color-brass) !important;
  padding-left: 1rem !important;
}

.sidebar a[aria-current='page'],
nav.sidebar a[aria-current='page'] {
  color: var(--color-accent) !important;
  background: var(--color-bg-alt) !important;
  border-left-color: var(--color-brass) !important;
  font-weight: 600 !important;
}

/* ============================================
   Main Content Area - Transparent wrapper, solid content box
   ============================================ */
.main-frame,
.content-panel {
  background: transparent !important;
}

main,
article {
  background: transparent !important;
  border: none !important;
  box-shadow: none !important;
  padding: 0 !important;
}

/* Parent container needs position relative for absolute TOC positioning */
.lg\:sl-flex {
  position: relative !important;
}

/* The main content pane (contains both h1 and markdown content) */
.main-pane {
  position: relative !important;
  z-index: 2 !important; /* Above mayor overlay (z-index: 1) */
  background: var(--color-surface) !important;
  border: 2px solid var(--color-border) !important;
  border-radius: var(--border-radius) !important;
  box-shadow:
    inset 0 1px 0 rgba(255, 255, 255, 0.5),
    0 2px 8px rgba(0, 0, 0, 0.1) !important;
  padding: 2.5rem !important;
  margin: 1rem !important;
}

/* Reset the content panels inside the box */
.main-pane .content-panel,
.main-pane .sl-container {
  background: transparent !important;
  padding: 0 !important;
  margin: 0 !important;
}

/* Markdown content inherits from parent box */
.sl-markdown-content {
  background: transparent !important;
  border: none !important;
  box-shadow: none !important;
  padding: 0 !important;
  margin-top: 1.5rem !important;
}

/* Force dark text in content area - the main-pane has a light background
   even in dark mode, so text must always be dark */
.main-pane,
.main-pane .sl-markdown-content,
.main-pane p,
.main-pane li,
.main-pane td,
.main-pane th {
  color: var(--color-text) !important;
}

/* ============================================
   Typography - Increased font sizes
   ============================================ */

/* Base font size - matches design system */
html {
  font-size: 1.0625rem !important;
}

body,
.sl-markdown-content {
  font-size: 1rem !important;
  line-height: 1.7 !important;
}

/* Headings */
h1,
h2,
h3,
h4,
h5,
h6 {
  font-family: var(--font-display) !important;
  color: var(--color-text) !important;
}

h1 {
  font-size: clamp(2rem, 4vw, 3rem) !important;
}

h2 {
  font-size: clamp(1.5rem, 3vw, 2rem) !important;
}

h3 {
  font-size: clamp(1.25rem, 2.5vw, 1.5rem) !important;
}

h4 {
  font-size: 1.125rem !important;
}

/* In dark mode, headings in the content area still need dark text
   because the main-pane background stays light */
:root[data-theme='dark'] .main-pane h1,
:root[data-theme='dark'] .main-pane h2,
:root[data-theme='dark'] .main-pane h3,
:root[data-theme='dark'] .main-pane h4,
:root[data-theme='dark'] .main-pane h5,
:root[data-theme='dark'] .main-pane h6 {
  color: var(--color-text) !important;
}

/* Paragraph text */
p,
li,
td,
th {
  font-size: 1rem !important;
}

/* Links */
a {
  color: var(--color-link);
  text-decoration: none;
  transition: color var(--duration-fast) ease;
}

a:hover {
  color: var(--color-accent-hover);
}

/* ============================================
   Code Blocks
   ============================================ */

/* Override Expressive Code colors to use our theme consistently.
   Without this, dark mode uses light text (#d6deeb) on our light
   parchment background, making code invisible. */
.expressive-code,
:root[data-theme='dark'] .expressive-code {
  --ec-codeBg: var(--color-code-bg) !important;
  --ec-codeFg: var(--color-text) !important;
  --ec-gtrFg: var(--color-text-muted) !important;
  --ec-brdCol: var(--color-border) !important;
}

pre {
  background: var(--color-code-bg) !important;
  border: 1px solid var(--color-border) !important;
  border-left: 4px solid var(--color-brass) !important;
  border-radius: var(--border-radius) !important;
}

code {
  font-family: var(--font-mono) !important;
}

/* Inline code */
:not(pre) > code {
  background: var(--color-code-bg) !important;
  padding: 0.125rem 0.375rem;
  border-radius: 3px;
  font-size: 0.9em;
}

/* Right sidebar "On this page" heading - match sidebar section headers */
.right-sidebar h2,
starlight-toc h2 {
  font-family: var(--font-display) !important;
  font-size: 1.05rem !important;
  font-weight: 600 !important;
  text-transform: uppercase !important;
  letter-spacing: 0.1em !important;
  color: var(--color-text-muted) !important;
}

/* Right sidebar TOC links - match left sidebar colors */
.right-sidebar a,
starlight-toc a {
  font-size: 1.05rem !important;
  color: var(--color-text) !important;
  font-family: var(--font-body) !important;
}

.right-sidebar a:hover,
starlight-toc a:hover {
  color: var(--color-accent) !important;
}

/* Mobile TOC - Starlight's summary already has height: var(--sl-mobile-toc-height).
   Make summary a flex container to center the button within that space. */
@media (max-width: 72rem) {
  :root {
    --sl-mobile-toc-height: 4.5rem !important;
  }

  /* Transparent nav background */
  mobile-starlight-toc nav {
    background: transparent !important;
    border: none !important;
  }

  /* Center button within the full-height summary */
  mobile-starlight-toc summary {
    display: flex !important;
    justify-content: center !important;
    align-items: center !important;
    border: none !important;
  }

  /* Hide current section display */
  mobile-starlight-toc .display-current {
    display: none !important;
  }

  /* Style the toggle button */
  mobile-starlight-toc .toggle {
    font-family: var(--font-display) !important;
    font-size: 0.875rem !important;
    font-weight: 600 !important;
    text-transform: uppercase !important;
    letter-spacing: 0.05em !important;
    color: var(--color-text) !important;
    background: linear-gradient(
      180deg,
      #e8dcc8 0%,
      #d4c4a8 50%,
      #beb09a 100%
    ) !important;
    border: 2px solid var(--color-border) !important;
    border-radius: var(--border-radius) !important;
    padding: 0.75rem 1.5rem !important;
  }

  mobile-starlight-toc .toggle:hover {
    border-color: var(--color-brass) !important;
  }

  /* Dropdown styling */
  mobile-starlight-toc .dropdown {
    background: linear-gradient(
      180deg,
      var(--color-surface) 0%,
      #f5efe6 100%
    ) !important;
    border: 2px solid var(--color-border) !important;
    border-radius: var(--border-radius) !important;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15) !important;
    padding: 0.5rem 0 !important;
    max-height: 60vh !important;
    overflow-y: auto !important;
  }

  /* Dropdown list styling */
  mobile-starlight-toc .dropdown ul {
    padding: 0 !important;
    margin: 0 !important;
  }

  mobile-starlight-toc .dropdown li {
    list-style: none !important;
    margin: 0 !important;
    padding: 0 !important;
  }

  /* Dropdown link styling */
  mobile-starlight-toc .dropdown a {
    display: block !important;
    padding: 0.625rem 1.25rem !important;
    color: var(--color-text) !important;
    font-family: var(--font-body) !important;
    font-size: 0.9rem !important;
    text-decoration: none !important;
    border-left: 3px solid transparent !important;
    transition: all 0.2s ease !important;
  }

  mobile-starlight-toc .dropdown a:hover {
    background: rgba(184, 115, 51, 0.1) !important;
    color: var(--color-brass) !important;
    border-left-color: var(--color-brass) !important;
  }

  /* Nested items (depth indicators) */
  mobile-starlight-toc .dropdown li[data-depth='2'] a {
    padding-left: 2rem !important;
    font-size: 0.85rem !important;
  }

  mobile-starlight-toc .dropdown li[data-depth='3'] a {
    padding-left: 2.75rem !important;
    font-size: 0.8rem !important;
    color: var(--color-text-muted) !important;
  }
}

/* ============================================
   Footer
   ============================================ */
footer {
  background: linear-gradient(to bottom, #3e2723, #2c1810) !important;
  border-top: 4px solid var(--color-brass) !important;
  color: var(--color-text-light) !important;
}

footer a {
  color: var(--color-brass) !important;
}

footer a:hover {
  color: var(--color-copper) !important;
}

/* ============================================
   Callouts/Notes
   ============================================ */
.starlight-aside,
.sl-markdown-content .note,
.sl-markdown-content .tip,
.sl-markdown-content .caution,
.sl-markdown-content .danger {
  border: 2px solid var(--color-border) !important;
  border-radius: var(--border-radius) !important;
  background: rgba(245, 230, 211, 0.7) !important;
}

:root[data-theme='dark'] .starlight-aside {
  background: rgba(62, 39, 35, 0.8) !important;
}

/* ============================================
   Search
   ============================================ */
button[data-open-modal] {
  border: 2px solid var(--color-border) !important;
  background: var(--color-surface) !important;
}

/* ============================================
   Mobile Menu / Dropdown Navigation
   ============================================ */
.mobile-menu-toggle,
starlight-menu-button button {
  background: var(--color-surface) !important;
  border: 2px solid var(--color-border) !important;
  color: var(--color-text) !important;
}

.mobile-menu-toggle:hover,
starlight-menu-button button:hover {
  background: var(--color-bg-alt) !important;
  border-color: var(--color-brass) !important;
}

/* Mobile sidebar when open */
[data-open-modal],
dialog,
.modal {
  background: var(--color-surface) !important;
  border: 2px solid var(--color-border) !important;
}

/* Mobile nav dropdown */
nav[aria-label='Main'],
.nav-groups {
  background: var(--color-surface) !important;
}

/* ============================================
   Mobile adjustments
   ============================================ */
@media (max-width: 72rem) {
  .main-pane {
    margin: 0 0.5rem 0.5rem 0.5rem !important;
    padding: 1.5rem !important;
  }
}

@media (max-width: 50rem) {
  /* Mobile sidebar - must be opaque to cover content */
  nav.sidebar,
  .sidebar,
  .sidebar-pane,
  [data-open-sidebar] .sidebar-pane,
  .sidebar-content {
    background: var(--color-surface) !important;
    border: none !important;
    border-radius: 0 !important;
    box-shadow: none !important;
  }

  /* Starlight's mobile sidebar container */
  starlight-menu-button + .sidebar-pane,
  [aria-expanded='true'] ~ .sidebar-pane {
    background: var(--color-surface) !important;
  }

  /* Mobile menu button styling */
  starlight-menu-button {
    background: transparent !important;
  }

  starlight-menu-button button {
    background: var(--color-surface) !important;
    border: 2px solid var(--color-border) !important;
    border-radius: var(--border-radius) !important;
    color: var(--color-text) !important;
    font-family: var(--font-display) !important;
  }
}
