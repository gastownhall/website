{"parentUuid":null,"isSidechain":true,"userType":"external","cwd":"/Users/csells/Code/gastownhall/website","sessionId":"dc9d694e-994e-4b73-9876-59c87b636ae6","version":"2.1.12","gitBranch":"main","agentId":"af83d1f","slug":"snappy-doodling-pudding","type":"user","message":{"role":"user","content":"Design an implementation plan for using Gas Town (gt CLI) to build the gastownhall.ai website.\n\n## Background Context\n\nThe user wants to:\n1. Build the gastownhall.ai website using the gt CLI (NOT by writing code directly)\n2. Learn how to use Gas Town for end-to-end scenarios\n3. Document all learnings in a learnings.md file\n\n**CRITICAL CONSTRAINT:** The user said \"if you write any code yourself, then you've failed\" - all work must be done through gt commands that dispatch to agents.\n\n## Project Structure (from exploration)\n\nLocation: `/Users/csells/Code/gastownhall/website`\nContents:\n- `docs-fodder/gastown-docs/` - 25 markdown files with comprehensive Gas Town documentation\n- `docs-fodder/steve-blog-posts/` - 5 blog posts by Steve\n- No application code yet - clean slate\n- Git repo on main branch\n\n## Gas Town Workflow (from exploration)\n\n### Setup Commands:\n- `gt install <path>` - Create a Gas Town HQ (headquarters/workspace)\n- `gt init` - Initialize a rig within the HQ\n- `bd init` - Initialize beads database for tracking issues\n\n### Creating Work:\n- `bd create \"Title\" --description \"...\" --type task` - Create individual beads/issues\n- `bd create -f <markdown-file>` - Create multiple issues from a markdown file\n- `gt formula create <name>` - Create a formula (workflow template)\n\n### Creating Plans via Formulas:\n- Formulas are TOML files in `.beads/formulas/` that define multi-step workflows\n- `bd cook <formula>` - Compile formula into a protomolecule\n- `bd mol pour <proto>` - Create a molecule (active workflow with step beads)\n\n### Executing Work:\n- `gt sling <bead> <target>` - THE unified dispatch command\n  - `gt sling gt-abc gastown` - Auto-spawn polecat in rig\n  - `gt sling gt-abc crew` - Assign to crew worker\n- `gt convoy create \"Name\" <beads...>` - Track batches of work\n\n### Agents:\n- **Polecats** - Ephemeral workers (spawn for one task, execute, exit)\n- **Crew** - Persistent human workspaces\n- **Mayor** - Chief of Staff for coordination\n\n## Website Requirements\n\nThe gastownhall.ai website needs:\n1. Landing page with:\n   - Headline: \"Gas Town is powerful but chaotic. We help you wrangle the chimps.\"\n   - Links to Steve's blog posts\n   - Discord invite (big button CTA)\n   - X link\n   - Link to docs sub-page\n2. Docs landing page showing gastown-docs with links to all sub-pages\n   - IMPORTANT: A tool/script that \"shreds\" the original docs markdown into the website docs section for easy updates\n3. Privacy-respecting analytics\n4. robots.txt\n5. llms.txt (generated from site contents)\n6. Basic SEO meta tags\n7. Privacy policy page\n\n## Scenarios to Explore (and document in learnings.md)\n\n1. Project initiation with gt\n2. Creating a comprehensive plan (using gt? formulas? experiment!)\n3. Getting the plan into beads for execution (manual bd commands? gt shred? Mayor?)\n4. Executing the plan via polecats\n5. Testing the website\n6. Reviewing the generated code quality\n\n## Outputs Expected\n\n1. Tested, reviewed implementation in `src/` folder with build scripts for `deploy/` folder\n2. `learnings.md` documenting the WHY and HOW with code snippets and working directories\n\n## Questions to Address in the Plan\n\n1. Should we initialize this directory as an HQ, or create a rig within an existing HQ?\n2. What's the workflow to have agents write the actual code?\n3. How do we structure beads to represent the website features?\n4. How do we create and dispatch formulas for the website build workflow?\n5. How do we test and review agent-generated work?\n\nPlease design a detailed implementation plan that uses gt to orchestrate the entire build process."},"uuid":"f808cc80-b3af-4a1e-a565-85569486a444","timestamp":"2026-01-20T16:18:01.347Z"}
{"parentUuid":"f808cc80-b3af-4a1e-a565-85569486a444","isSidechain":true,"userType":"external","cwd":"/Users/csells/Code/gastownhall/website","sessionId":"dc9d694e-994e-4b73-9876-59c87b636ae6","version":"2.1.12","gitBranch":"main","agentId":"af83d1f","slug":"snappy-doodling-pudding","message":{"model":"claude-opus-4-5-20251101","id":"msg_01Rvx6nzKfZ6Wt3hFy932WS2","type":"message","role":"assistant","content":[{"type":"text","text":"# Implementation Plan: Building gastownhall.ai with Gas Town CLI\n\nLet me explore the codebase thoroughly to understand the Gas Town documentation and design a comprehensive plan."}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":2,"cache_creation_input_tokens":18134,"cache_read_input_tokens":0,"cache_creation":{"ephemeral_5m_input_tokens":18134,"ephemeral_1h_input_tokens":0},"output_tokens":1,"service_tier":"standard"}},"requestId":"req_011CXJw1DGeY9fVhvMYAGUGL","type":"assistant","uuid":"87041e8d-4e73-452f-8be3-b8b78de569a6","timestamp":"2026-01-20T16:18:04.828Z"}
{"parentUuid":"87041e8d-4e73-452f-8be3-b8b78de569a6","isSidechain":true,"userType":"external","cwd":"/Users/csells/Code/gastownhall/website","sessionId":"dc9d694e-994e-4b73-9876-59c87b636ae6","version":"2.1.12","gitBranch":"main","agentId":"af83d1f","slug":"snappy-doodling-pudding","message":{"model":"claude-opus-4-5-20251101","id":"msg_01Rvx6nzKfZ6Wt3hFy932WS2","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_018TnERhRS8qKefuktJZPSMr","name":"Glob","input":{"pattern":"**/*.md","path":"/Users/csells/Code/gastownhall/website"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":2,"cache_creation_input_tokens":18134,"cache_read_input_tokens":0,"cache_creation":{"ephemeral_5m_input_tokens":18134,"ephemeral_1h_input_tokens":0},"output_tokens":1,"service_tier":"standard"}},"requestId":"req_011CXJw1DGeY9fVhvMYAGUGL","type":"assistant","uuid":"2c0fbdf3-84c9-4f55-b119-e431ec4c2c48","timestamp":"2026-01-20T16:18:05.439Z"}
{"parentUuid":"2c0fbdf3-84c9-4f55-b119-e431ec4c2c48","isSidechain":true,"userType":"external","cwd":"/Users/csells/Code/gastownhall/website","sessionId":"dc9d694e-994e-4b73-9876-59c87b636ae6","version":"2.1.12","gitBranch":"main","agentId":"af83d1f","slug":"snappy-doodling-pudding","message":{"model":"claude-opus-4-5-20251101","id":"msg_01Rvx6nzKfZ6Wt3hFy932WS2","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01HjCNF3HdXUyW3vujopQiXN","name":"Bash","input":{"command":"ls -la /Users/csells/Code/gastownhall/website","description":"List root directory contents"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":2,"cache_creation_input_tokens":18134,"cache_read_input_tokens":0,"cache_creation":{"ephemeral_5m_input_tokens":18134,"ephemeral_1h_input_tokens":0},"output_tokens":1,"service_tier":"standard"}},"requestId":"req_011CXJw1DGeY9fVhvMYAGUGL","type":"assistant","uuid":"f5567278-dc7e-4af0-bc05-904fa9a932f2","timestamp":"2026-01-20T16:18:05.854Z"}
{"parentUuid":"f5567278-dc7e-4af0-bc05-904fa9a932f2","isSidechain":true,"userType":"external","cwd":"/Users/csells/Code/gastownhall/website","sessionId":"dc9d694e-994e-4b73-9876-59c87b636ae6","version":"2.1.12","gitBranch":"main","agentId":"af83d1f","slug":"snappy-doodling-pudding","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01HjCNF3HdXUyW3vujopQiXN","type":"tool_result","content":"total 32\ndrwxr-xr-x   6 csells  staff    192 Jan 20 07:17 .\ndrwxr-xr-x   6 csells  staff    192 Jan 20 07:06 ..\n-rw-r--r--@  1 csells  staff  10244 Jan 20 07:12 .DS_Store\ndrwxr-xr-x  13 csells  staff    416 Jan 20 08:13 .git\n-rw-r--r--   1 csells  staff     10 Jan 20 07:17 .gitignore\ndrwxr-xr-x   5 csells  staff    160 Jan 20 07:12 docs-fodder","is_error":false}]},"uuid":"7f17306a-356f-425d-9212-5ec4e19f1dc5","timestamp":"2026-01-20T16:18:06.463Z","toolUseResult":{"stdout":"total 32\ndrwxr-xr-x   6 csells  staff    192 Jan 20 07:17 .\ndrwxr-xr-x   6 csells  staff    192 Jan 20 07:06 ..\n-rw-r--r--@  1 csells  staff  10244 Jan 20 07:12 .DS_Store\ndrwxr-xr-x  13 csells  staff    416 Jan 20 08:13 .git\n-rw-r--r--   1 csells  staff     10 Jan 20 07:17 .gitignore\ndrwxr-xr-x   5 csells  staff    160 Jan 20 07:12 docs-fodder","stderr":"","interrupted":false,"isImage":false},"sourceToolAssistantUUID":"f5567278-dc7e-4af0-bc05-904fa9a932f2"}
{"parentUuid":"2c0fbdf3-84c9-4f55-b119-e431ec4c2c48","isSidechain":true,"userType":"external","cwd":"/Users/csells/Code/gastownhall/website","sessionId":"dc9d694e-994e-4b73-9876-59c87b636ae6","version":"2.1.12","gitBranch":"main","agentId":"af83d1f","slug":"snappy-doodling-pudding","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_018TnERhRS8qKefuktJZPSMr","type":"tool_result","content":"/Users/csells/Code/gastownhall/website/docs-fodder/steve-blog-posts/BAGS and the Creator Economy.md\n/Users/csells/Code/gastownhall/website/docs-fodder/steve-blog-posts/The Future of Coding Agents.md\n/Users/csells/Code/gastownhall/website/docs-fodder/steve-blog-posts/Welcome to Gas Town.md\n/Users/csells/Code/gastownhall/website/docs-fodder/steve-blog-posts/Gas Town Emergency User Manual.md\n/Users/csells/Code/gastownhall/website/docs-fodder/steve-blog-posts/Steveyâ€™s Birthday Blog.md\n/Users/csells/Code/gastownhall/website/docs-fodder/gastown-docs/design/property-layers.md\n/Users/csells/Code/gastownhall/website/docs-fodder/gastown-docs/design/architecture.md\n/Users/csells/Code/gastownhall/website/docs-fodder/gastown-docs/design/plugin-system.md\n/Users/csells/Code/gastownhall/website/docs-fodder/gastown-docs/design/federation.md\n/Users/csells/Code/gastownhall/website/docs-fodder/gastown-docs/design/watchdog-chain.md\n/Users/csells/Code/gastownhall/website/docs-fodder/gastown-docs/design/escalation-system.md\n/Users/csells/Code/gastownhall/website/docs-fodder/gastown-docs/design/operational-state.md\n/Users/csells/Code/gastownhall/website/docs-fodder/gastown-docs/design/mail-protocol.md\n/Users/csells/Code/gastownhall/website/docs-fodder/gastown-docs/design/convoy-lifecycle.md\n/Users/csells/Code/gastownhall/website/docs-fodder/gastown-docs/design/escalation.md\n/Users/csells/Code/gastownhall/website/docs-fodder/gastown-docs/design/dog-pool-architecture.md\n/Users/csells/Code/gastownhall/website/docs-fodder/gastown-docs/reference.md\n/Users/csells/Code/gastownhall/website/docs-fodder/gastown-docs/overview.md\n/Users/csells/Code/gastownhall/website/docs-fodder/gastown-docs/why-these-features.md\n/Users/csells/Code/gastownhall/website/docs-fodder/gastown-docs/glossary.md\n/Users/csells/Code/gastownhall/website/docs-fodder/gastown-docs/INSTALLING.md\n/Users/csells/Code/gastownhall/website/docs-fodder/gastown-docs/examples/hanoi-demo.md\n/Users/csells/Code/gastownhall/website/docs-fodder/gastown-docs/concepts/molecules.md\n/Users/csells/Code/gastownhall/website/docs-fodder/gastown-docs/concepts/identity.md\n/Users/csells/Code/gastownhall/website/docs-fodder/gastown-docs/concepts/polecat-lifecycle.md\n/Users/csells/Code/gastownhall/website/docs-fodder/gastown-docs/concepts/convoy.md\n/Users/csells/Code/gastownhall/website/docs-fodder/gastown-docs/concepts/propulsion-principle.md\n/Users/csells/Code/gastownhall/website/docs-fodder/gastown-docs/beads-native-messaging.md\n/Users/csells/Code/gastownhall/website/docs-fodder/gastown-docs/formula-resolution.md\n/Users/csells/Code/gastownhall/website/docs-fodder/gastown-docs/mol-mall-design.md"}]},"uuid":"5613ccb2-b7e9-423e-8c59-3fc16ddbd5a4","timestamp":"2026-01-20T16:18:07.062Z","toolUseResult":{"filenames":["/Users/csells/Code/gastownhall/website/docs-fodder/steve-blog-posts/BAGS and the Creator Economy.md","/Users/csells/Code/gastownhall/website/docs-fodder/steve-blog-posts/The Future of Coding Agents.md","/Users/csells/Code/gastownhall/website/docs-fodder/steve-blog-posts/Welcome to Gas Town.md","/Users/csells/Code/gastownhall/website/docs-fodder/steve-blog-posts/Gas Town Emergency User Manual.md","/Users/csells/Code/gastownhall/website/docs-fodder/steve-blog-posts/Steveyâ€™s Birthday Blog.md","/Users/csells/Code/gastownhall/website/docs-fodder/gastown-docs/design/property-layers.md","/Users/csells/Code/gastownhall/website/docs-fodder/gastown-docs/design/architecture.md","/Users/csells/Code/gastownhall/website/docs-fodder/gastown-docs/design/plugin-system.md","/Users/csells/Code/gastownhall/website/docs-fodder/gastown-docs/design/federation.md","/Users/csells/Code/gastownhall/website/docs-fodder/gastown-docs/design/watchdog-chain.md","/Users/csells/Code/gastownhall/website/docs-fodder/gastown-docs/design/escalation-system.md","/Users/csells/Code/gastownhall/website/docs-fodder/gastown-docs/design/operational-state.md","/Users/csells/Code/gastownhall/website/docs-fodder/gastown-docs/design/mail-protocol.md","/Users/csells/Code/gastownhall/website/docs-fodder/gastown-docs/design/convoy-lifecycle.md","/Users/csells/Code/gastownhall/website/docs-fodder/gastown-docs/design/escalation.md","/Users/csells/Code/gastownhall/website/docs-fodder/gastown-docs/design/dog-pool-architecture.md","/Users/csells/Code/gastownhall/website/docs-fodder/gastown-docs/reference.md","/Users/csells/Code/gastownhall/website/docs-fodder/gastown-docs/overview.md","/Users/csells/Code/gastownhall/website/docs-fodder/gastown-docs/why-these-features.md","/Users/csells/Code/gastownhall/website/docs-fodder/gastown-docs/glossary.md","/Users/csells/Code/gastownhall/website/docs-fodder/gastown-docs/INSTALLING.md","/Users/csells/Code/gastownhall/website/docs-fodder/gastown-docs/examples/hanoi-demo.md","/Users/csells/Code/gastownhall/website/docs-fodder/gastown-docs/concepts/molecules.md","/Users/csells/Code/gastownhall/website/docs-fodder/gastown-docs/concepts/identity.md","/Users/csells/Code/gastownhall/website/docs-fodder/gastown-docs/concepts/polecat-lifecycle.md","/Users/csells/Code/gastownhall/website/docs-fodder/gastown-docs/concepts/convoy.md","/Users/csells/Code/gastownhall/website/docs-fodder/gastown-docs/concepts/propulsion-principle.md","/Users/csells/Code/gastownhall/website/docs-fodder/gastown-docs/beads-native-messaging.md","/Users/csells/Code/gastownhall/website/docs-fodder/gastown-docs/formula-resolution.md","/Users/csells/Code/gastownhall/website/docs-fodder/gastown-docs/mol-mall-design.md"],"durationMs":739,"numFiles":30,"truncated":false},"sourceToolAssistantUUID":"2c0fbdf3-84c9-4f55-b119-e431ec4c2c48"}
{"parentUuid":"5613ccb2-b7e9-423e-8c59-3fc16ddbd5a4","isSidechain":true,"userType":"external","cwd":"/Users/csells/Code/gastownhall/website","sessionId":"dc9d694e-994e-4b73-9876-59c87b636ae6","version":"2.1.12","gitBranch":"main","agentId":"af83d1f","slug":"snappy-doodling-pudding","message":{"model":"claude-opus-4-5-20251101","id":"msg_01HpyXGpwkVFfjLj4m8MLPZk","type":"message","role":"assistant","content":[{"type":"text","text":"Let me read the key Gas Town documentation files to understand the workflow deeply."}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":217,"cache_creation_input_tokens":1485,"cache_read_input_tokens":18134,"cache_creation":{"ephemeral_5m_input_tokens":1485,"ephemeral_1h_input_tokens":0},"output_tokens":1,"service_tier":"standard"}},"requestId":"req_011CXJw1ejLshunXBkLUFD8Y","type":"assistant","uuid":"da1b4411-52b8-4ba0-b089-6b25cd8b55eb","timestamp":"2026-01-20T16:18:10.050Z"}
{"parentUuid":"da1b4411-52b8-4ba0-b089-6b25cd8b55eb","isSidechain":true,"userType":"external","cwd":"/Users/csells/Code/gastownhall/website","sessionId":"dc9d694e-994e-4b73-9876-59c87b636ae6","version":"2.1.12","gitBranch":"main","agentId":"af83d1f","slug":"snappy-doodling-pudding","message":{"model":"claude-opus-4-5-20251101","id":"msg_01HpyXGpwkVFfjLj4m8MLPZk","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01VbWD4zVryEsDbYojcVJHX7","name":"Read","input":{"file_path":"/Users/csells/Code/gastownhall/website/docs-fodder/gastown-docs/overview.md"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":217,"cache_creation_input_tokens":1485,"cache_read_input_tokens":18134,"cache_creation":{"ephemeral_5m_input_tokens":1485,"ephemeral_1h_input_tokens":0},"output_tokens":1,"service_tier":"standard"}},"requestId":"req_011CXJw1ejLshunXBkLUFD8Y","type":"assistant","uuid":"fd722750-d009-4626-a437-9b441e10ad11","timestamp":"2026-01-20T16:18:10.340Z"}
{"parentUuid":"fd722750-d009-4626-a437-9b441e10ad11","isSidechain":true,"userType":"external","cwd":"/Users/csells/Code/gastownhall/website","sessionId":"dc9d694e-994e-4b73-9876-59c87b636ae6","version":"2.1.12","gitBranch":"main","agentId":"af83d1f","slug":"snappy-doodling-pudding","message":{"model":"claude-opus-4-5-20251101","id":"msg_01HpyXGpwkVFfjLj4m8MLPZk","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_018gncbqCPgoRk8gzqj5JALq","name":"Read","input":{"file_path":"/Users/csells/Code/gastownhall/website/docs-fodder/gastown-docs/reference.md"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":217,"cache_creation_input_tokens":1485,"cache_read_input_tokens":18134,"cache_creation":{"ephemeral_5m_input_tokens":1485,"ephemeral_1h_input_tokens":0},"output_tokens":1,"service_tier":"standard"}},"requestId":"req_011CXJw1ejLshunXBkLUFD8Y","type":"assistant","uuid":"635ff0ca-e233-4076-a97f-8a7d4f8e7a45","timestamp":"2026-01-20T16:18:10.913Z"}
{"parentUuid":"635ff0ca-e233-4076-a97f-8a7d4f8e7a45","isSidechain":true,"userType":"external","cwd":"/Users/csells/Code/gastownhall/website","sessionId":"dc9d694e-994e-4b73-9876-59c87b636ae6","version":"2.1.12","gitBranch":"main","agentId":"af83d1f","slug":"snappy-doodling-pudding","message":{"model":"claude-opus-4-5-20251101","id":"msg_01HpyXGpwkVFfjLj4m8MLPZk","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01BPsBVumdvXbp7di2Hzo1sj","name":"Read","input":{"file_path":"/Users/csells/Code/gastownhall/website/docs-fodder/gastown-docs/concepts/molecules.md"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":217,"cache_creation_input_tokens":1485,"cache_read_input_tokens":18134,"cache_creation":{"ephemeral_5m_input_tokens":1485,"ephemeral_1h_input_tokens":0},"output_tokens":1,"service_tier":"standard"}},"requestId":"req_011CXJw1ejLshunXBkLUFD8Y","type":"assistant","uuid":"b591dd7d-5f2e-4f4a-8b0b-fa8652615759","timestamp":"2026-01-20T16:18:11.216Z"}
{"parentUuid":"b591dd7d-5f2e-4f4a-8b0b-fa8652615759","isSidechain":true,"userType":"external","cwd":"/Users/csells/Code/gastownhall/website","sessionId":"dc9d694e-994e-4b73-9876-59c87b636ae6","version":"2.1.12","gitBranch":"main","agentId":"af83d1f","slug":"snappy-doodling-pudding","message":{"model":"claude-opus-4-5-20251101","id":"msg_01HpyXGpwkVFfjLj4m8MLPZk","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_019qdYus7cHhjXnULQ1yHEHs","name":"Read","input":{"file_path":"/Users/csells/Code/gastownhall/website/docs-fodder/gastown-docs/glossary.md"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":217,"cache_creation_input_tokens":1485,"cache_read_input_tokens":18134,"cache_creation":{"ephemeral_5m_input_tokens":1485,"ephemeral_1h_input_tokens":0},"output_tokens":1,"service_tier":"standard"}},"requestId":"req_011CXJw1ejLshunXBkLUFD8Y","type":"assistant","uuid":"ea4129ef-711f-45a6-bab8-05ab21398bfb","timestamp":"2026-01-20T16:18:11.690Z"}
{"parentUuid":"fd722750-d009-4626-a437-9b441e10ad11","isSidechain":true,"userType":"external","cwd":"/Users/csells/Code/gastownhall/website","sessionId":"dc9d694e-994e-4b73-9876-59c87b636ae6","version":"2.1.12","gitBranch":"main","agentId":"af83d1f","slug":"snappy-doodling-pudding","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01VbWD4zVryEsDbYojcVJHX7","type":"tool_result","content":"     1â†’# Understanding Gas Town\n     2â†’\n     3â†’This document provides a conceptual overview of Gas Town's architecture, focusing on\n     4â†’the role taxonomy and how different agents interact.\n     5â†’\n     6â†’## Why Gas Town Exists\n     7â†’\n     8â†’As AI agents become central to engineering workflows, teams face new challenges:\n     9â†’\n    10â†’- **Accountability:** Who did what? Which agent introduced this bug?\n    11â†’- **Quality:** Which agents are reliable? Which need tuning?\n    12â†’- **Efficiency:** How do you route work to the right agent?\n    13â†’- **Scale:** How do you coordinate agents across repos and teams?\n    14â†’\n    15â†’Gas Town is an orchestration layer that treats AI agent work as structured data.\n    16â†’Every action is attributed. Every agent has a track record. Every piece of work\n    17â†’has provenance. See [Why These Features](why-these-features.md) for the full rationale.\n    18â†’\n    19â†’## Role Taxonomy\n    20â†’\n    21â†’Gas Town has several agent types, each with distinct responsibilities and lifecycles.\n    22â†’\n    23â†’### Infrastructure Roles\n    24â†’\n    25â†’These roles manage the Gas Town system itself:\n    26â†’\n    27â†’| Role | Description | Lifecycle |\n    28â†’|------|-------------|-----------|\n    29â†’| **Mayor** | Global coordinator at mayor/ | Singleton, persistent |\n    30â†’| **Deacon** | Background supervisor daemon ([watchdog chain](design/watchdog-chain.md)) | Singleton, persistent |\n    31â†’| **Witness** | Per-rig polecat lifecycle manager | One per rig, persistent |\n    32â†’| **Refinery** | Per-rig merge queue processor | One per rig, persistent |\n    33â†’\n    34â†’### Worker Roles\n    35â†’\n    36â†’These roles do actual project work:\n    37â†’\n    38â†’| Role | Description | Lifecycle |\n    39â†’|------|-------------|-----------|\n    40â†’| **Polecat** | Ephemeral worker with own worktree | Transient, Witness-managed ([details](concepts/polecat-lifecycle.md)) |\n    41â†’| **Crew** | Persistent worker with own clone | Long-lived, user-managed |\n    42â†’| **Dog** | Deacon helper for infrastructure tasks | Ephemeral, Deacon-managed |\n    43â†’\n    44â†’## Convoys: Tracking Work\n    45â†’\n    46â†’A **convoy** (ðŸšš) is how you track batched work in Gas Town. When you kick off work -\n    47â†’even a single issue - create a convoy to track it.\n    48â†’\n    49â†’```bash\n    50â†’# Create a convoy tracking some issues\n    51â†’gt convoy create \"Feature X\" gt-abc gt-def --notify overseer\n    52â†’\n    53â†’# Check progress\n    54â†’gt convoy status hq-cv-abc\n    55â†’\n    56â†’# Dashboard of active convoys\n    57â†’gt convoy list\n    58â†’```\n    59â†’\n    60â†’**Why convoys matter:**\n    61â†’- Single view of \"what's in flight\"\n    62â†’- Cross-rig tracking (convoy in hq-*, issues in gt-*, bd-*)\n    63â†’- Auto-notification when work lands\n    64â†’- Historical record of completed work (`gt convoy list --all`)\n    65â†’\n    66â†’The \"swarm\" is ephemeral - just the workers currently assigned to a convoy's issues.\n    67â†’When issues close, the convoy lands. See [Convoys](concepts/convoy.md) for details.\n    68â†’\n    69â†’## Crew vs Polecats\n    70â†’\n    71â†’Both do project work, but with key differences:\n    72â†’\n    73â†’| Aspect | Crew | Polecat |\n    74â†’|--------|------|---------|\n    75â†’| **Lifecycle** | Persistent (user controls) | Transient (Witness controls) |\n    76â†’| **Monitoring** | None | Witness watches, nudges, recycles |\n    77â†’| **Work assignment** | Human-directed or self-assigned | Slung via `gt sling` |\n    78â†’| **Git state** | Pushes to main directly | Works on branch, Refinery merges |\n    79â†’| **Cleanup** | Manual | Automatic on completion |\n    80â†’| **Identity** | `<rig>/crew/<name>` | `<rig>/polecats/<name>` |\n    81â†’\n    82â†’**When to use Crew**:\n    83â†’- Exploratory work\n    84â†’- Long-running projects\n    85â†’- Work requiring human judgment\n    86â†’- Tasks where you want direct control\n    87â†’\n    88â†’**When to use Polecats**:\n    89â†’- Discrete, well-defined tasks\n    90â†’- Batch work (tracked via convoys)\n    91â†’- Parallelizable work\n    92â†’- Work that benefits from supervision\n    93â†’\n    94â†’## Dogs vs Crew\n    95â†’\n    96â†’**Dogs are NOT workers**. This is a common misconception.\n    97â†’\n    98â†’| Aspect | Dogs | Crew |\n    99â†’|--------|------|------|\n   100â†’| **Owner** | Deacon | Human |\n   101â†’| **Purpose** | Infrastructure tasks | Project work |\n   102â†’| **Scope** | Narrow, focused utilities | General purpose |\n   103â†’| **Lifecycle** | Very short (single task) | Long-lived |\n   104â†’| **Example** | Boot (triages Deacon health) | Joe (fixes bugs, adds features) |\n   105â†’\n   106â†’Dogs are the Deacon's helpers for system-level tasks:\n   107â†’- **Boot**: Triages Deacon health on daemon tick\n   108â†’- Future dogs might handle: log rotation, health checks, etc.\n   109â†’\n   110â†’If you need to do work in another rig, use **worktrees**, not dogs.\n   111â†’\n   112â†’## Cross-Rig Work Patterns\n   113â†’\n   114â†’When a crew member needs to work on another rig:\n   115â†’\n   116â†’### Option 1: Worktrees (Preferred)\n   117â†’\n   118â†’Create a worktree in the target rig:\n   119â†’\n   120â†’```bash\n   121â†’# gastown/crew/joe needs to fix a beads bug\n   122â†’gt worktree beads\n   123â†’# Creates ~/gt/beads/crew/gastown-joe/\n   124â†’# Identity preserved: BD_ACTOR = gastown/crew/joe\n   125â†’```\n   126â†’\n   127â†’Directory structure:\n   128â†’```\n   129â†’~/gt/beads/crew/gastown-joe/     # joe from gastown working on beads\n   130â†’~/gt/gastown/crew/beads-wolf/    # wolf from beads working on gastown\n   131â†’```\n   132â†’\n   133â†’### Option 2: Dispatch to Local Workers\n   134â†’\n   135â†’For work that should be owned by the target rig:\n   136â†’\n   137â†’```bash\n   138â†’# Create issue in target rig\n   139â†’bd create --prefix beads \"Fix authentication bug\"\n   140â†’\n   141â†’# Create convoy and sling to target rig\n   142â†’gt convoy create \"Auth fix\" bd-xyz\n   143â†’gt sling bd-xyz beads\n   144â†’```\n   145â†’\n   146â†’### When to Use Which\n   147â†’\n   148â†’| Scenario | Approach |\n   149â†’|----------|----------|\n   150â†’| You need to fix something quick | Worktree |\n   151â†’| Work should appear in your CV | Worktree |\n   152â†’| Work should be done by target rig team | Dispatch |\n   153â†’| Infrastructure/system task | Let Deacon handle it |\n   154â†’\n   155â†’## Directory Structure\n   156â†’\n   157â†’```\n   158â†’~/gt/                           Town root\n   159â†’â”œâ”€â”€ .beads/                     Town-level beads (hq-* prefix, mail)\n   160â†’â”œâ”€â”€ mayor/                      Mayor config\n   161â†’â”‚   â””â”€â”€ town.json\n   162â†’â”œâ”€â”€ deacon/                     Deacon daemon\n   163â†’â”‚   â””â”€â”€ dogs/                   Deacon helpers (NOT workers)\n   164â†’â”‚       â””â”€â”€ boot/               Health triage dog\n   165â†’â””â”€â”€ <rig>/                      Project container\n   166â†’    â”œâ”€â”€ config.json             Rig identity\n   167â†’    â”œâ”€â”€ .beads/ â†’ mayor/rig/.beads  (symlink or redirect)\n   168â†’    â”œâ”€â”€ .repo.git/              Bare repo (shared by worktrees)\n   169â†’    â”œâ”€â”€ mayor/rig/              Mayor's clone (canonical beads)\n   170â†’    â”œâ”€â”€ refinery/rig/           Worktree on main\n   171â†’    â”œâ”€â”€ witness/                No clone (monitors only)\n   172â†’    â”œâ”€â”€ crew/                   Persistent human workspaces\n   173â†’    â”‚   â”œâ”€â”€ joe/                Local crew member\n   174â†’    â”‚   â””â”€â”€ beads-wolf/         Cross-rig worktree (wolf from beads)\n   175â†’    â””â”€â”€ polecats/               Ephemeral worker worktrees\n   176â†’        â””â”€â”€ Toast/              Individual polecat\n   177â†’```\n   178â†’\n   179â†’## Identity and Attribution\n   180â†’\n   181â†’All work is attributed to the actor who performed it:\n   182â†’\n   183â†’```\n   184â†’Git commits:      Author: gastown/crew/joe <owner@example.com>\n   185â†’Beads issues:     created_by: gastown/crew/joe\n   186â†’Events:           actor: gastown/crew/joe\n   187â†’```\n   188â†’\n   189â†’Identity is preserved even when working cross-rig:\n   190â†’- `gastown/crew/joe` working in `~/gt/beads/crew/gastown-joe/`\n   191â†’- Commits still attributed to `gastown/crew/joe`\n   192â†’- Work appears on joe's CV, not beads rig's workers\n   193â†’\n   194â†’## The Propulsion Principle\n   195â†’\n   196â†’All Gas Town agents follow the same core principle:\n   197â†’\n   198â†’> **If you find something on your hook, YOU RUN IT.**\n   199â†’\n   200â†’This applies regardless of role. The hook is your assignment. Execute it immediately\n   201â†’without waiting for confirmation. Gas Town is a steam engine - agents are pistons.\n   202â†’\n   203â†’## Model Evaluation and A/B Testing\n   204â†’\n   205â†’Gas Town's attribution and work history features enable objective model comparison:\n   206â†’\n   207â†’```bash\n   208â†’# Deploy different models on similar tasks\n   209â†’gt sling gt-abc gastown --model=claude-sonnet\n   210â†’gt sling gt-def gastown --model=gpt-4\n   211â†’\n   212â†’# Compare outcomes\n   213â†’bd stats --actor=gastown/polecats/* --group-by=model\n   214â†’```\n   215â†’\n   216â†’Because every task has completion time, quality signals, and revision count,\n   217â†’you can make data-driven decisions about which models to deploy where.\n   218â†’\n   219â†’This is particularly valuable for:\n   220â†’- **Model selection:** Which model handles your codebase best?\n   221â†’- **Capability mapping:** Claude for architecture, GPT for tests?\n   222â†’- **Cost optimization:** When is a smaller model sufficient?\n   223â†’\n   224â†’## Common Mistakes\n   225â†’\n   226â†’1. **Using dogs for user work**: Dogs are Deacon infrastructure. Use crew or polecats.\n   227â†’2. **Confusing crew with polecats**: Crew is persistent and human-managed. Polecats are transient and Witness-managed.\n   228â†’3. **Working in wrong directory**: Gas Town uses cwd for identity detection. Stay in your home directory.\n   229â†’4. **Waiting for confirmation when work is hooked**: The hook IS your assignment. Execute immediately.\n   230â†’5. **Creating worktrees when dispatch is better**: If work should be owned by the target rig, dispatch it instead.\n   231â†’\n\n<system-reminder>\nWhenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.\n</system-reminder>\n"}]},"uuid":"37105354-3f18-4e6d-aa62-af7ee49f2211","timestamp":"2026-01-20T16:18:12.601Z","toolUseResult":{"type":"text","file":{"filePath":"/Users/csells/Code/gastownhall/website/docs-fodder/gastown-docs/overview.md","content":"# Understanding Gas Town\n\nThis document provides a conceptual overview of Gas Town's architecture, focusing on\nthe role taxonomy and how different agents interact.\n\n## Why Gas Town Exists\n\nAs AI agents become central to engineering workflows, teams face new challenges:\n\n- **Accountability:** Who did what? Which agent introduced this bug?\n- **Quality:** Which agents are reliable? Which need tuning?\n- **Efficiency:** How do you route work to the right agent?\n- **Scale:** How do you coordinate agents across repos and teams?\n\nGas Town is an orchestration layer that treats AI agent work as structured data.\nEvery action is attributed. Every agent has a track record. Every piece of work\nhas provenance. See [Why These Features](why-these-features.md) for the full rationale.\n\n## Role Taxonomy\n\nGas Town has several agent types, each with distinct responsibilities and lifecycles.\n\n### Infrastructure Roles\n\nThese roles manage the Gas Town system itself:\n\n| Role | Description | Lifecycle |\n|------|-------------|-----------|\n| **Mayor** | Global coordinator at mayor/ | Singleton, persistent |\n| **Deacon** | Background supervisor daemon ([watchdog chain](design/watchdog-chain.md)) | Singleton, persistent |\n| **Witness** | Per-rig polecat lifecycle manager | One per rig, persistent |\n| **Refinery** | Per-rig merge queue processor | One per rig, persistent |\n\n### Worker Roles\n\nThese roles do actual project work:\n\n| Role | Description | Lifecycle |\n|------|-------------|-----------|\n| **Polecat** | Ephemeral worker with own worktree | Transient, Witness-managed ([details](concepts/polecat-lifecycle.md)) |\n| **Crew** | Persistent worker with own clone | Long-lived, user-managed |\n| **Dog** | Deacon helper for infrastructure tasks | Ephemeral, Deacon-managed |\n\n## Convoys: Tracking Work\n\nA **convoy** (ðŸšš) is how you track batched work in Gas Town. When you kick off work -\neven a single issue - create a convoy to track it.\n\n```bash\n# Create a convoy tracking some issues\ngt convoy create \"Feature X\" gt-abc gt-def --notify overseer\n\n# Check progress\ngt convoy status hq-cv-abc\n\n# Dashboard of active convoys\ngt convoy list\n```\n\n**Why convoys matter:**\n- Single view of \"what's in flight\"\n- Cross-rig tracking (convoy in hq-*, issues in gt-*, bd-*)\n- Auto-notification when work lands\n- Historical record of completed work (`gt convoy list --all`)\n\nThe \"swarm\" is ephemeral - just the workers currently assigned to a convoy's issues.\nWhen issues close, the convoy lands. See [Convoys](concepts/convoy.md) for details.\n\n## Crew vs Polecats\n\nBoth do project work, but with key differences:\n\n| Aspect | Crew | Polecat |\n|--------|------|---------|\n| **Lifecycle** | Persistent (user controls) | Transient (Witness controls) |\n| **Monitoring** | None | Witness watches, nudges, recycles |\n| **Work assignment** | Human-directed or self-assigned | Slung via `gt sling` |\n| **Git state** | Pushes to main directly | Works on branch, Refinery merges |\n| **Cleanup** | Manual | Automatic on completion |\n| **Identity** | `<rig>/crew/<name>` | `<rig>/polecats/<name>` |\n\n**When to use Crew**:\n- Exploratory work\n- Long-running projects\n- Work requiring human judgment\n- Tasks where you want direct control\n\n**When to use Polecats**:\n- Discrete, well-defined tasks\n- Batch work (tracked via convoys)\n- Parallelizable work\n- Work that benefits from supervision\n\n## Dogs vs Crew\n\n**Dogs are NOT workers**. This is a common misconception.\n\n| Aspect | Dogs | Crew |\n|--------|------|------|\n| **Owner** | Deacon | Human |\n| **Purpose** | Infrastructure tasks | Project work |\n| **Scope** | Narrow, focused utilities | General purpose |\n| **Lifecycle** | Very short (single task) | Long-lived |\n| **Example** | Boot (triages Deacon health) | Joe (fixes bugs, adds features) |\n\nDogs are the Deacon's helpers for system-level tasks:\n- **Boot**: Triages Deacon health on daemon tick\n- Future dogs might handle: log rotation, health checks, etc.\n\nIf you need to do work in another rig, use **worktrees**, not dogs.\n\n## Cross-Rig Work Patterns\n\nWhen a crew member needs to work on another rig:\n\n### Option 1: Worktrees (Preferred)\n\nCreate a worktree in the target rig:\n\n```bash\n# gastown/crew/joe needs to fix a beads bug\ngt worktree beads\n# Creates ~/gt/beads/crew/gastown-joe/\n# Identity preserved: BD_ACTOR = gastown/crew/joe\n```\n\nDirectory structure:\n```\n~/gt/beads/crew/gastown-joe/     # joe from gastown working on beads\n~/gt/gastown/crew/beads-wolf/    # wolf from beads working on gastown\n```\n\n### Option 2: Dispatch to Local Workers\n\nFor work that should be owned by the target rig:\n\n```bash\n# Create issue in target rig\nbd create --prefix beads \"Fix authentication bug\"\n\n# Create convoy and sling to target rig\ngt convoy create \"Auth fix\" bd-xyz\ngt sling bd-xyz beads\n```\n\n### When to Use Which\n\n| Scenario | Approach |\n|----------|----------|\n| You need to fix something quick | Worktree |\n| Work should appear in your CV | Worktree |\n| Work should be done by target rig team | Dispatch |\n| Infrastructure/system task | Let Deacon handle it |\n\n## Directory Structure\n\n```\n~/gt/                           Town root\nâ”œâ”€â”€ .beads/                     Town-level beads (hq-* prefix, mail)\nâ”œâ”€â”€ mayor/                      Mayor config\nâ”‚   â””â”€â”€ town.json\nâ”œâ”€â”€ deacon/                     Deacon daemon\nâ”‚   â””â”€â”€ dogs/                   Deacon helpers (NOT workers)\nâ”‚       â””â”€â”€ boot/               Health triage dog\nâ””â”€â”€ <rig>/                      Project container\n    â”œâ”€â”€ config.json             Rig identity\n    â”œâ”€â”€ .beads/ â†’ mayor/rig/.beads  (symlink or redirect)\n    â”œâ”€â”€ .repo.git/              Bare repo (shared by worktrees)\n    â”œâ”€â”€ mayor/rig/              Mayor's clone (canonical beads)\n    â”œâ”€â”€ refinery/rig/           Worktree on main\n    â”œâ”€â”€ witness/                No clone (monitors only)\n    â”œâ”€â”€ crew/                   Persistent human workspaces\n    â”‚   â”œâ”€â”€ joe/                Local crew member\n    â”‚   â””â”€â”€ beads-wolf/         Cross-rig worktree (wolf from beads)\n    â””â”€â”€ polecats/               Ephemeral worker worktrees\n        â””â”€â”€ Toast/              Individual polecat\n```\n\n## Identity and Attribution\n\nAll work is attributed to the actor who performed it:\n\n```\nGit commits:      Author: gastown/crew/joe <owner@example.com>\nBeads issues:     created_by: gastown/crew/joe\nEvents:           actor: gastown/crew/joe\n```\n\nIdentity is preserved even when working cross-rig:\n- `gastown/crew/joe` working in `~/gt/beads/crew/gastown-joe/`\n- Commits still attributed to `gastown/crew/joe`\n- Work appears on joe's CV, not beads rig's workers\n\n## The Propulsion Principle\n\nAll Gas Town agents follow the same core principle:\n\n> **If you find something on your hook, YOU RUN IT.**\n\nThis applies regardless of role. The hook is your assignment. Execute it immediately\nwithout waiting for confirmation. Gas Town is a steam engine - agents are pistons.\n\n## Model Evaluation and A/B Testing\n\nGas Town's attribution and work history features enable objective model comparison:\n\n```bash\n# Deploy different models on similar tasks\ngt sling gt-abc gastown --model=claude-sonnet\ngt sling gt-def gastown --model=gpt-4\n\n# Compare outcomes\nbd stats --actor=gastown/polecats/* --group-by=model\n```\n\nBecause every task has completion time, quality signals, and revision count,\nyou can make data-driven decisions about which models to deploy where.\n\nThis is particularly valuable for:\n- **Model selection:** Which model handles your codebase best?\n- **Capability mapping:** Claude for architecture, GPT for tests?\n- **Cost optimization:** When is a smaller model sufficient?\n\n## Common Mistakes\n\n1. **Using dogs for user work**: Dogs are Deacon infrastructure. Use crew or polecats.\n2. **Confusing crew with polecats**: Crew is persistent and human-managed. Polecats are transient and Witness-managed.\n3. **Working in wrong directory**: Gas Town uses cwd for identity detection. Stay in your home directory.\n4. **Waiting for confirmation when work is hooked**: The hook IS your assignment. Execute immediately.\n5. **Creating worktrees when dispatch is better**: If work should be owned by the target rig, dispatch it instead.\n","numLines":231,"startLine":1,"totalLines":231}},"sourceToolAssistantUUID":"fd722750-d009-4626-a437-9b441e10ad11"}
{"parentUuid":"635ff0ca-e233-4076-a97f-8a7d4f8e7a45","isSidechain":true,"userType":"external","cwd":"/Users/csells/Code/gastownhall/website","sessionId":"dc9d694e-994e-4b73-9876-59c87b636ae6","version":"2.1.12","gitBranch":"main","agentId":"af83d1f","slug":"snappy-doodling-pudding","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_018gncbqCPgoRk8gzqj5JALq","type":"tool_result","content":"     1â†’# Gas Town Reference\n     2â†’\n     3â†’Technical reference for Gas Town internals. Read the README first.\n     4â†’\n     5â†’## Directory Structure\n     6â†’\n     7â†’```\n     8â†’~/gt/                           Town root\n     9â†’â”œâ”€â”€ .beads/                     Town-level beads (hq-* prefix)\n    10â†’â”œâ”€â”€ mayor/                      Mayor agent home (town coordinator)\n    11â†’â”‚   â”œâ”€â”€ town.json               Town configuration\n    12â†’â”‚   â”œâ”€â”€ CLAUDE.md               Mayor context (on disk)\n    13â†’â”‚   â””â”€â”€ .claude/settings.json   Mayor Claude settings\n    14â†’â”œâ”€â”€ deacon/                     Deacon agent home (background supervisor)\n    15â†’â”‚   â””â”€â”€ .claude/settings.json   Deacon settings (context via gt prime)\n    16â†’â””â”€â”€ <rig>/                      Project container (NOT a git clone)\n    17â†’    â”œâ”€â”€ config.json             Rig identity\n    18â†’    â”œâ”€â”€ .beads/ â†’ mayor/rig/.beads\n    19â†’    â”œâ”€â”€ .repo.git/              Bare repo (shared by worktrees)\n    20â†’    â”œâ”€â”€ mayor/rig/              Mayor's clone (canonical beads)\n    21â†’    â”‚   â””â”€â”€ CLAUDE.md           Per-rig mayor context (on disk)\n    22â†’    â”œâ”€â”€ witness/                Witness agent home (monitors only)\n    23â†’    â”‚   â””â”€â”€ .claude/settings.json  (context via gt prime)\n    24â†’    â”œâ”€â”€ refinery/               Refinery settings parent\n    25â†’    â”‚   â”œâ”€â”€ .claude/settings.json\n    26â†’    â”‚   â””â”€â”€ rig/                Worktree on main\n    27â†’    â”‚       â””â”€â”€ CLAUDE.md       Refinery context (on disk)\n    28â†’    â”œâ”€â”€ crew/                   Crew settings parent (shared)\n    29â†’    â”‚   â”œâ”€â”€ .claude/settings.json  (context via gt prime)\n    30â†’    â”‚   â””â”€â”€ <name>/rig/         Human workspaces\n    31â†’    â””â”€â”€ polecats/               Polecat settings parent (shared)\n    32â†’        â”œâ”€â”€ .claude/settings.json  (context via gt prime)\n    33â†’        â””â”€â”€ <name>/rig/         Worker worktrees\n    34â†’```\n    35â†’\n    36â†’**Key points:**\n    37â†’\n    38â†’- Rig root is a container, not a clone\n    39â†’- `.repo.git/` is bare - refinery and polecats are worktrees\n    40â†’- Per-rig `mayor/rig/` holds canonical `.beads/`, others inherit via redirect\n    41â†’- Settings placed in parent dirs (not git clones) for upward traversal\n    42â†’\n    43â†’## Beads Routing\n    44â†’\n    45â†’Gas Town routes beads commands based on issue ID prefix. You don't need to think\n    46â†’about which database to use - just use the issue ID.\n    47â†’\n    48â†’```bash\n    49â†’bd show gp-xyz    # Routes to greenplace rig's beads\n    50â†’bd show hq-abc    # Routes to town-level beads\n    51â†’bd show wyv-123   # Routes to wyvern rig's beads\n    52â†’```\n    53â†’\n    54â†’**How it works**: Routes are defined in `~/gt/.beads/routes.jsonl`. Each rig's\n    55â†’prefix maps to its beads location (the mayor's clone in that rig).\n    56â†’\n    57â†’| Prefix | Routes To | Purpose |\n    58â†’|--------|-----------|---------|\n    59â†’| `hq-*` | `~/gt/.beads/` | Mayor mail, cross-rig coordination |\n    60â†’| `gp-*` | `~/gt/greenplace/mayor/rig/.beads/` | Greenplace project issues |\n    61â†’| `wyv-*` | `~/gt/wyvern/mayor/rig/.beads/` | Wyvern project issues |\n    62â†’\n    63â†’Debug routing: `BD_DEBUG_ROUTING=1 bd show <id>`\n    64â†’\n    65â†’## Configuration\n    66â†’\n    67â†’### Rig Config (`config.json`)\n    68â†’\n    69â†’```json\n    70â†’{\n    71â†’  \"type\": \"rig\",\n    72â†’  \"name\": \"myproject\",\n    73â†’  \"git_url\": \"https://github.com/...\",\n    74â†’  \"beads\": { \"prefix\": \"mp\" }\n    75â†’}\n    76â†’```\n    77â†’\n    78â†’### Settings (`settings/config.json`)\n    79â†’\n    80â†’```json\n    81â†’{\n    82â†’  \"theme\": \"desert\",\n    83â†’  \"max_workers\": 5,\n    84â†’  \"merge_queue\": { \"enabled\": true }\n    85â†’}\n    86â†’```\n    87â†’\n    88â†’### Runtime (`.runtime/` - gitignored)\n    89â†’\n    90â†’Process state, PIDs, ephemeral data.\n    91â†’\n    92â†’## Formula Format\n    93â†’\n    94â†’```toml\n    95â†’formula = \"name\"\n    96â†’type = \"workflow\"           # workflow | expansion | aspect\n    97â†’version = 1\n    98â†’description = \"...\"\n    99â†’\n   100â†’[vars.feature]\n   101â†’description = \"...\"\n   102â†’required = true\n   103â†’\n   104â†’[[steps]]\n   105â†’id = \"step-id\"\n   106â†’title = \"{{feature}}\"\n   107â†’description = \"...\"\n   108â†’needs = [\"other-step\"]      # Dependencies\n   109â†’```\n   110â†’\n   111â†’**Composition:**\n   112â†’\n   113â†’```toml\n   114â†’extends = [\"base-formula\"]\n   115â†’\n   116â†’[compose]\n   117â†’aspects = [\"cross-cutting\"]\n   118â†’\n   119â†’[[compose.expand]]\n   120â†’target = \"step-id\"\n   121â†’with = \"macro-formula\"\n   122â†’```\n   123â†’\n   124â†’## Molecule Lifecycle\n   125â†’\n   126â†’```\n   127â†’Formula (source TOML) â”€â”€â”€ \"Ice-9\"\n   128â†’    â”‚\n   129â†’    â–¼ bd cook\n   130â†’Protomolecule (frozen template) â”€â”€â”€ Solid\n   131â†’    â”‚\n   132â†’    â”œâ”€â–¶ bd mol pour â”€â”€â–¶ Mol (persistent) â”€â”€â”€ Liquid â”€â”€â–¶ bd squash â”€â”€â–¶ Digest\n   133â†’    â”‚\n   134â†’    â””â”€â–¶ bd mol wisp â”€â”€â–¶ Wisp (ephemeral) â”€â”€â”€ Vapor â”€â”€â”¬â–¶ bd squash â”€â”€â–¶ Digest\n   135â†’                                                  â””â–¶ bd burn â”€â”€â–¶ (gone)\n   136â†’```\n   137â†’\n   138â†’**Note**: Wisps are stored in `.beads/` with an ephemeral flag - they're not\n   139â†’persisted to JSONL. They exist only in memory during execution.\n   140â†’\n   141â†’## Molecule Commands\n   142â†’\n   143â†’**Principle**: `bd` = beads data operations, `gt` = agent operations.\n   144â†’\n   145â†’### Beads Operations (bd)\n   146â†’\n   147â†’```bash\n   148â†’# Formulas\n   149â†’bd formula list              # Available formulas\n   150â†’bd formula show <name>       # Formula details\n   151â†’bd cook <formula>            # Formula â†’ Proto\n   152â†’\n   153â†’# Molecules (data operations)\n   154â†’bd mol list                  # Available protos\n   155â†’bd mol show <id>             # Proto details\n   156â†’bd mol pour <proto>          # Create mol\n   157â†’bd mol wisp <proto>          # Create wisp\n   158â†’bd mol bond <proto> <parent> # Attach to existing mol\n   159â†’bd mol squash <id>           # Condense to digest (explicit ID)\n   160â†’bd mol burn <id>             # Discard wisp (explicit ID)\n   161â†’```\n   162â†’\n   163â†’### Agent Operations (gt)\n   164â†’\n   165â†’```bash\n   166â†’# Hook management (operates on current agent's hook)\n   167â†’gt hook                    # What's on MY hook\n   168â†’gt mol current               # What should I work on next\n   169â†’gt mol progress <id>         # Execution progress of molecule\n   170â†’gt mol attach <bead> <mol>   # Pin molecule to bead\n   171â†’gt mol detach <bead>         # Unpin molecule from bead\n   172â†’gt mol attach-from-mail <id> # Attach from mail message\n   173â†’\n   174â†’# Agent lifecycle (operates on agent's attached molecule)\n   175â†’gt mol burn                  # Burn attached molecule (no ID needed)\n   176â†’gt mol squash                # Squash attached molecule (no ID needed)\n   177â†’gt mol step done <step>      # Complete a molecule step\n   178â†’```\n   179â†’\n   180â†’**Key distinction**: `bd mol burn/squash <id>` take explicit molecule IDs.\n   181â†’`gt mol burn/squash` operate on the current agent's attached molecule\n   182â†’(auto-detected from working directory).\n   183â†’\n   184â†’## Agent Lifecycle\n   185â†’\n   186â†’### Polecat Shutdown\n   187â†’\n   188â†’```\n   189â†’1. Complete work steps\n   190â†’2. bd mol squash (create digest)\n   191â†’3. Submit to merge queue\n   192â†’4. gt handoff (request shutdown)\n   193â†’5. Wait for Witness to kill session\n   194â†’6. Witness removes worktree + branch\n   195â†’```\n   196â†’\n   197â†’### Session Cycling\n   198â†’\n   199â†’```\n   200â†’1. Agent notices context filling\n   201â†’2. gt handoff (sends mail to self)\n   202â†’3. Manager kills session\n   203â†’4. Manager starts new session\n   204â†’5. New session reads handoff mail\n   205â†’```\n   206â†’\n   207â†’## Environment Variables\n   208â†’\n   209â†’Gas Town sets environment variables for each agent session via `config.AgentEnv()`.\n   210â†’These are set in tmux session environment when agents are spawned.\n   211â†’\n   212â†’### Core Variables (All Agents)\n   213â†’\n   214â†’| Variable | Purpose | Example |\n   215â†’|----------|---------|---------|\n   216â†’| `GT_ROLE` | Agent role type | `mayor`, `witness`, `polecat`, `crew` |\n   217â†’| `GT_ROOT` | Town root directory | `/home/user/gt` |\n   218â†’| `BD_ACTOR` | Agent identity for attribution | `gastown/polecats/toast` |\n   219â†’| `GIT_AUTHOR_NAME` | Commit attribution (same as BD_ACTOR) | `gastown/polecats/toast` |\n   220â†’| `BEADS_DIR` | Beads database location | `/home/user/gt/gastown/.beads` |\n   221â†’\n   222â†’### Rig-Level Variables\n   223â†’\n   224â†’| Variable | Purpose | Roles |\n   225â†’|----------|---------|-------|\n   226â†’| `GT_RIG` | Rig name | witness, refinery, polecat, crew |\n   227â†’| `GT_POLECAT` | Polecat worker name | polecat only |\n   228â†’| `GT_CREW` | Crew worker name | crew only |\n   229â†’| `BEADS_AGENT_NAME` | Agent name for beads operations | polecat, crew |\n   230â†’| `BEADS_NO_DAEMON` | Disable beads daemon (isolated context) | polecat, crew |\n   231â†’\n   232â†’### Other Variables\n   233â†’\n   234â†’| Variable | Purpose |\n   235â†’|----------|---------|\n   236â†’| `GIT_AUTHOR_EMAIL` | Workspace owner email (from git config) |\n   237â†’| `GT_TOWN_ROOT` | Override town root detection (manual use) |\n   238â†’| `CLAUDE_RUNTIME_CONFIG_DIR` | Custom Claude settings directory |\n   239â†’\n   240â†’### Environment by Role\n   241â†’\n   242â†’| Role | Key Variables |\n   243â†’|------|---------------|\n   244â†’| **Mayor** | `GT_ROLE=mayor`, `BD_ACTOR=mayor` |\n   245â†’| **Deacon** | `GT_ROLE=deacon`, `BD_ACTOR=deacon` |\n   246â†’| **Boot** | `GT_ROLE=boot`, `BD_ACTOR=deacon-boot` |\n   247â†’| **Witness** | `GT_ROLE=witness`, `GT_RIG=<rig>`, `BD_ACTOR=<rig>/witness` |\n   248â†’| **Refinery** | `GT_ROLE=refinery`, `GT_RIG=<rig>`, `BD_ACTOR=<rig>/refinery` |\n   249â†’| **Polecat** | `GT_ROLE=polecat`, `GT_RIG=<rig>`, `GT_POLECAT=<name>`, `BD_ACTOR=<rig>/polecats/<name>` |\n   250â†’| **Crew** | `GT_ROLE=crew`, `GT_RIG=<rig>`, `GT_CREW=<name>`, `BD_ACTOR=<rig>/crew/<name>` |\n   251â†’\n   252â†’### Doctor Check\n   253â†’\n   254â†’The `gt doctor` command verifies that running tmux sessions have correct\n   255â†’environment variables. Mismatches are reported as warnings:\n   256â†’\n   257â†’```\n   258â†’âš  env-vars: Found 3 env var mismatch(es) across 1 session(s)\n   259â†’    hq-mayor: missing GT_ROOT (expected \"/home/user/gt\")\n   260â†’```\n   261â†’\n   262â†’Fix by restarting sessions: `gt shutdown && gt up`\n   263â†’\n   264â†’## Agent Working Directories and Settings\n   265â†’\n   266â†’Each agent runs in a specific working directory and has its own Claude settings.\n   267â†’Understanding this hierarchy is essential for proper configuration.\n   268â†’\n   269â†’### Working Directories by Role\n   270â†’\n   271â†’| Role | Working Directory | Notes |\n   272â†’|------|-------------------|-------|\n   273â†’| **Mayor** | `~/gt/mayor/` | Town-level coordinator, isolated from rigs |\n   274â†’| **Deacon** | `~/gt/deacon/` | Background supervisor daemon |\n   275â†’| **Witness** | `~/gt/<rig>/witness/` | No git clone, monitors polecats only |\n   276â†’| **Refinery** | `~/gt/<rig>/refinery/rig/` | Worktree on main branch |\n   277â†’| **Crew** | `~/gt/<rig>/crew/<name>/rig/` | Persistent human workspace clone |\n   278â†’| **Polecat** | `~/gt/<rig>/polecats/<name>/rig/` | Ephemeral worker worktree |\n   279â†’\n   280â†’Note: The per-rig `<rig>/mayor/rig/` directory is NOT a working directoryâ€”it's\n   281â†’a git clone that holds the canonical `.beads/` database for that rig.\n   282â†’\n   283â†’### Settings File Locations\n   284â†’\n   285â†’Claude Code searches for `.claude/settings.json` starting from the working\n   286â†’directory and traversing upward. Settings are placed in **parent directories**\n   287â†’(not inside git clones) so they're found via directory traversal without\n   288â†’polluting source repositories:\n   289â†’\n   290â†’```\n   291â†’~/gt/\n   292â†’â”œâ”€â”€ mayor/.claude/settings.json          # Mayor settings\n   293â†’â”œâ”€â”€ deacon/.claude/settings.json         # Deacon settings\n   294â†’â””â”€â”€ <rig>/\n   295â†’    â”œâ”€â”€ witness/.claude/settings.json    # Witness settings (no rig/ subdir)\n   296â†’    â”œâ”€â”€ refinery/.claude/settings.json   # Found by refinery/rig/ via traversal\n   297â†’    â”œâ”€â”€ crew/.claude/settings.json       # Shared by all crew/<name>/rig/\n   298â†’    â””â”€â”€ polecats/.claude/settings.json   # Shared by all polecats/<name>/rig/\n   299â†’```\n   300â†’\n   301â†’**Why parent directories?** Agents working in git clones (like `refinery/rig/`)\n   302â†’would pollute the source repo if settings were placed there. By putting settings\n   303â†’one level up, Claude finds them via upward traversal, and all workers of the\n   304â†’same type share the same settings.\n   305â†’\n   306â†’### CLAUDE.md Locations\n   307â†’\n   308â†’Role context is delivered via CLAUDE.md files or ephemeral injection:\n   309â†’\n   310â†’| Role | CLAUDE.md Location | Method |\n   311â†’|------|-------------------|--------|\n   312â†’| **Mayor** | `~/gt/mayor/CLAUDE.md` | On disk |\n   313â†’| **Deacon** | (none) | Injected via `gt prime` at SessionStart |\n   314â†’| **Witness** | (none) | Injected via `gt prime` at SessionStart |\n   315â†’| **Refinery** | `<rig>/refinery/rig/CLAUDE.md` | On disk (inside worktree) |\n   316â†’| **Crew** | (none) | Injected via `gt prime` at SessionStart |\n   317â†’| **Polecat** | (none) | Injected via `gt prime` at SessionStart |\n   318â†’\n   319â†’Additionally, each rig has `<rig>/mayor/rig/CLAUDE.md` for the per-rig mayor clone\n   320â†’(used for beads operations, not a running agent).\n   321â†’\n   322â†’**Why ephemeral injection?** Writing CLAUDE.md into git clones would:\n   323â†’1. Pollute source repos when agents commit/push\n   324â†’2. Leak Gas Town internals into project history\n   325â†’3. Conflict with project-specific CLAUDE.md files\n   326â†’\n   327â†’The `gt prime` command runs at SessionStart hook and injects context without\n   328â†’persisting it to disk.\n   329â†’\n   330â†’### Sparse Checkout (Source Repo Isolation)\n   331â†’\n   332â†’When agents work on source repositories that have their own Claude Code configuration,\n   333â†’Gas Town uses git sparse checkout to exclude all context files:\n   334â†’\n   335â†’```bash\n   336â†’# Automatically configured for worktrees - excludes:\n   337â†’# - .claude/       : settings, rules, agents, commands\n   338â†’# - CLAUDE.md      : primary context file\n   339â†’# - CLAUDE.local.md: personal context file\n   340â†’# - .mcp.json      : MCP server configuration\n   341â†’git sparse-checkout set --no-cone '/*' '!/.claude/' '!/CLAUDE.md' '!/CLAUDE.local.md' '!/.mcp.json'\n   342â†’```\n   343â†’\n   344â†’This ensures agents use Gas Town's context, not the source repo's instructions.\n   345â†’\n   346â†’**Doctor check**: `gt doctor` verifies sparse checkout is configured correctly.\n   347â†’Run `gt doctor --fix` to update legacy configurations missing the newer patterns.\n   348â†’\n   349â†’### Settings Inheritance\n   350â†’\n   351â†’Claude Code's settings search order (first match wins):\n   352â†’\n   353â†’1. `.claude/settings.json` in current working directory\n   354â†’2. `.claude/settings.json` in parent directories (traversing up)\n   355â†’3. `~/.claude/settings.json` (user global settings)\n   356â†’\n   357â†’Gas Town places settings at each agent's working directory root, so agents\n   358â†’find their role-specific settings before reaching any parent or global config.\n   359â†’\n   360â†’### Settings Templates\n   361â†’\n   362â†’Gas Town uses two settings templates based on role type:\n   363â†’\n   364â†’| Type | Roles | Key Difference |\n   365â†’|------|-------|----------------|\n   366â†’| **Interactive** | Mayor, Crew | Mail injected on `UserPromptSubmit` hook |\n   367â†’| **Autonomous** | Polecat, Witness, Refinery, Deacon | Mail injected on `SessionStart` hook |\n   368â†’\n   369â†’Autonomous agents may start without user input, so they need mail checked\n   370â†’at session start. Interactive agents wait for user prompts.\n   371â†’\n   372â†’### Troubleshooting\n   373â†’\n   374â†’| Problem | Solution |\n   375â†’|---------|----------|\n   376â†’| Agent using wrong settings | Check `gt doctor`, verify sparse checkout |\n   377â†’| Settings not found | Ensure `.claude/settings.json` exists at role home |\n   378â†’| Source repo settings leaking | Run `gt doctor --fix` to configure sparse checkout |\n   379â†’| Mayor settings affecting polecats | Mayor should run in `mayor/`, not town root |\n   380â†’\n   381â†’## CLI Reference\n   382â†’\n   383â†’### Town Management\n   384â†’\n   385â†’```bash\n   386â†’gt install [path]            # Create town\n   387â†’gt install --git             # With git init\n   388â†’gt doctor                    # Health check\n   389â†’gt doctor --fix              # Auto-repair\n   390â†’```\n   391â†’\n   392â†’### Configuration\n   393â†’\n   394â†’```bash\n   395â†’# Agent management\n   396â†’gt config agent list [--json]     # List all agents (built-in + custom)\n   397â†’gt config agent get <name>        # Show agent configuration\n   398â†’gt config agent set <name> <cmd>  # Create or update custom agent\n   399â†’gt config agent remove <name>     # Remove custom agent (built-ins protected)\n   400â†’\n   401â†’# Default agent\n   402â†’gt config default-agent [name]    # Get or set town default agent\n   403â†’```\n   404â†’\n   405â†’**Built-in agents**: `claude`, `gemini`, `codex`, `cursor`, `auggie`, `amp`\n   406â†’\n   407â†’**Custom agents**: Define per-town via CLI or JSON:\n   408â†’```bash\n   409â†’gt config agent set claude-glm \"claude-glm --model glm-4\"\n   410â†’gt config agent set claude \"claude-opus\"  # Override built-in\n   411â†’gt config default-agent claude-glm       # Set default\n   412â†’```\n   413â†’\n   414â†’**Advanced agent config** (`settings/agents.json`):\n   415â†’```json\n   416â†’{\n   417â†’  \"version\": 1,\n   418â†’  \"agents\": {\n   419â†’    \"opencode\": {\n   420â†’      \"command\": \"opencode\",\n   421â†’      \"args\": [],\n   422â†’      \"resume_flag\": \"--session\",\n   423â†’      \"resume_style\": \"flag\",\n   424â†’      \"non_interactive\": {\n   425â†’        \"subcommand\": \"run\",\n   426â†’        \"output_flag\": \"--format json\"\n   427â†’      }\n   428â†’    }\n   429â†’  }\n   430â†’}\n   431â†’```\n   432â†’\n   433â†’**Rig-level agents** (`<rig>/settings/config.json`):\n   434â†’```json\n   435â†’{\n   436â†’  \"type\": \"rig-settings\",\n   437â†’  \"version\": 1,\n   438â†’  \"agent\": \"opencode\",\n   439â†’  \"agents\": {\n   440â†’    \"opencode\": {\n   441â†’      \"command\": \"opencode\",\n   442â†’      \"args\": [\"--session\"]\n   443â†’    }\n   444â†’  }\n   445â†’}\n   446â†’```\n   447â†’\n   448â†’**Agent resolution order**: rig-level â†’ town-level â†’ built-in presets.\n   449â†’\n   450â†’For OpenCode autonomous mode, set env var in your shell profile:\n   451â†’```bash\n   452â†’export OPENCODE_PERMISSION='{\"*\":\"allow\"}'\n   453â†’```\n   454â†’\n   455â†’### Rig Management\n   456â†’\n   457â†’```bash\n   458â†’gt rig add <name> <url>\n   459â†’gt rig list\n   460â†’gt rig remove <name>\n   461â†’```\n   462â†’\n   463â†’### Convoy Management (Primary Dashboard)\n   464â†’\n   465â†’```bash\n   466â†’gt convoy list                          # Dashboard of active convoys\n   467â†’gt convoy status [convoy-id]            # Show progress (ðŸšš hq-cv-*)\n   468â†’gt convoy create \"name\" [issues...]     # Create convoy tracking issues\n   469â†’gt convoy create \"name\" gt-a bd-b --notify mayor/  # With notification\n   470â†’gt convoy list --all                    # Include landed convoys\n   471â†’gt convoy list --status=closed          # Only landed convoys\n   472â†’```\n   473â†’\n   474â†’Note: \"Swarm\" is ephemeral (workers on a convoy's issues). See [Convoys](concepts/convoy.md).\n   475â†’\n   476â†’### Work Assignment\n   477â†’\n   478â†’```bash\n   479â†’# Standard workflow: convoy first, then sling\n   480â†’gt convoy create \"Feature X\" gt-abc gt-def\n   481â†’gt sling gt-abc <rig>                    # Assign to polecat\n   482â†’gt sling gt-abc <rig> --agent codex      # Override runtime for this sling/spawn\n   483â†’gt sling <proto> --on gt-def <rig>       # With workflow template\n   484â†’\n   485â†’# Quick sling (auto-creates convoy)\n   486â†’gt sling <bead> <rig>                    # Auto-convoy for dashboard visibility\n   487â†’```\n   488â†’\n   489â†’Agent overrides:\n   490â†’\n   491â†’- `gt start --agent <alias>` overrides the Mayor/Deacon runtime for this launch.\n   492â†’- `gt mayor start|attach|restart --agent <alias>` and `gt deacon start|attach|restart --agent <alias>` do the same.\n   493â†’- `gt start crew <name> --agent <alias>` and `gt crew at <name> --agent <alias>` override the crew worker runtime.\n   494â†’\n   495â†’### Communication\n   496â†’\n   497â†’```bash\n   498â†’gt mail inbox\n   499â†’gt mail read <id>\n   500â†’gt mail send <addr> -s \"Subject\" -m \"Body\"\n   501â†’gt mail send --human -s \"...\"    # To overseer\n   502â†’```\n   503â†’\n   504â†’### Escalation\n   505â†’\n   506â†’```bash\n   507â†’gt escalate \"topic\"              # Default: MEDIUM severity\n   508â†’gt escalate -s CRITICAL \"msg\"    # Urgent, immediate attention\n   509â†’gt escalate -s HIGH \"msg\"        # Important blocker\n   510â†’gt escalate -s MEDIUM \"msg\" -m \"Details...\"\n   511â†’```\n   512â†’\n   513â†’See [escalation.md](design/escalation.md) for full protocol.\n   514â†’\n   515â†’### Sessions\n   516â†’\n   517â†’```bash\n   518â†’gt handoff                   # Request cycle (context-aware)\n   519â†’gt handoff --shutdown        # Terminate (polecats)\n   520â†’gt session stop <rig>/<agent>\n   521â†’gt peek <agent>              # Check health\n   522â†’gt nudge <agent> \"message\"   # Send message to agent\n   523â†’gt seance                    # List discoverable predecessor sessions\n   524â†’gt seance --talk <id>        # Talk to predecessor (full context)\n   525â†’gt seance --talk <id> -p \"Where is X?\"  # One-shot question\n   526â†’```\n   527â†’\n   528â†’**Session Discovery**: Each session has a startup nudge that becomes searchable\n   529â†’in Claude's `/resume` picker:\n   530â†’\n   531â†’```\n   532â†’[GAS TOWN] recipient <- sender â€¢ timestamp â€¢ topic[:mol-id]\n   533â†’```\n   534â†’\n   535â†’Example: `[GAS TOWN] gastown/crew/gus <- human â€¢ 2025-12-30T15:42 â€¢ restart`\n   536â†’\n   537â†’**IMPORTANT**: Always use `gt nudge` to send messages to Claude sessions.\n   538â†’Never use raw `tmux send-keys` - it doesn't handle Claude's input correctly.\n   539â†’`gt nudge` uses literal mode + debounce + separate Enter for reliable delivery.\n   540â†’\n   541â†’### Emergency\n   542â†’\n   543â†’```bash\n   544â†’gt stop --all                # Kill all sessions\n   545â†’gt stop --rig <name>         # Kill rig sessions\n   546â†’```\n   547â†’\n   548â†’## Beads Commands (bd)\n   549â†’\n   550â†’```bash\n   551â†’bd ready                     # Work with no blockers\n   552â†’bd list --status=open\n   553â†’bd list --status=in_progress\n   554â†’bd show <id>\n   555â†’bd create --title=\"...\" --type=task\n   556â†’bd update <id> --status=in_progress\n   557â†’bd close <id>\n   558â†’bd dep add <child> <parent>  # child depends on parent\n   559â†’bd sync                      # Push/pull changes\n   560â†’```\n   561â†’\n   562â†’## Patrol Agents\n   563â†’\n   564â†’Deacon, Witness, and Refinery run continuous patrol loops using wisps:\n   565â†’\n   566â†’| Agent | Patrol Molecule | Responsibility |\n   567â†’|-------|-----------------|----------------|\n   568â†’| **Deacon** | `mol-deacon-patrol` | Agent lifecycle, plugin execution, health checks |\n   569â†’| **Witness** | `mol-witness-patrol` | Monitor polecats, nudge stuck workers |\n   570â†’| **Refinery** | `mol-refinery-patrol` | Process merge queue, review MRs |\n   571â†’\n   572â†’```\n   573â†’1. bd mol wisp mol-<role>-patrol\n   574â†’2. Execute steps (check workers, process queue, run plugins)\n   575â†’3. bd mol squash (or burn if routine)\n   576â†’4. Loop\n   577â†’```\n   578â†’\n   579â†’## Plugin Molecules\n   580â†’\n   581â†’Plugins are molecules with specific labels:\n   582â†’\n   583â†’```json\n   584â†’{\n   585â†’  \"id\": \"mol-security-scan\",\n   586â†’  \"labels\": [\"template\", \"plugin\", \"witness\", \"tier:haiku\"]\n   587â†’}\n   588â†’```\n   589â†’\n   590â†’Patrol molecules bond plugins dynamically:\n   591â†’\n   592â†’```bash\n   593â†’bd mol bond mol-security-scan $PATROL_ID --var scope=\"$SCOPE\"\n   594â†’```\n   595â†’\n   596â†’## Common Issues\n   597â†’\n   598â†’| Problem | Solution |\n   599â†’|---------|----------|\n   600â†’| Agent in wrong directory | Check cwd, `gt doctor` |\n   601â†’| Beads prefix mismatch | Check `bd show` vs rig config |\n   602â†’| Worktree conflicts | Ensure `BEADS_NO_DAEMON=1` for polecats |\n   603â†’| Stuck worker | `gt nudge`, then `gt peek` |\n   604â†’| Dirty git state | Commit or discard, then `gt handoff` |\n   605â†’\n   606â†’## Architecture Notes\n   607â†’\n   608â†’**Bare repo pattern**: `.repo.git/` is bare (no working dir). Refinery and polecats are worktrees sharing refs. Polecat branches visible to refinery immediately.\n   609â†’\n   610â†’**Beads as control plane**: No separate orchestrator. Molecule steps ARE beads issues. State transitions are git commits.\n   611â†’\n   612â†’**Nondeterministic idempotence**: Any worker can continue any molecule. Steps are atomic checkpoints in beads.\n   613â†’\n   614â†’**Convoy tracking**: Convoys track batched work across rigs. A \"swarm\" is ephemeral - just the workers currently on a convoy's issues. See [Convoys](concepts/convoy.md) for details.\n   615â†’\n\n<system-reminder>\nWhenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.\n</system-reminder>\n"}]},"uuid":"67af0847-df69-4c16-a61c-66beab809030","timestamp":"2026-01-20T16:18:12.601Z","toolUseResult":{"type":"text","file":{"filePath":"/Users/csells/Code/gastownhall/website/docs-fodder/gastown-docs/reference.md","content":"# Gas Town Reference\n\nTechnical reference for Gas Town internals. Read the README first.\n\n## Directory Structure\n\n```\n~/gt/                           Town root\nâ”œâ”€â”€ .beads/                     Town-level beads (hq-* prefix)\nâ”œâ”€â”€ mayor/                      Mayor agent home (town coordinator)\nâ”‚   â”œâ”€â”€ town.json               Town configuration\nâ”‚   â”œâ”€â”€ CLAUDE.md               Mayor context (on disk)\nâ”‚   â””â”€â”€ .claude/settings.json   Mayor Claude settings\nâ”œâ”€â”€ deacon/                     Deacon agent home (background supervisor)\nâ”‚   â””â”€â”€ .claude/settings.json   Deacon settings (context via gt prime)\nâ””â”€â”€ <rig>/                      Project container (NOT a git clone)\n    â”œâ”€â”€ config.json             Rig identity\n    â”œâ”€â”€ .beads/ â†’ mayor/rig/.beads\n    â”œâ”€â”€ .repo.git/              Bare repo (shared by worktrees)\n    â”œâ”€â”€ mayor/rig/              Mayor's clone (canonical beads)\n    â”‚   â””â”€â”€ CLAUDE.md           Per-rig mayor context (on disk)\n    â”œâ”€â”€ witness/                Witness agent home (monitors only)\n    â”‚   â””â”€â”€ .claude/settings.json  (context via gt prime)\n    â”œâ”€â”€ refinery/               Refinery settings parent\n    â”‚   â”œâ”€â”€ .claude/settings.json\n    â”‚   â””â”€â”€ rig/                Worktree on main\n    â”‚       â””â”€â”€ CLAUDE.md       Refinery context (on disk)\n    â”œâ”€â”€ crew/                   Crew settings parent (shared)\n    â”‚   â”œâ”€â”€ .claude/settings.json  (context via gt prime)\n    â”‚   â””â”€â”€ <name>/rig/         Human workspaces\n    â””â”€â”€ polecats/               Polecat settings parent (shared)\n        â”œâ”€â”€ .claude/settings.json  (context via gt prime)\n        â””â”€â”€ <name>/rig/         Worker worktrees\n```\n\n**Key points:**\n\n- Rig root is a container, not a clone\n- `.repo.git/` is bare - refinery and polecats are worktrees\n- Per-rig `mayor/rig/` holds canonical `.beads/`, others inherit via redirect\n- Settings placed in parent dirs (not git clones) for upward traversal\n\n## Beads Routing\n\nGas Town routes beads commands based on issue ID prefix. You don't need to think\nabout which database to use - just use the issue ID.\n\n```bash\nbd show gp-xyz    # Routes to greenplace rig's beads\nbd show hq-abc    # Routes to town-level beads\nbd show wyv-123   # Routes to wyvern rig's beads\n```\n\n**How it works**: Routes are defined in `~/gt/.beads/routes.jsonl`. Each rig's\nprefix maps to its beads location (the mayor's clone in that rig).\n\n| Prefix | Routes To | Purpose |\n|--------|-----------|---------|\n| `hq-*` | `~/gt/.beads/` | Mayor mail, cross-rig coordination |\n| `gp-*` | `~/gt/greenplace/mayor/rig/.beads/` | Greenplace project issues |\n| `wyv-*` | `~/gt/wyvern/mayor/rig/.beads/` | Wyvern project issues |\n\nDebug routing: `BD_DEBUG_ROUTING=1 bd show <id>`\n\n## Configuration\n\n### Rig Config (`config.json`)\n\n```json\n{\n  \"type\": \"rig\",\n  \"name\": \"myproject\",\n  \"git_url\": \"https://github.com/...\",\n  \"beads\": { \"prefix\": \"mp\" }\n}\n```\n\n### Settings (`settings/config.json`)\n\n```json\n{\n  \"theme\": \"desert\",\n  \"max_workers\": 5,\n  \"merge_queue\": { \"enabled\": true }\n}\n```\n\n### Runtime (`.runtime/` - gitignored)\n\nProcess state, PIDs, ephemeral data.\n\n## Formula Format\n\n```toml\nformula = \"name\"\ntype = \"workflow\"           # workflow | expansion | aspect\nversion = 1\ndescription = \"...\"\n\n[vars.feature]\ndescription = \"...\"\nrequired = true\n\n[[steps]]\nid = \"step-id\"\ntitle = \"{{feature}}\"\ndescription = \"...\"\nneeds = [\"other-step\"]      # Dependencies\n```\n\n**Composition:**\n\n```toml\nextends = [\"base-formula\"]\n\n[compose]\naspects = [\"cross-cutting\"]\n\n[[compose.expand]]\ntarget = \"step-id\"\nwith = \"macro-formula\"\n```\n\n## Molecule Lifecycle\n\n```\nFormula (source TOML) â”€â”€â”€ \"Ice-9\"\n    â”‚\n    â–¼ bd cook\nProtomolecule (frozen template) â”€â”€â”€ Solid\n    â”‚\n    â”œâ”€â–¶ bd mol pour â”€â”€â–¶ Mol (persistent) â”€â”€â”€ Liquid â”€â”€â–¶ bd squash â”€â”€â–¶ Digest\n    â”‚\n    â””â”€â–¶ bd mol wisp â”€â”€â–¶ Wisp (ephemeral) â”€â”€â”€ Vapor â”€â”€â”¬â–¶ bd squash â”€â”€â–¶ Digest\n                                                  â””â–¶ bd burn â”€â”€â–¶ (gone)\n```\n\n**Note**: Wisps are stored in `.beads/` with an ephemeral flag - they're not\npersisted to JSONL. They exist only in memory during execution.\n\n## Molecule Commands\n\n**Principle**: `bd` = beads data operations, `gt` = agent operations.\n\n### Beads Operations (bd)\n\n```bash\n# Formulas\nbd formula list              # Available formulas\nbd formula show <name>       # Formula details\nbd cook <formula>            # Formula â†’ Proto\n\n# Molecules (data operations)\nbd mol list                  # Available protos\nbd mol show <id>             # Proto details\nbd mol pour <proto>          # Create mol\nbd mol wisp <proto>          # Create wisp\nbd mol bond <proto> <parent> # Attach to existing mol\nbd mol squash <id>           # Condense to digest (explicit ID)\nbd mol burn <id>             # Discard wisp (explicit ID)\n```\n\n### Agent Operations (gt)\n\n```bash\n# Hook management (operates on current agent's hook)\ngt hook                    # What's on MY hook\ngt mol current               # What should I work on next\ngt mol progress <id>         # Execution progress of molecule\ngt mol attach <bead> <mol>   # Pin molecule to bead\ngt mol detach <bead>         # Unpin molecule from bead\ngt mol attach-from-mail <id> # Attach from mail message\n\n# Agent lifecycle (operates on agent's attached molecule)\ngt mol burn                  # Burn attached molecule (no ID needed)\ngt mol squash                # Squash attached molecule (no ID needed)\ngt mol step done <step>      # Complete a molecule step\n```\n\n**Key distinction**: `bd mol burn/squash <id>` take explicit molecule IDs.\n`gt mol burn/squash` operate on the current agent's attached molecule\n(auto-detected from working directory).\n\n## Agent Lifecycle\n\n### Polecat Shutdown\n\n```\n1. Complete work steps\n2. bd mol squash (create digest)\n3. Submit to merge queue\n4. gt handoff (request shutdown)\n5. Wait for Witness to kill session\n6. Witness removes worktree + branch\n```\n\n### Session Cycling\n\n```\n1. Agent notices context filling\n2. gt handoff (sends mail to self)\n3. Manager kills session\n4. Manager starts new session\n5. New session reads handoff mail\n```\n\n## Environment Variables\n\nGas Town sets environment variables for each agent session via `config.AgentEnv()`.\nThese are set in tmux session environment when agents are spawned.\n\n### Core Variables (All Agents)\n\n| Variable | Purpose | Example |\n|----------|---------|---------|\n| `GT_ROLE` | Agent role type | `mayor`, `witness`, `polecat`, `crew` |\n| `GT_ROOT` | Town root directory | `/home/user/gt` |\n| `BD_ACTOR` | Agent identity for attribution | `gastown/polecats/toast` |\n| `GIT_AUTHOR_NAME` | Commit attribution (same as BD_ACTOR) | `gastown/polecats/toast` |\n| `BEADS_DIR` | Beads database location | `/home/user/gt/gastown/.beads` |\n\n### Rig-Level Variables\n\n| Variable | Purpose | Roles |\n|----------|---------|-------|\n| `GT_RIG` | Rig name | witness, refinery, polecat, crew |\n| `GT_POLECAT` | Polecat worker name | polecat only |\n| `GT_CREW` | Crew worker name | crew only |\n| `BEADS_AGENT_NAME` | Agent name for beads operations | polecat, crew |\n| `BEADS_NO_DAEMON` | Disable beads daemon (isolated context) | polecat, crew |\n\n### Other Variables\n\n| Variable | Purpose |\n|----------|---------|\n| `GIT_AUTHOR_EMAIL` | Workspace owner email (from git config) |\n| `GT_TOWN_ROOT` | Override town root detection (manual use) |\n| `CLAUDE_RUNTIME_CONFIG_DIR` | Custom Claude settings directory |\n\n### Environment by Role\n\n| Role | Key Variables |\n|------|---------------|\n| **Mayor** | `GT_ROLE=mayor`, `BD_ACTOR=mayor` |\n| **Deacon** | `GT_ROLE=deacon`, `BD_ACTOR=deacon` |\n| **Boot** | `GT_ROLE=boot`, `BD_ACTOR=deacon-boot` |\n| **Witness** | `GT_ROLE=witness`, `GT_RIG=<rig>`, `BD_ACTOR=<rig>/witness` |\n| **Refinery** | `GT_ROLE=refinery`, `GT_RIG=<rig>`, `BD_ACTOR=<rig>/refinery` |\n| **Polecat** | `GT_ROLE=polecat`, `GT_RIG=<rig>`, `GT_POLECAT=<name>`, `BD_ACTOR=<rig>/polecats/<name>` |\n| **Crew** | `GT_ROLE=crew`, `GT_RIG=<rig>`, `GT_CREW=<name>`, `BD_ACTOR=<rig>/crew/<name>` |\n\n### Doctor Check\n\nThe `gt doctor` command verifies that running tmux sessions have correct\nenvironment variables. Mismatches are reported as warnings:\n\n```\nâš  env-vars: Found 3 env var mismatch(es) across 1 session(s)\n    hq-mayor: missing GT_ROOT (expected \"/home/user/gt\")\n```\n\nFix by restarting sessions: `gt shutdown && gt up`\n\n## Agent Working Directories and Settings\n\nEach agent runs in a specific working directory and has its own Claude settings.\nUnderstanding this hierarchy is essential for proper configuration.\n\n### Working Directories by Role\n\n| Role | Working Directory | Notes |\n|------|-------------------|-------|\n| **Mayor** | `~/gt/mayor/` | Town-level coordinator, isolated from rigs |\n| **Deacon** | `~/gt/deacon/` | Background supervisor daemon |\n| **Witness** | `~/gt/<rig>/witness/` | No git clone, monitors polecats only |\n| **Refinery** | `~/gt/<rig>/refinery/rig/` | Worktree on main branch |\n| **Crew** | `~/gt/<rig>/crew/<name>/rig/` | Persistent human workspace clone |\n| **Polecat** | `~/gt/<rig>/polecats/<name>/rig/` | Ephemeral worker worktree |\n\nNote: The per-rig `<rig>/mayor/rig/` directory is NOT a working directoryâ€”it's\na git clone that holds the canonical `.beads/` database for that rig.\n\n### Settings File Locations\n\nClaude Code searches for `.claude/settings.json` starting from the working\ndirectory and traversing upward. Settings are placed in **parent directories**\n(not inside git clones) so they're found via directory traversal without\npolluting source repositories:\n\n```\n~/gt/\nâ”œâ”€â”€ mayor/.claude/settings.json          # Mayor settings\nâ”œâ”€â”€ deacon/.claude/settings.json         # Deacon settings\nâ””â”€â”€ <rig>/\n    â”œâ”€â”€ witness/.claude/settings.json    # Witness settings (no rig/ subdir)\n    â”œâ”€â”€ refinery/.claude/settings.json   # Found by refinery/rig/ via traversal\n    â”œâ”€â”€ crew/.claude/settings.json       # Shared by all crew/<name>/rig/\n    â””â”€â”€ polecats/.claude/settings.json   # Shared by all polecats/<name>/rig/\n```\n\n**Why parent directories?** Agents working in git clones (like `refinery/rig/`)\nwould pollute the source repo if settings were placed there. By putting settings\none level up, Claude finds them via upward traversal, and all workers of the\nsame type share the same settings.\n\n### CLAUDE.md Locations\n\nRole context is delivered via CLAUDE.md files or ephemeral injection:\n\n| Role | CLAUDE.md Location | Method |\n|------|-------------------|--------|\n| **Mayor** | `~/gt/mayor/CLAUDE.md` | On disk |\n| **Deacon** | (none) | Injected via `gt prime` at SessionStart |\n| **Witness** | (none) | Injected via `gt prime` at SessionStart |\n| **Refinery** | `<rig>/refinery/rig/CLAUDE.md` | On disk (inside worktree) |\n| **Crew** | (none) | Injected via `gt prime` at SessionStart |\n| **Polecat** | (none) | Injected via `gt prime` at SessionStart |\n\nAdditionally, each rig has `<rig>/mayor/rig/CLAUDE.md` for the per-rig mayor clone\n(used for beads operations, not a running agent).\n\n**Why ephemeral injection?** Writing CLAUDE.md into git clones would:\n1. Pollute source repos when agents commit/push\n2. Leak Gas Town internals into project history\n3. Conflict with project-specific CLAUDE.md files\n\nThe `gt prime` command runs at SessionStart hook and injects context without\npersisting it to disk.\n\n### Sparse Checkout (Source Repo Isolation)\n\nWhen agents work on source repositories that have their own Claude Code configuration,\nGas Town uses git sparse checkout to exclude all context files:\n\n```bash\n# Automatically configured for worktrees - excludes:\n# - .claude/       : settings, rules, agents, commands\n# - CLAUDE.md      : primary context file\n# - CLAUDE.local.md: personal context file\n# - .mcp.json      : MCP server configuration\ngit sparse-checkout set --no-cone '/*' '!/.claude/' '!/CLAUDE.md' '!/CLAUDE.local.md' '!/.mcp.json'\n```\n\nThis ensures agents use Gas Town's context, not the source repo's instructions.\n\n**Doctor check**: `gt doctor` verifies sparse checkout is configured correctly.\nRun `gt doctor --fix` to update legacy configurations missing the newer patterns.\n\n### Settings Inheritance\n\nClaude Code's settings search order (first match wins):\n\n1. `.claude/settings.json` in current working directory\n2. `.claude/settings.json` in parent directories (traversing up)\n3. `~/.claude/settings.json` (user global settings)\n\nGas Town places settings at each agent's working directory root, so agents\nfind their role-specific settings before reaching any parent or global config.\n\n### Settings Templates\n\nGas Town uses two settings templates based on role type:\n\n| Type | Roles | Key Difference |\n|------|-------|----------------|\n| **Interactive** | Mayor, Crew | Mail injected on `UserPromptSubmit` hook |\n| **Autonomous** | Polecat, Witness, Refinery, Deacon | Mail injected on `SessionStart` hook |\n\nAutonomous agents may start without user input, so they need mail checked\nat session start. Interactive agents wait for user prompts.\n\n### Troubleshooting\n\n| Problem | Solution |\n|---------|----------|\n| Agent using wrong settings | Check `gt doctor`, verify sparse checkout |\n| Settings not found | Ensure `.claude/settings.json` exists at role home |\n| Source repo settings leaking | Run `gt doctor --fix` to configure sparse checkout |\n| Mayor settings affecting polecats | Mayor should run in `mayor/`, not town root |\n\n## CLI Reference\n\n### Town Management\n\n```bash\ngt install [path]            # Create town\ngt install --git             # With git init\ngt doctor                    # Health check\ngt doctor --fix              # Auto-repair\n```\n\n### Configuration\n\n```bash\n# Agent management\ngt config agent list [--json]     # List all agents (built-in + custom)\ngt config agent get <name>        # Show agent configuration\ngt config agent set <name> <cmd>  # Create or update custom agent\ngt config agent remove <name>     # Remove custom agent (built-ins protected)\n\n# Default agent\ngt config default-agent [name]    # Get or set town default agent\n```\n\n**Built-in agents**: `claude`, `gemini`, `codex`, `cursor`, `auggie`, `amp`\n\n**Custom agents**: Define per-town via CLI or JSON:\n```bash\ngt config agent set claude-glm \"claude-glm --model glm-4\"\ngt config agent set claude \"claude-opus\"  # Override built-in\ngt config default-agent claude-glm       # Set default\n```\n\n**Advanced agent config** (`settings/agents.json`):\n```json\n{\n  \"version\": 1,\n  \"agents\": {\n    \"opencode\": {\n      \"command\": \"opencode\",\n      \"args\": [],\n      \"resume_flag\": \"--session\",\n      \"resume_style\": \"flag\",\n      \"non_interactive\": {\n        \"subcommand\": \"run\",\n        \"output_flag\": \"--format json\"\n      }\n    }\n  }\n}\n```\n\n**Rig-level agents** (`<rig>/settings/config.json`):\n```json\n{\n  \"type\": \"rig-settings\",\n  \"version\": 1,\n  \"agent\": \"opencode\",\n  \"agents\": {\n    \"opencode\": {\n      \"command\": \"opencode\",\n      \"args\": [\"--session\"]\n    }\n  }\n}\n```\n\n**Agent resolution order**: rig-level â†’ town-level â†’ built-in presets.\n\nFor OpenCode autonomous mode, set env var in your shell profile:\n```bash\nexport OPENCODE_PERMISSION='{\"*\":\"allow\"}'\n```\n\n### Rig Management\n\n```bash\ngt rig add <name> <url>\ngt rig list\ngt rig remove <name>\n```\n\n### Convoy Management (Primary Dashboard)\n\n```bash\ngt convoy list                          # Dashboard of active convoys\ngt convoy status [convoy-id]            # Show progress (ðŸšš hq-cv-*)\ngt convoy create \"name\" [issues...]     # Create convoy tracking issues\ngt convoy create \"name\" gt-a bd-b --notify mayor/  # With notification\ngt convoy list --all                    # Include landed convoys\ngt convoy list --status=closed          # Only landed convoys\n```\n\nNote: \"Swarm\" is ephemeral (workers on a convoy's issues). See [Convoys](concepts/convoy.md).\n\n### Work Assignment\n\n```bash\n# Standard workflow: convoy first, then sling\ngt convoy create \"Feature X\" gt-abc gt-def\ngt sling gt-abc <rig>                    # Assign to polecat\ngt sling gt-abc <rig> --agent codex      # Override runtime for this sling/spawn\ngt sling <proto> --on gt-def <rig>       # With workflow template\n\n# Quick sling (auto-creates convoy)\ngt sling <bead> <rig>                    # Auto-convoy for dashboard visibility\n```\n\nAgent overrides:\n\n- `gt start --agent <alias>` overrides the Mayor/Deacon runtime for this launch.\n- `gt mayor start|attach|restart --agent <alias>` and `gt deacon start|attach|restart --agent <alias>` do the same.\n- `gt start crew <name> --agent <alias>` and `gt crew at <name> --agent <alias>` override the crew worker runtime.\n\n### Communication\n\n```bash\ngt mail inbox\ngt mail read <id>\ngt mail send <addr> -s \"Subject\" -m \"Body\"\ngt mail send --human -s \"...\"    # To overseer\n```\n\n### Escalation\n\n```bash\ngt escalate \"topic\"              # Default: MEDIUM severity\ngt escalate -s CRITICAL \"msg\"    # Urgent, immediate attention\ngt escalate -s HIGH \"msg\"        # Important blocker\ngt escalate -s MEDIUM \"msg\" -m \"Details...\"\n```\n\nSee [escalation.md](design/escalation.md) for full protocol.\n\n### Sessions\n\n```bash\ngt handoff                   # Request cycle (context-aware)\ngt handoff --shutdown        # Terminate (polecats)\ngt session stop <rig>/<agent>\ngt peek <agent>              # Check health\ngt nudge <agent> \"message\"   # Send message to agent\ngt seance                    # List discoverable predecessor sessions\ngt seance --talk <id>        # Talk to predecessor (full context)\ngt seance --talk <id> -p \"Where is X?\"  # One-shot question\n```\n\n**Session Discovery**: Each session has a startup nudge that becomes searchable\nin Claude's `/resume` picker:\n\n```\n[GAS TOWN] recipient <- sender â€¢ timestamp â€¢ topic[:mol-id]\n```\n\nExample: `[GAS TOWN] gastown/crew/gus <- human â€¢ 2025-12-30T15:42 â€¢ restart`\n\n**IMPORTANT**: Always use `gt nudge` to send messages to Claude sessions.\nNever use raw `tmux send-keys` - it doesn't handle Claude's input correctly.\n`gt nudge` uses literal mode + debounce + separate Enter for reliable delivery.\n\n### Emergency\n\n```bash\ngt stop --all                # Kill all sessions\ngt stop --rig <name>         # Kill rig sessions\n```\n\n## Beads Commands (bd)\n\n```bash\nbd ready                     # Work with no blockers\nbd list --status=open\nbd list --status=in_progress\nbd show <id>\nbd create --title=\"...\" --type=task\nbd update <id> --status=in_progress\nbd close <id>\nbd dep add <child> <parent>  # child depends on parent\nbd sync                      # Push/pull changes\n```\n\n## Patrol Agents\n\nDeacon, Witness, and Refinery run continuous patrol loops using wisps:\n\n| Agent | Patrol Molecule | Responsibility |\n|-------|-----------------|----------------|\n| **Deacon** | `mol-deacon-patrol` | Agent lifecycle, plugin execution, health checks |\n| **Witness** | `mol-witness-patrol` | Monitor polecats, nudge stuck workers |\n| **Refinery** | `mol-refinery-patrol` | Process merge queue, review MRs |\n\n```\n1. bd mol wisp mol-<role>-patrol\n2. Execute steps (check workers, process queue, run plugins)\n3. bd mol squash (or burn if routine)\n4. Loop\n```\n\n## Plugin Molecules\n\nPlugins are molecules with specific labels:\n\n```json\n{\n  \"id\": \"mol-security-scan\",\n  \"labels\": [\"template\", \"plugin\", \"witness\", \"tier:haiku\"]\n}\n```\n\nPatrol molecules bond plugins dynamically:\n\n```bash\nbd mol bond mol-security-scan $PATROL_ID --var scope=\"$SCOPE\"\n```\n\n## Common Issues\n\n| Problem | Solution |\n|---------|----------|\n| Agent in wrong directory | Check cwd, `gt doctor` |\n| Beads prefix mismatch | Check `bd show` vs rig config |\n| Worktree conflicts | Ensure `BEADS_NO_DAEMON=1` for polecats |\n| Stuck worker | `gt nudge`, then `gt peek` |\n| Dirty git state | Commit or discard, then `gt handoff` |\n\n## Architecture Notes\n\n**Bare repo pattern**: `.repo.git/` is bare (no working dir). Refinery and polecats are worktrees sharing refs. Polecat branches visible to refinery immediately.\n\n**Beads as control plane**: No separate orchestrator. Molecule steps ARE beads issues. State transitions are git commits.\n\n**Nondeterministic idempotence**: Any worker can continue any molecule. Steps are atomic checkpoints in beads.\n\n**Convoy tracking**: Convoys track batched work across rigs. A \"swarm\" is ephemeral - just the workers currently on a convoy's issues. See [Convoys](concepts/convoy.md) for details.\n","numLines":615,"startLine":1,"totalLines":615}},"sourceToolAssistantUUID":"635ff0ca-e233-4076-a97f-8a7d4f8e7a45"}
{"parentUuid":"b591dd7d-5f2e-4f4a-8b0b-fa8652615759","isSidechain":true,"userType":"external","cwd":"/Users/csells/Code/gastownhall/website","sessionId":"dc9d694e-994e-4b73-9876-59c87b636ae6","version":"2.1.12","gitBranch":"main","agentId":"af83d1f","slug":"snappy-doodling-pudding","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01BPsBVumdvXbp7di2Hzo1sj","type":"tool_result","content":"     1â†’# Molecules\n     2â†’\n     3â†’Molecules are workflow templates that coordinate multi-step work in Gas Town.\n     4â†’\n     5â†’## Molecule Lifecycle\n     6â†’\n     7â†’```\n     8â†’Formula (source TOML) â”€â”€â”€ \"Ice-9\"\n     9â†’    â”‚\n    10â†’    â–¼ bd cook\n    11â†’Protomolecule (frozen template) â”€â”€â”€ Solid\n    12â†’    â”‚\n    13â†’    â”œâ”€â–¶ bd mol pour â”€â”€â–¶ Mol (persistent) â”€â”€â”€ Liquid â”€â”€â–¶ bd squash â”€â”€â–¶ Digest\n    14â†’    â”‚\n    15â†’    â””â”€â–¶ bd mol wisp â”€â”€â–¶ Wisp (ephemeral) â”€â”€â”€ Vapor â”€â”€â”¬â–¶ bd squash â”€â”€â–¶ Digest\n    16â†’                                                     â””â–¶ bd burn â”€â”€â–¶ (gone)\n    17â†’```\n    18â†’\n    19â†’## Core Concepts\n    20â†’\n    21â†’| Term | Description |\n    22â†’|------|-------------|\n    23â†’| **Formula** | Source TOML template defining workflow steps |\n    24â†’| **Protomolecule** | Frozen template ready for instantiation |\n    25â†’| **Molecule** | Active workflow instance with trackable steps |\n    26â†’| **Wisp** | Ephemeral molecule for patrol cycles (never synced) |\n    27â†’| **Digest** | Squashed summary of completed molecule |\n    28â†’\n    29â†’## Common Mistake: Reading Formulas Directly\n    30â†’\n    31â†’**WRONG:**\n    32â†’```bash\n    33â†’# Reading a formula file and manually creating beads for each step\n    34â†’cat .beads/formulas/mol-polecat-work.formula.toml\n    35â†’bd create --title \"Step 1: Load context\" --type task\n    36â†’bd create --title \"Step 2: Branch setup\" --type task\n    37â†’# ... creating beads from formula prose\n    38â†’```\n    39â†’\n    40â†’**RIGHT:**\n    41â†’```bash\n    42â†’# Cook the formula into a proto, pour into a molecule\n    43â†’bd cook mol-polecat-work\n    44â†’bd mol pour mol-polecat-work --var issue=gt-xyz\n    45â†’# Now work through the step beads that were created\n    46â†’bd ready                    # Find next step\n    47â†’bd close <step-id>          # Complete it\n    48â†’```\n    49â†’\n    50â†’**Key insight:** Formulas are source templates (like source code). You never read\n    51â†’them directly during work. The `cook` â†’ `pour` pipeline creates step beads for you.\n    52â†’Your molecule already has steps - use `bd ready` to find them.\n    53â†’\n    54â†’## Navigating Molecules\n    55â†’\n    56â†’Molecules help you track where you are in multi-step workflows.\n    57â†’\n    58â†’### Finding Your Place\n    59â†’\n    60â†’```bash\n    61â†’bd mol current              # Where am I?\n    62â†’bd mol current gt-abc       # Status of specific molecule\n    63â†’```\n    64â†’\n    65â†’Output:\n    66â†’```\n    67â†’You're working on molecule gt-abc (Feature X)\n    68â†’\n    69â†’  âœ“ gt-abc.1: Design\n    70â†’  âœ“ gt-abc.2: Scaffold\n    71â†’  âœ“ gt-abc.3: Implement\n    72â†’  â†’ gt-abc.4: Write tests [in_progress] <- YOU ARE HERE\n    73â†’  â—‹ gt-abc.5: Documentation\n    74â†’  â—‹ gt-abc.6: Exit decision\n    75â†’\n    76â†’Progress: 3/6 steps complete\n    77â†’```\n    78â†’\n    79â†’### Seamless Transitions\n    80â†’\n    81â†’Close a step and advance in one command:\n    82â†’\n    83â†’```bash\n    84â†’bd close gt-abc.3 --continue   # Close and advance to next step\n    85â†’bd close gt-abc.3 --no-auto    # Close but don't auto-claim next\n    86â†’```\n    87â†’\n    88â†’**The old way (3 commands):**\n    89â†’```bash\n    90â†’bd close gt-abc.3\n    91â†’bd ready --parent=gt-abc\n    92â†’bd update gt-abc.4 --status=in_progress\n    93â†’```\n    94â†’\n    95â†’**The new way (1 command):**\n    96â†’```bash\n    97â†’bd close gt-abc.3 --continue\n    98â†’```\n    99â†’\n   100â†’### Transition Output\n   101â†’\n   102â†’```\n   103â†’âœ“ Closed gt-abc.3: Implement feature\n   104â†’\n   105â†’Next ready in molecule:\n   106â†’  gt-abc.4: Write tests\n   107â†’\n   108â†’â†’ Marked in_progress (use --no-auto to skip)\n   109â†’```\n   110â†’\n   111â†’### When Molecule Completes\n   112â†’\n   113â†’```\n   114â†’âœ“ Closed gt-abc.6: Exit decision\n   115â†’\n   116â†’Molecule gt-abc complete! All steps closed.\n   117â†’Consider: bd mol squash gt-abc --summary '...'\n   118â†’```\n   119â†’\n   120â†’## Molecule Commands\n   121â†’\n   122â†’### Beads Operations (bd)\n   123â†’\n   124â†’```bash\n   125â†’# Formulas\n   126â†’bd formula list              # Available formulas\n   127â†’bd formula show <name>       # Formula details\n   128â†’bd cook <formula>            # Formula â†’ Proto\n   129â†’\n   130â†’# Molecules (data operations)\n   131â†’bd mol list                  # Available protos\n   132â†’bd mol show <id>             # Proto details\n   133â†’bd mol pour <proto>          # Create mol\n   134â†’bd mol wisp <proto>          # Create wisp\n   135â†’bd mol bond <proto> <parent> # Attach to existing mol\n   136â†’bd mol squash <id>           # Condense to digest\n   137â†’bd mol burn <id>             # Discard wisp\n   138â†’bd mol current               # Where am I in the current molecule?\n   139â†’```\n   140â†’\n   141â†’### Agent Operations (gt)\n   142â†’\n   143â†’```bash\n   144â†’# Hook management\n   145â†’gt hook                    # What's on MY hook\n   146â†’gt mol current               # What should I work on next\n   147â†’gt mol progress <id>         # Execution progress of molecule\n   148â†’gt mol attach <bead> <mol>   # Pin molecule to bead\n   149â†’gt mol detach <bead>         # Unpin molecule from bead\n   150â†’\n   151â†’# Agent lifecycle\n   152â†’gt mol burn                  # Burn attached molecule\n   153â†’gt mol squash                # Squash attached molecule\n   154â†’gt mol step done <step>      # Complete a molecule step\n   155â†’```\n   156â†’\n   157â†’## Polecat Workflow\n   158â†’\n   159â†’Polecats receive work via their hook - a pinned molecule attached to an issue.\n   160â†’They execute molecule steps sequentially, closing each step as they complete it.\n   161â†’\n   162â†’### Molecule Types for Polecats\n   163â†’\n   164â†’| Type | Storage | Use Case |\n   165â†’|------|---------|----------|\n   166â†’| **Regular Molecule** | `.beads/` (synced) | Discrete deliverables, audit trail |\n   167â†’| **Wisp** | `.beads/` (ephemeral) | Patrol cycles, operational loops |\n   168â†’\n   169â†’Polecats typically use **regular molecules** because each assignment has audit value.\n   170â†’Patrol agents (Witness, Refinery, Deacon) use **wisps** to prevent accumulation.\n   171â†’\n   172â†’### Hook Management\n   173â†’\n   174â†’```bash\n   175â†’gt hook                        # What's on MY hook?\n   176â†’gt mol attach-from-mail <id>   # Attach work from mail message\n   177â†’gt done                        # Signal completion (syncs, submits to MQ, notifies Witness)\n   178â†’```\n   179â†’\n   180â†’### Polecat Workflow Summary\n   181â†’\n   182â†’```\n   183â†’1. Spawn with work on hook\n   184â†’2. gt hook                 # What's hooked?\n   185â†’3. bd mol current          # Where am I?\n   186â†’4. Execute current step\n   187â†’5. bd close <step> --continue\n   188â†’6. If more steps: GOTO 3\n   189â†’7. gt done                 # Signal completion\n   190â†’```\n   191â†’\n   192â†’### Wisp vs Molecule Decision\n   193â†’\n   194â†’| Question | Molecule | Wisp |\n   195â†’|----------|----------|------|\n   196â†’| Does it need audit trail? | Yes | No |\n   197â†’| Will it repeat continuously? | No | Yes |\n   198â†’| Is it discrete deliverable? | Yes | No |\n   199â†’| Is it operational routine? | No | Yes |\n   200â†’\n   201â†’## Best Practices\n   202â†’\n   203â†’1. **CRITICAL: Close steps in real-time** - Mark `in_progress` BEFORE starting, `closed` IMMEDIATELY after completing. Never batch-close steps at the end. Molecules ARE the ledger - each step closure is a timestamped CV entry. Batch-closing corrupts the timeline and violates HOP's core promise.\n   204â†’2. **Use `--continue` for propulsion** - Keep momentum by auto-advancing\n   205â†’3. **Check progress with `bd mol current`** - Know where you are before resuming\n   206â†’4. **Squash completed molecules** - Create digests for audit trail\n   207â†’5. **Burn routine wisps** - Don't accumulate ephemeral patrol data\n   208â†’\n\n<system-reminder>\nWhenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.\n</system-reminder>\n"}]},"uuid":"861de733-7789-42e1-8090-e48982dd0228","timestamp":"2026-01-20T16:18:12.601Z","toolUseResult":{"type":"text","file":{"filePath":"/Users/csells/Code/gastownhall/website/docs-fodder/gastown-docs/concepts/molecules.md","content":"# Molecules\n\nMolecules are workflow templates that coordinate multi-step work in Gas Town.\n\n## Molecule Lifecycle\n\n```\nFormula (source TOML) â”€â”€â”€ \"Ice-9\"\n    â”‚\n    â–¼ bd cook\nProtomolecule (frozen template) â”€â”€â”€ Solid\n    â”‚\n    â”œâ”€â–¶ bd mol pour â”€â”€â–¶ Mol (persistent) â”€â”€â”€ Liquid â”€â”€â–¶ bd squash â”€â”€â–¶ Digest\n    â”‚\n    â””â”€â–¶ bd mol wisp â”€â”€â–¶ Wisp (ephemeral) â”€â”€â”€ Vapor â”€â”€â”¬â–¶ bd squash â”€â”€â–¶ Digest\n                                                     â””â–¶ bd burn â”€â”€â–¶ (gone)\n```\n\n## Core Concepts\n\n| Term | Description |\n|------|-------------|\n| **Formula** | Source TOML template defining workflow steps |\n| **Protomolecule** | Frozen template ready for instantiation |\n| **Molecule** | Active workflow instance with trackable steps |\n| **Wisp** | Ephemeral molecule for patrol cycles (never synced) |\n| **Digest** | Squashed summary of completed molecule |\n\n## Common Mistake: Reading Formulas Directly\n\n**WRONG:**\n```bash\n# Reading a formula file and manually creating beads for each step\ncat .beads/formulas/mol-polecat-work.formula.toml\nbd create --title \"Step 1: Load context\" --type task\nbd create --title \"Step 2: Branch setup\" --type task\n# ... creating beads from formula prose\n```\n\n**RIGHT:**\n```bash\n# Cook the formula into a proto, pour into a molecule\nbd cook mol-polecat-work\nbd mol pour mol-polecat-work --var issue=gt-xyz\n# Now work through the step beads that were created\nbd ready                    # Find next step\nbd close <step-id>          # Complete it\n```\n\n**Key insight:** Formulas are source templates (like source code). You never read\nthem directly during work. The `cook` â†’ `pour` pipeline creates step beads for you.\nYour molecule already has steps - use `bd ready` to find them.\n\n## Navigating Molecules\n\nMolecules help you track where you are in multi-step workflows.\n\n### Finding Your Place\n\n```bash\nbd mol current              # Where am I?\nbd mol current gt-abc       # Status of specific molecule\n```\n\nOutput:\n```\nYou're working on molecule gt-abc (Feature X)\n\n  âœ“ gt-abc.1: Design\n  âœ“ gt-abc.2: Scaffold\n  âœ“ gt-abc.3: Implement\n  â†’ gt-abc.4: Write tests [in_progress] <- YOU ARE HERE\n  â—‹ gt-abc.5: Documentation\n  â—‹ gt-abc.6: Exit decision\n\nProgress: 3/6 steps complete\n```\n\n### Seamless Transitions\n\nClose a step and advance in one command:\n\n```bash\nbd close gt-abc.3 --continue   # Close and advance to next step\nbd close gt-abc.3 --no-auto    # Close but don't auto-claim next\n```\n\n**The old way (3 commands):**\n```bash\nbd close gt-abc.3\nbd ready --parent=gt-abc\nbd update gt-abc.4 --status=in_progress\n```\n\n**The new way (1 command):**\n```bash\nbd close gt-abc.3 --continue\n```\n\n### Transition Output\n\n```\nâœ“ Closed gt-abc.3: Implement feature\n\nNext ready in molecule:\n  gt-abc.4: Write tests\n\nâ†’ Marked in_progress (use --no-auto to skip)\n```\n\n### When Molecule Completes\n\n```\nâœ“ Closed gt-abc.6: Exit decision\n\nMolecule gt-abc complete! All steps closed.\nConsider: bd mol squash gt-abc --summary '...'\n```\n\n## Molecule Commands\n\n### Beads Operations (bd)\n\n```bash\n# Formulas\nbd formula list              # Available formulas\nbd formula show <name>       # Formula details\nbd cook <formula>            # Formula â†’ Proto\n\n# Molecules (data operations)\nbd mol list                  # Available protos\nbd mol show <id>             # Proto details\nbd mol pour <proto>          # Create mol\nbd mol wisp <proto>          # Create wisp\nbd mol bond <proto> <parent> # Attach to existing mol\nbd mol squash <id>           # Condense to digest\nbd mol burn <id>             # Discard wisp\nbd mol current               # Where am I in the current molecule?\n```\n\n### Agent Operations (gt)\n\n```bash\n# Hook management\ngt hook                    # What's on MY hook\ngt mol current               # What should I work on next\ngt mol progress <id>         # Execution progress of molecule\ngt mol attach <bead> <mol>   # Pin molecule to bead\ngt mol detach <bead>         # Unpin molecule from bead\n\n# Agent lifecycle\ngt mol burn                  # Burn attached molecule\ngt mol squash                # Squash attached molecule\ngt mol step done <step>      # Complete a molecule step\n```\n\n## Polecat Workflow\n\nPolecats receive work via their hook - a pinned molecule attached to an issue.\nThey execute molecule steps sequentially, closing each step as they complete it.\n\n### Molecule Types for Polecats\n\n| Type | Storage | Use Case |\n|------|---------|----------|\n| **Regular Molecule** | `.beads/` (synced) | Discrete deliverables, audit trail |\n| **Wisp** | `.beads/` (ephemeral) | Patrol cycles, operational loops |\n\nPolecats typically use **regular molecules** because each assignment has audit value.\nPatrol agents (Witness, Refinery, Deacon) use **wisps** to prevent accumulation.\n\n### Hook Management\n\n```bash\ngt hook                        # What's on MY hook?\ngt mol attach-from-mail <id>   # Attach work from mail message\ngt done                        # Signal completion (syncs, submits to MQ, notifies Witness)\n```\n\n### Polecat Workflow Summary\n\n```\n1. Spawn with work on hook\n2. gt hook                 # What's hooked?\n3. bd mol current          # Where am I?\n4. Execute current step\n5. bd close <step> --continue\n6. If more steps: GOTO 3\n7. gt done                 # Signal completion\n```\n\n### Wisp vs Molecule Decision\n\n| Question | Molecule | Wisp |\n|----------|----------|------|\n| Does it need audit trail? | Yes | No |\n| Will it repeat continuously? | No | Yes |\n| Is it discrete deliverable? | Yes | No |\n| Is it operational routine? | No | Yes |\n\n## Best Practices\n\n1. **CRITICAL: Close steps in real-time** - Mark `in_progress` BEFORE starting, `closed` IMMEDIATELY after completing. Never batch-close steps at the end. Molecules ARE the ledger - each step closure is a timestamped CV entry. Batch-closing corrupts the timeline and violates HOP's core promise.\n2. **Use `--continue` for propulsion** - Keep momentum by auto-advancing\n3. **Check progress with `bd mol current`** - Know where you are before resuming\n4. **Squash completed molecules** - Create digests for audit trail\n5. **Burn routine wisps** - Don't accumulate ephemeral patrol data\n","numLines":208,"startLine":1,"totalLines":208}},"sourceToolAssistantUUID":"b591dd7d-5f2e-4f4a-8b0b-fa8652615759"}
{"parentUuid":"ea4129ef-711f-45a6-bab8-05ab21398bfb","isSidechain":true,"userType":"external","cwd":"/Users/csells/Code/gastownhall/website","sessionId":"dc9d694e-994e-4b73-9876-59c87b636ae6","version":"2.1.12","gitBranch":"main","agentId":"af83d1f","slug":"snappy-doodling-pudding","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_019qdYus7cHhjXnULQ1yHEHs","type":"tool_result","content":"     1â†’# Gas Town Glossary\n     2â†’\n     3â†’Gas Town is an agentic development environment for managing multiple Claude Code instances simultaneously using the `gt` and `bd` (Beads) binaries, coordinated with tmux in git-managed directories.\n     4â†’\n     5â†’## Core Principles\n     6â†’\n     7â†’### MEOW (Molecular Expression of Work)\n     8â†’Breaking large goals into detailed instructions for agents. Supported by Beads, Epics, Formulas, and Molecules. MEOW ensures work is decomposed into trackable, atomic units that agents can execute autonomously.\n     9â†’\n    10â†’### GUPP (Gas Town Universal Propulsion Principle)\n    11â†’\"If there is work on your Hook, YOU MUST RUN IT.\" This principle ensures agents autonomously proceed with available work without waiting for external input. GUPP is the heartbeat of autonomous operation.\n    12â†’\n    13â†’### NDI (Nondeterministic Idempotence)\n    14â†’The overarching goal ensuring useful outcomes through orchestration of potentially unreliable processes. Persistent Beads and oversight agents (Witness, Deacon) guarantee eventual workflow completion even when individual operations may fail or produce varying results.\n    15â†’\n    16â†’## Environments\n    17â†’\n    18â†’### Town\n    19â†’The management headquarters (e.g., `~/gt/`). The Town coordinates all workers across multiple Rigs and houses town-level agents like Mayor and Deacon.\n    20â†’\n    21â†’### Rig\n    22â†’A project-specific Git repository under Gas Town management. Each Rig has its own Polecats, Refinery, Witness, and Crew members. Rigs are where actual development work happens.\n    23â†’\n    24â†’## Town-Level Roles\n    25â†’\n    26â†’### Mayor\n    27â†’Chief-of-staff agent responsible for initiating Convoys, coordinating work distribution, and notifying users of important events. The Mayor operates from the town level and has visibility across all Rigs.\n    28â†’\n    29â†’### Deacon\n    30â†’Daemon beacon running continuous Patrol cycles. The Deacon ensures worker activity, monitors system health, and triggers recovery when agents become unresponsive. Think of the Deacon as the system's watchdog.\n    31â†’\n    32â†’### Dogs\n    33â†’The Deacon's crew of maintenance agents handling background tasks like cleanup, health checks, and system maintenance.\n    34â†’\n    35â†’### Boot (the Dog)\n    36â†’A special Dog that checks the Deacon every 5 minutes, ensuring the watchdog itself is still watching. This creates a chain of accountability.\n    37â†’\n    38â†’## Rig-Level Roles\n    39â†’\n    40â†’### Polecat\n    41â†’Ephemeral worker agents that produce Merge Requests. Polecats are spawned for specific tasks, complete their work, and are then cleaned up. They work in isolated git worktrees to avoid conflicts.\n    42â†’\n    43â†’### Refinery\n    44â†’Manages the Merge Queue for a Rig. The Refinery intelligently merges changes from Polecats, handling conflicts and ensuring code quality before changes reach the main branch.\n    45â†’\n    46â†’### Witness\n    47â†’Patrol agent that oversees Polecats and the Refinery within a Rig. The Witness monitors progress, detects stuck agents, and can trigger recovery actions.\n    48â†’\n    49â†’### Crew\n    50â†’Long-lived, named agents for persistent collaboration. Unlike ephemeral Polecats, Crew members maintain context across sessions and are ideal for ongoing work relationships.\n    51â†’\n    52â†’## Work Units\n    53â†’\n    54â†’### Bead\n    55â†’Git-backed atomic work unit stored in JSONL format. Beads are the fundamental unit of work tracking in Gas Town. They can represent issues, tasks, epics, or any trackable work item.\n    56â†’\n    57â†’### Formula\n    58â†’TOML-based workflow source template. Formulas define reusable patterns for common operations like patrol cycles, code review, or deployment.\n    59â†’\n    60â†’### Protomolecule\n    61â†’A template class for instantiating Molecules. Protomolecules define the structure and steps of a workflow without being tied to specific work items.\n    62â†’\n    63â†’### Molecule\n    64â†’Durable chained Bead workflows. Molecules represent multi-step processes where each step is tracked as a Bead. They survive agent restarts and ensure complex workflows complete.\n    65â†’\n    66â†’### Wisp\n    67â†’Ephemeral Beads destroyed after runs. Wisps are lightweight work items used for transient operations that don't need permanent tracking.\n    68â†’\n    69â†’### Hook\n    70â†’A special pinned Bead for each agent. The Hook is an agent's primary work queue - when work appears on your Hook, GUPP dictates you must run it.\n    71â†’\n    72â†’## Workflow Commands\n    73â†’\n    74â†’### Convoy\n    75â†’Primary work-order wrapping related Beads. Convoys group related tasks together and can be assigned to multiple workers. Created with `gt convoy create`.\n    76â†’\n    77â†’### Slinging\n    78â†’Assigning work to agents via `gt sling`. When you sling work to a Polecat or Crew member, you're putting it on their Hook for execution.\n    79â†’\n    80â†’### Nudging\n    81â†’Real-time messaging between agents with `gt nudge`. Nudges allow immediate communication without going through the mail system.\n    82â†’\n    83â†’### Handoff\n    84â†’Agent session refresh via `/handoff`. When context gets full or an agent needs a fresh start, handoff transfers work state to a new session.\n    85â†’\n    86â†’### Seance\n    87â†’Communicating with previous sessions via `gt seance`. Allows agents to query their predecessors for context and decisions from earlier work.\n    88â†’\n    89â†’### Patrol\n    90â†’Ephemeral loop maintaining system heartbeat. Patrol agents (Deacon, Witness) continuously cycle through health checks and trigger actions as needed.\n    91â†’\n    92â†’---\n    93â†’\n    94â†’*This glossary was contributed by [Clay Shirky](https://github.com/cshirky) in [Issue #80](https://github.com/steveyegge/gastown/issues/80).*\n    95â†’\n\n<system-reminder>\nWhenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.\n</system-reminder>\n"}]},"uuid":"2c72daba-0878-4387-9727-dbe7bd6ddc53","timestamp":"2026-01-20T16:18:12.601Z","toolUseResult":{"type":"text","file":{"filePath":"/Users/csells/Code/gastownhall/website/docs-fodder/gastown-docs/glossary.md","content":"# Gas Town Glossary\n\nGas Town is an agentic development environment for managing multiple Claude Code instances simultaneously using the `gt` and `bd` (Beads) binaries, coordinated with tmux in git-managed directories.\n\n## Core Principles\n\n### MEOW (Molecular Expression of Work)\nBreaking large goals into detailed instructions for agents. Supported by Beads, Epics, Formulas, and Molecules. MEOW ensures work is decomposed into trackable, atomic units that agents can execute autonomously.\n\n### GUPP (Gas Town Universal Propulsion Principle)\n\"If there is work on your Hook, YOU MUST RUN IT.\" This principle ensures agents autonomously proceed with available work without waiting for external input. GUPP is the heartbeat of autonomous operation.\n\n### NDI (Nondeterministic Idempotence)\nThe overarching goal ensuring useful outcomes through orchestration of potentially unreliable processes. Persistent Beads and oversight agents (Witness, Deacon) guarantee eventual workflow completion even when individual operations may fail or produce varying results.\n\n## Environments\n\n### Town\nThe management headquarters (e.g., `~/gt/`). The Town coordinates all workers across multiple Rigs and houses town-level agents like Mayor and Deacon.\n\n### Rig\nA project-specific Git repository under Gas Town management. Each Rig has its own Polecats, Refinery, Witness, and Crew members. Rigs are where actual development work happens.\n\n## Town-Level Roles\n\n### Mayor\nChief-of-staff agent responsible for initiating Convoys, coordinating work distribution, and notifying users of important events. The Mayor operates from the town level and has visibility across all Rigs.\n\n### Deacon\nDaemon beacon running continuous Patrol cycles. The Deacon ensures worker activity, monitors system health, and triggers recovery when agents become unresponsive. Think of the Deacon as the system's watchdog.\n\n### Dogs\nThe Deacon's crew of maintenance agents handling background tasks like cleanup, health checks, and system maintenance.\n\n### Boot (the Dog)\nA special Dog that checks the Deacon every 5 minutes, ensuring the watchdog itself is still watching. This creates a chain of accountability.\n\n## Rig-Level Roles\n\n### Polecat\nEphemeral worker agents that produce Merge Requests. Polecats are spawned for specific tasks, complete their work, and are then cleaned up. They work in isolated git worktrees to avoid conflicts.\n\n### Refinery\nManages the Merge Queue for a Rig. The Refinery intelligently merges changes from Polecats, handling conflicts and ensuring code quality before changes reach the main branch.\n\n### Witness\nPatrol agent that oversees Polecats and the Refinery within a Rig. The Witness monitors progress, detects stuck agents, and can trigger recovery actions.\n\n### Crew\nLong-lived, named agents for persistent collaboration. Unlike ephemeral Polecats, Crew members maintain context across sessions and are ideal for ongoing work relationships.\n\n## Work Units\n\n### Bead\nGit-backed atomic work unit stored in JSONL format. Beads are the fundamental unit of work tracking in Gas Town. They can represent issues, tasks, epics, or any trackable work item.\n\n### Formula\nTOML-based workflow source template. Formulas define reusable patterns for common operations like patrol cycles, code review, or deployment.\n\n### Protomolecule\nA template class for instantiating Molecules. Protomolecules define the structure and steps of a workflow without being tied to specific work items.\n\n### Molecule\nDurable chained Bead workflows. Molecules represent multi-step processes where each step is tracked as a Bead. They survive agent restarts and ensure complex workflows complete.\n\n### Wisp\nEphemeral Beads destroyed after runs. Wisps are lightweight work items used for transient operations that don't need permanent tracking.\n\n### Hook\nA special pinned Bead for each agent. The Hook is an agent's primary work queue - when work appears on your Hook, GUPP dictates you must run it.\n\n## Workflow Commands\n\n### Convoy\nPrimary work-order wrapping related Beads. Convoys group related tasks together and can be assigned to multiple workers. Created with `gt convoy create`.\n\n### Slinging\nAssigning work to agents via `gt sling`. When you sling work to a Polecat or Crew member, you're putting it on their Hook for execution.\n\n### Nudging\nReal-time messaging between agents with `gt nudge`. Nudges allow immediate communication without going through the mail system.\n\n### Handoff\nAgent session refresh via `/handoff`. When context gets full or an agent needs a fresh start, handoff transfers work state to a new session.\n\n### Seance\nCommunicating with previous sessions via `gt seance`. Allows agents to query their predecessors for context and decisions from earlier work.\n\n### Patrol\nEphemeral loop maintaining system heartbeat. Patrol agents (Deacon, Witness) continuously cycle through health checks and trigger actions as needed.\n\n---\n\n*This glossary was contributed by [Clay Shirky](https://github.com/cshirky) in [Issue #80](https://github.com/steveyegge/gastown/issues/80).*\n","numLines":95,"startLine":1,"totalLines":95}},"sourceToolAssistantUUID":"ea4129ef-711f-45a6-bab8-05ab21398bfb"}
{"parentUuid":"2c72daba-0878-4387-9727-dbe7bd6ddc53","isSidechain":true,"userType":"external","cwd":"/Users/csells/Code/gastownhall/website","sessionId":"dc9d694e-994e-4b73-9876-59c87b636ae6","version":"2.1.12","gitBranch":"main","agentId":"af83d1f","slug":"snappy-doodling-pudding","message":{"model":"claude-opus-4-5-20251101","id":"msg_01UVi7CUAZiP3Nhijz35K1jC","type":"message","role":"assistant","content":[{"type":"text","text":"Let me read more about formulas, convoys, and the polecat lifecycle to understand the full workflow."}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":0,"cache_creation_input_tokens":16259,"cache_read_input_tokens":19619,"cache_creation":{"ephemeral_5m_input_tokens":16259,"ephemeral_1h_input_tokens":0},"output_tokens":1,"service_tier":"standard"}},"requestId":"req_011CXJw27b82SikRPnRugge8","type":"assistant","uuid":"9284f4c9-6778-4aa8-9449-ac7c9479958b","timestamp":"2026-01-20T16:18:17.031Z"}
{"parentUuid":"9284f4c9-6778-4aa8-9449-ac7c9479958b","isSidechain":true,"userType":"external","cwd":"/Users/csells/Code/gastownhall/website","sessionId":"dc9d694e-994e-4b73-9876-59c87b636ae6","version":"2.1.12","gitBranch":"main","agentId":"af83d1f","slug":"snappy-doodling-pudding","message":{"model":"claude-opus-4-5-20251101","id":"msg_01UVi7CUAZiP3Nhijz35K1jC","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01LDbsrqkbHFL7sQpyyvaWtr","name":"Read","input":{"file_path":"/Users/csells/Code/gastownhall/website/docs-fodder/gastown-docs/formula-resolution.md"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":0,"cache_creation_input_tokens":16259,"cache_read_input_tokens":19619,"cache_creation":{"ephemeral_5m_input_tokens":16259,"ephemeral_1h_input_tokens":0},"output_tokens":1,"service_tier":"standard"}},"requestId":"req_011CXJw27b82SikRPnRugge8","type":"assistant","uuid":"32ada12d-046c-4941-8d62-ac51ae5d4854","timestamp":"2026-01-20T16:18:18.072Z"}
{"parentUuid":"32ada12d-046c-4941-8d62-ac51ae5d4854","isSidechain":true,"userType":"external","cwd":"/Users/csells/Code/gastownhall/website","sessionId":"dc9d694e-994e-4b73-9876-59c87b636ae6","version":"2.1.12","gitBranch":"main","agentId":"af83d1f","slug":"snappy-doodling-pudding","message":{"model":"claude-opus-4-5-20251101","id":"msg_01UVi7CUAZiP3Nhijz35K1jC","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01D8n2HEL4XiVykK6Yq5jefv","name":"Read","input":{"file_path":"/Users/csells/Code/gastownhall/website/docs-fodder/gastown-docs/concepts/convoy.md"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":0,"cache_creation_input_tokens":16259,"cache_read_input_tokens":19619,"cache_creation":{"ephemeral_5m_input_tokens":16259,"ephemeral_1h_input_tokens":0},"output_tokens":1,"service_tier":"standard"}},"requestId":"req_011CXJw27b82SikRPnRugge8","type":"assistant","uuid":"08bb03c5-909e-465e-8a4e-f24f052826c1","timestamp":"2026-01-20T16:18:19.043Z"}
{"parentUuid":"08bb03c5-909e-465e-8a4e-f24f052826c1","isSidechain":true,"userType":"external","cwd":"/Users/csells/Code/gastownhall/website","sessionId":"dc9d694e-994e-4b73-9876-59c87b636ae6","version":"2.1.12","gitBranch":"main","agentId":"af83d1f","slug":"snappy-doodling-pudding","message":{"model":"claude-opus-4-5-20251101","id":"msg_01UVi7CUAZiP3Nhijz35K1jC","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01DScJ84RcatijEJSiiQ2WcW","name":"Read","input":{"file_path":"/Users/csells/Code/gastownhall/website/docs-fodder/gastown-docs/concepts/polecat-lifecycle.md"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":0,"cache_creation_input_tokens":16259,"cache_read_input_tokens":19619,"cache_creation":{"ephemeral_5m_input_tokens":16259,"ephemeral_1h_input_tokens":0},"output_tokens":1,"service_tier":"standard"}},"requestId":"req_011CXJw27b82SikRPnRugge8","type":"assistant","uuid":"4e98585c-acc6-43f8-b85b-6b5e4fe9a943","timestamp":"2026-01-20T16:18:19.190Z"}
{"parentUuid":"4e98585c-acc6-43f8-b85b-6b5e4fe9a943","isSidechain":true,"userType":"external","cwd":"/Users/csells/Code/gastownhall/website","sessionId":"dc9d694e-994e-4b73-9876-59c87b636ae6","version":"2.1.12","gitBranch":"main","agentId":"af83d1f","slug":"snappy-doodling-pudding","message":{"model":"claude-opus-4-5-20251101","id":"msg_01UVi7CUAZiP3Nhijz35K1jC","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_012msB5iBKn1piaN4tfQXEsE","name":"Read","input":{"file_path":"/Users/csells/Code/gastownhall/website/docs-fodder/gastown-docs/INSTALLING.md"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":0,"cache_creation_input_tokens":16259,"cache_read_input_tokens":19619,"cache_creation":{"ephemeral_5m_input_tokens":16259,"ephemeral_1h_input_tokens":0},"output_tokens":1,"service_tier":"standard"}},"requestId":"req_011CXJw27b82SikRPnRugge8","type":"assistant","uuid":"a6e50aa1-e232-4e23-805c-272ad2168d31","timestamp":"2026-01-20T16:18:19.669Z"}
{"parentUuid":"32ada12d-046c-4941-8d62-ac51ae5d4854","isSidechain":true,"userType":"external","cwd":"/Users/csells/Code/gastownhall/website","sessionId":"dc9d694e-994e-4b73-9876-59c87b636ae6","version":"2.1.12","gitBranch":"main","agentId":"af83d1f","slug":"snappy-doodling-pudding","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01LDbsrqkbHFL7sQpyyvaWtr","type":"tool_result","content":"     1â†’# Formula Resolution Architecture\n     2â†’\n     3â†’> Where formulas live, how they're found, and how they'll scale to Mol Mall\n     4â†’\n     5â†’## The Problem\n     6â†’\n     7â†’Formulas currently exist in multiple locations with no clear precedence:\n     8â†’- `.beads/formulas/` (source of truth for a project)\n     9â†’- `internal/formula/formulas/` (embedded copy for `go install`)\n    10â†’- Crew directories have their own `.beads/formulas/` (diverging copies)\n    11â†’\n    12â†’When an agent runs `bd cook mol-polecat-work`, which version do they get?\n    13â†’\n    14â†’## Design Goals\n    15â†’\n    16â†’1. **Predictable resolution** - Clear precedence rules\n    17â†’2. **Local customization** - Override system defaults without forking\n    18â†’3. **Project-specific formulas** - Committed workflows for collaborators\n    19â†’4. **Mol Mall ready** - Architecture supports remote formula installation\n    20â†’5. **Federation ready** - Formulas are shareable across towns via HOP (Highway Operations Protocol)\n    21â†’\n    22â†’## Three-Tier Resolution\n    23â†’\n    24â†’```\n    25â†’â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n    26â†’â”‚                     FORMULA RESOLUTION ORDER                     â”‚\n    27â†’â”‚                    (most specific wins)                          â”‚\n    28â†’â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n    29â†’\n    30â†’TIER 1: PROJECT (rig-level)\n    31â†’  Location: <project>/.beads/formulas/\n    32â†’  Source:   Committed to project repo\n    33â†’  Use case: Project-specific workflows (deploy, test, release)\n    34â†’  Example:  ~/gt/gastown/.beads/formulas/mol-gastown-release.formula.toml\n    35â†’\n    36â†’TIER 2: TOWN (user-level)\n    37â†’  Location: ~/gt/.beads/formulas/\n    38â†’  Source:   Mol Mall installs, user customizations\n    39â†’  Use case: Cross-project workflows, personal preferences\n    40â†’  Example:  ~/gt/.beads/formulas/mol-polecat-work.formula.toml (customized)\n    41â†’\n    42â†’TIER 3: SYSTEM (embedded)\n    43â†’  Location: Compiled into gt binary\n    44â†’  Source:   gastown/mayor/rig/.beads/formulas/ at build time\n    45â†’  Use case: Defaults, blessed patterns, fallback\n    46â†’  Example:  mol-polecat-work.formula.toml (factory default)\n    47â†’```\n    48â†’\n    49â†’### Resolution Algorithm\n    50â†’\n    51â†’```go\n    52â†’func ResolveFormula(name string, cwd string) (Formula, Tier, error) {\n    53â†’    // Tier 1: Project-level (walk up from cwd to find .beads/formulas/)\n    54â†’    if projectDir := findProjectRoot(cwd); projectDir != \"\" {\n    55â†’        path := filepath.Join(projectDir, \".beads\", \"formulas\", name+\".formula.toml\")\n    56â†’        if f, err := loadFormula(path); err == nil {\n    57â†’            return f, TierProject, nil\n    58â†’        }\n    59â†’    }\n    60â†’\n    61â†’    // Tier 2: Town-level\n    62â†’    townDir := getTownRoot() // ~/gt or $GT_HOME\n    63â†’    path := filepath.Join(townDir, \".beads\", \"formulas\", name+\".formula.toml\")\n    64â†’    if f, err := loadFormula(path); err == nil {\n    65â†’        return f, TierTown, nil\n    66â†’    }\n    67â†’\n    68â†’    // Tier 3: Embedded (system)\n    69â†’    if f, err := loadEmbeddedFormula(name); err == nil {\n    70â†’        return f, TierSystem, nil\n    71â†’    }\n    72â†’\n    73â†’    return nil, 0, ErrFormulaNotFound\n    74â†’}\n    75â†’```\n    76â†’\n    77â†’### Why This Order\n    78â†’\n    79â†’**Project wins** because:\n    80â†’- Project maintainers know their workflows best\n    81â†’- Collaborators get consistent behavior via git\n    82â†’- CI/CD uses the same formulas as developers\n    83â†’\n    84â†’**Town is middle** because:\n    85â†’- User customizations override system defaults\n    86â†’- Mol Mall installs don't require project changes\n    87â†’- Cross-project consistency for the user\n    88â†’\n    89â†’**System is fallback** because:\n    90â†’- Always available (compiled in)\n    91â†’- Factory reset target\n    92â†’- The \"blessed\" versions\n    93â†’\n    94â†’## Formula Identity\n    95â†’\n    96â†’### Current Format\n    97â†’\n    98â†’```toml\n    99â†’formula = \"mol-polecat-work\"\n   100â†’version = 4\n   101â†’description = \"...\"\n   102â†’```\n   103â†’\n   104â†’### Extended Format (Mol Mall Ready)\n   105â†’\n   106â†’```toml\n   107â†’[formula]\n   108â†’name = \"mol-polecat-work\"\n   109â†’version = \"4.0.0\"                          # Semver\n   110â†’author = \"steve@gastown.io\"                # Author identity\n   111â†’license = \"MIT\"\n   112â†’repository = \"https://github.com/steveyegge/gastown\"\n   113â†’\n   114â†’[formula.registry]\n   115â†’uri = \"hop://molmall.gastown.io/formulas/mol-polecat-work@4.0.0\"\n   116â†’checksum = \"sha256:abc123...\"              # Integrity verification\n   117â†’signed_by = \"steve@gastown.io\"             # Optional signing\n   118â†’\n   119â†’[formula.capabilities]\n   120â†’# What capabilities does this formula exercise? Used for agent routing.\n   121â†’primary = [\"go\", \"testing\", \"code-review\"]\n   122â†’secondary = [\"git\", \"ci-cd\"]\n   123â†’```\n   124â†’\n   125â†’### Version Resolution\n   126â†’\n   127â†’When multiple versions exist:\n   128â†’\n   129â†’```bash\n   130â†’bd cook mol-polecat-work          # Resolves per tier order\n   131â†’bd cook mol-polecat-work@4        # Specific major version\n   132â†’bd cook mol-polecat-work@4.0.0    # Exact version\n   133â†’bd cook mol-polecat-work@latest   # Explicit latest\n   134â†’```\n   135â†’\n   136â†’## Crew Directory Problem\n   137â†’\n   138â†’### Current State\n   139â†’\n   140â†’Crew directories (`gastown/crew/max/`) are sparse checkouts of gastown. They have:\n   141â†’- Their own `.beads/formulas/` (from the checkout)\n   142â†’- These can diverge from `mayor/rig/.beads/formulas/`\n   143â†’\n   144â†’### The Fix\n   145â†’\n   146â†’Crew should NOT have their own formula copies. Options:\n   147â†’\n   148â†’**Option A: Symlink/Redirect**\n   149â†’```bash\n   150â†’# crew/max/.beads/formulas -> ../../mayor/rig/.beads/formulas\n   151â†’```\n   152â†’All crew share the rig's formulas.\n   153â†’\n   154â†’**Option B: Provision on Demand**\n   155â†’Crew directories don't have `.beads/formulas/`. Resolution falls through to:\n   156â†’1. Town-level (~/gt/.beads/formulas/)\n   157â†’2. System (embedded)\n   158â†’\n   159â†’**Option C: Sparse Checkout Exclusion**\n   160â†’Exclude `.beads/formulas/` from crew sparse checkouts entirely.\n   161â†’\n   162â†’**Recommendation: Option B** - Crew shouldn't need project-level formulas. They work on the project, they don't define its workflows.\n   163â†’\n   164â†’## Commands\n   165â†’\n   166â†’### Existing\n   167â†’\n   168â†’```bash\n   169â†’bd formula list              # Available formulas (should show tier)\n   170â†’bd formula show <name>       # Formula details\n   171â†’bd cook <formula>            # Formula â†’ Proto\n   172â†’```\n   173â†’\n   174â†’### Enhanced\n   175â†’\n   176â†’```bash\n   177â†’# List with tier information\n   178â†’bd formula list\n   179â†’  mol-polecat-work          v4    [project]\n   180â†’  mol-polecat-code-review   v1    [town]\n   181â†’  mol-witness-patrol        v2    [system]\n   182â†’\n   183â†’# Show resolution path\n   184â†’bd formula show mol-polecat-work --resolve\n   185â†’  Resolving: mol-polecat-work\n   186â†’  âœ“ Found at: ~/gt/gastown/.beads/formulas/mol-polecat-work.formula.toml\n   187â†’  Tier: project\n   188â†’  Version: 4\n   189â†’\n   190â†’  Resolution path checked:\n   191â†’  1. [project] ~/gt/gastown/.beads/formulas/ â† FOUND\n   192â†’  2. [town]    ~/gt/.beads/formulas/\n   193â†’  3. [system]  <embedded>\n   194â†’\n   195â†’# Override tier for testing\n   196â†’bd cook mol-polecat-work --tier=system    # Force embedded version\n   197â†’bd cook mol-polecat-work --tier=town      # Force town version\n   198â†’```\n   199â†’\n   200â†’### Future (Mol Mall)\n   201â†’\n   202â†’```bash\n   203â†’# Install from Mol Mall\n   204â†’gt formula install mol-code-review-strict\n   205â†’gt formula install mol-code-review-strict@2.0.0\n   206â†’gt formula install hop://acme.corp/formulas/mol-deploy\n   207â†’\n   208â†’# Manage installed formulas\n   209â†’gt formula list --installed              # What's in town-level\n   210â†’gt formula upgrade mol-polecat-work      # Update to latest\n   211â†’gt formula pin mol-polecat-work@4.0.0    # Lock version\n   212â†’gt formula uninstall mol-code-review-strict\n   213â†’```\n   214â†’\n   215â†’## Migration Path\n   216â†’\n   217â†’### Phase 1: Resolution Order (Now)\n   218â†’\n   219â†’1. Implement three-tier resolution in `bd cook`\n   220â†’2. Add `--resolve` flag to show resolution path\n   221â†’3. Update `bd formula list` to show tiers\n   222â†’4. Fix crew directories (Option B)\n   223â†’\n   224â†’### Phase 2: Town-Level Formulas\n   225â†’\n   226â†’1. Establish `~/gt/.beads/formulas/` as town formula location\n   227â†’2. Add `gt formula` commands for managing town formulas\n   228â†’3. Support manual installation (copy file, track in `.installed.json`)\n   229â†’\n   230â†’### Phase 3: Mol Mall Integration\n   231â†’\n   232â†’1. Define registry API (see mol-mall-design.md)\n   233â†’2. Implement `gt formula install` from remote\n   234â†’3. Add version pinning and upgrade flows\n   235â†’4. Add integrity verification (checksums, optional signing)\n   236â†’\n   237â†’### Phase 4: Federation (HOP)\n   238â†’\n   239â†’1. Add capability tags to formula schema\n   240â†’2. Track formula execution for agent accountability\n   241â†’3. Enable federation (cross-town formula sharing via Highway Operations Protocol)\n   242â†’4. Author attribution and validation records\n   243â†’\n   244â†’## Related Documents\n   245â†’\n   246â†’- [Mol Mall Design](mol-mall-design.md) - Registry architecture\n   247â†’- [molecules.md](molecules.md) - Formula â†’ Proto â†’ Mol lifecycle\n   248â†’- [understanding-gas-town.md](../../../docs/understanding-gas-town.md) - Gas Town architecture\n   249â†’\n\n<system-reminder>\nWhenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.\n</system-reminder>\n"}]},"uuid":"bd12706e-a49f-4bbf-9401-8f7248c94617","timestamp":"2026-01-20T16:18:20.471Z","toolUseResult":{"type":"text","file":{"filePath":"/Users/csells/Code/gastownhall/website/docs-fodder/gastown-docs/formula-resolution.md","content":"# Formula Resolution Architecture\n\n> Where formulas live, how they're found, and how they'll scale to Mol Mall\n\n## The Problem\n\nFormulas currently exist in multiple locations with no clear precedence:\n- `.beads/formulas/` (source of truth for a project)\n- `internal/formula/formulas/` (embedded copy for `go install`)\n- Crew directories have their own `.beads/formulas/` (diverging copies)\n\nWhen an agent runs `bd cook mol-polecat-work`, which version do they get?\n\n## Design Goals\n\n1. **Predictable resolution** - Clear precedence rules\n2. **Local customization** - Override system defaults without forking\n3. **Project-specific formulas** - Committed workflows for collaborators\n4. **Mol Mall ready** - Architecture supports remote formula installation\n5. **Federation ready** - Formulas are shareable across towns via HOP (Highway Operations Protocol)\n\n## Three-Tier Resolution\n\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚                     FORMULA RESOLUTION ORDER                     â”‚\nâ”‚                    (most specific wins)                          â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n\nTIER 1: PROJECT (rig-level)\n  Location: <project>/.beads/formulas/\n  Source:   Committed to project repo\n  Use case: Project-specific workflows (deploy, test, release)\n  Example:  ~/gt/gastown/.beads/formulas/mol-gastown-release.formula.toml\n\nTIER 2: TOWN (user-level)\n  Location: ~/gt/.beads/formulas/\n  Source:   Mol Mall installs, user customizations\n  Use case: Cross-project workflows, personal preferences\n  Example:  ~/gt/.beads/formulas/mol-polecat-work.formula.toml (customized)\n\nTIER 3: SYSTEM (embedded)\n  Location: Compiled into gt binary\n  Source:   gastown/mayor/rig/.beads/formulas/ at build time\n  Use case: Defaults, blessed patterns, fallback\n  Example:  mol-polecat-work.formula.toml (factory default)\n```\n\n### Resolution Algorithm\n\n```go\nfunc ResolveFormula(name string, cwd string) (Formula, Tier, error) {\n    // Tier 1: Project-level (walk up from cwd to find .beads/formulas/)\n    if projectDir := findProjectRoot(cwd); projectDir != \"\" {\n        path := filepath.Join(projectDir, \".beads\", \"formulas\", name+\".formula.toml\")\n        if f, err := loadFormula(path); err == nil {\n            return f, TierProject, nil\n        }\n    }\n\n    // Tier 2: Town-level\n    townDir := getTownRoot() // ~/gt or $GT_HOME\n    path := filepath.Join(townDir, \".beads\", \"formulas\", name+\".formula.toml\")\n    if f, err := loadFormula(path); err == nil {\n        return f, TierTown, nil\n    }\n\n    // Tier 3: Embedded (system)\n    if f, err := loadEmbeddedFormula(name); err == nil {\n        return f, TierSystem, nil\n    }\n\n    return nil, 0, ErrFormulaNotFound\n}\n```\n\n### Why This Order\n\n**Project wins** because:\n- Project maintainers know their workflows best\n- Collaborators get consistent behavior via git\n- CI/CD uses the same formulas as developers\n\n**Town is middle** because:\n- User customizations override system defaults\n- Mol Mall installs don't require project changes\n- Cross-project consistency for the user\n\n**System is fallback** because:\n- Always available (compiled in)\n- Factory reset target\n- The \"blessed\" versions\n\n## Formula Identity\n\n### Current Format\n\n```toml\nformula = \"mol-polecat-work\"\nversion = 4\ndescription = \"...\"\n```\n\n### Extended Format (Mol Mall Ready)\n\n```toml\n[formula]\nname = \"mol-polecat-work\"\nversion = \"4.0.0\"                          # Semver\nauthor = \"steve@gastown.io\"                # Author identity\nlicense = \"MIT\"\nrepository = \"https://github.com/steveyegge/gastown\"\n\n[formula.registry]\nuri = \"hop://molmall.gastown.io/formulas/mol-polecat-work@4.0.0\"\nchecksum = \"sha256:abc123...\"              # Integrity verification\nsigned_by = \"steve@gastown.io\"             # Optional signing\n\n[formula.capabilities]\n# What capabilities does this formula exercise? Used for agent routing.\nprimary = [\"go\", \"testing\", \"code-review\"]\nsecondary = [\"git\", \"ci-cd\"]\n```\n\n### Version Resolution\n\nWhen multiple versions exist:\n\n```bash\nbd cook mol-polecat-work          # Resolves per tier order\nbd cook mol-polecat-work@4        # Specific major version\nbd cook mol-polecat-work@4.0.0    # Exact version\nbd cook mol-polecat-work@latest   # Explicit latest\n```\n\n## Crew Directory Problem\n\n### Current State\n\nCrew directories (`gastown/crew/max/`) are sparse checkouts of gastown. They have:\n- Their own `.beads/formulas/` (from the checkout)\n- These can diverge from `mayor/rig/.beads/formulas/`\n\n### The Fix\n\nCrew should NOT have their own formula copies. Options:\n\n**Option A: Symlink/Redirect**\n```bash\n# crew/max/.beads/formulas -> ../../mayor/rig/.beads/formulas\n```\nAll crew share the rig's formulas.\n\n**Option B: Provision on Demand**\nCrew directories don't have `.beads/formulas/`. Resolution falls through to:\n1. Town-level (~/gt/.beads/formulas/)\n2. System (embedded)\n\n**Option C: Sparse Checkout Exclusion**\nExclude `.beads/formulas/` from crew sparse checkouts entirely.\n\n**Recommendation: Option B** - Crew shouldn't need project-level formulas. They work on the project, they don't define its workflows.\n\n## Commands\n\n### Existing\n\n```bash\nbd formula list              # Available formulas (should show tier)\nbd formula show <name>       # Formula details\nbd cook <formula>            # Formula â†’ Proto\n```\n\n### Enhanced\n\n```bash\n# List with tier information\nbd formula list\n  mol-polecat-work          v4    [project]\n  mol-polecat-code-review   v1    [town]\n  mol-witness-patrol        v2    [system]\n\n# Show resolution path\nbd formula show mol-polecat-work --resolve\n  Resolving: mol-polecat-work\n  âœ“ Found at: ~/gt/gastown/.beads/formulas/mol-polecat-work.formula.toml\n  Tier: project\n  Version: 4\n\n  Resolution path checked:\n  1. [project] ~/gt/gastown/.beads/formulas/ â† FOUND\n  2. [town]    ~/gt/.beads/formulas/\n  3. [system]  <embedded>\n\n# Override tier for testing\nbd cook mol-polecat-work --tier=system    # Force embedded version\nbd cook mol-polecat-work --tier=town      # Force town version\n```\n\n### Future (Mol Mall)\n\n```bash\n# Install from Mol Mall\ngt formula install mol-code-review-strict\ngt formula install mol-code-review-strict@2.0.0\ngt formula install hop://acme.corp/formulas/mol-deploy\n\n# Manage installed formulas\ngt formula list --installed              # What's in town-level\ngt formula upgrade mol-polecat-work      # Update to latest\ngt formula pin mol-polecat-work@4.0.0    # Lock version\ngt formula uninstall mol-code-review-strict\n```\n\n## Migration Path\n\n### Phase 1: Resolution Order (Now)\n\n1. Implement three-tier resolution in `bd cook`\n2. Add `--resolve` flag to show resolution path\n3. Update `bd formula list` to show tiers\n4. Fix crew directories (Option B)\n\n### Phase 2: Town-Level Formulas\n\n1. Establish `~/gt/.beads/formulas/` as town formula location\n2. Add `gt formula` commands for managing town formulas\n3. Support manual installation (copy file, track in `.installed.json`)\n\n### Phase 3: Mol Mall Integration\n\n1. Define registry API (see mol-mall-design.md)\n2. Implement `gt formula install` from remote\n3. Add version pinning and upgrade flows\n4. Add integrity verification (checksums, optional signing)\n\n### Phase 4: Federation (HOP)\n\n1. Add capability tags to formula schema\n2. Track formula execution for agent accountability\n3. Enable federation (cross-town formula sharing via Highway Operations Protocol)\n4. Author attribution and validation records\n\n## Related Documents\n\n- [Mol Mall Design](mol-mall-design.md) - Registry architecture\n- [molecules.md](molecules.md) - Formula â†’ Proto â†’ Mol lifecycle\n- [understanding-gas-town.md](../../../docs/understanding-gas-town.md) - Gas Town architecture\n","numLines":249,"startLine":1,"totalLines":249}},"sourceToolAssistantUUID":"32ada12d-046c-4941-8d62-ac51ae5d4854"}
{"parentUuid":"08bb03c5-909e-465e-8a4e-f24f052826c1","isSidechain":true,"userType":"external","cwd":"/Users/csells/Code/gastownhall/website","sessionId":"dc9d694e-994e-4b73-9876-59c87b636ae6","version":"2.1.12","gitBranch":"main","agentId":"af83d1f","slug":"snappy-doodling-pudding","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01D8n2HEL4XiVykK6Yq5jefv","type":"tool_result","content":"     1â†’# Convoys\n     2â†’\n     3â†’Convoys are the primary unit for tracking batched work across rigs.\n     4â†’\n     5â†’## Quick Start\n     6â†’\n     7â†’```bash\n     8â†’# Create a convoy tracking some issues\n     9â†’gt convoy create \"Feature X\" gt-abc gt-def --notify overseer\n    10â†’\n    11â†’# Check progress\n    12â†’gt convoy status hq-cv-abc\n    13â†’\n    14â†’# List active convoys (the dashboard)\n    15â†’gt convoy list\n    16â†’\n    17â†’# See all convoys including landed ones\n    18â†’gt convoy list --all\n    19â†’```\n    20â†’\n    21â†’## Concept\n    22â†’\n    23â†’A **convoy** is a persistent tracking unit that monitors related issues across\n    24â†’multiple rigs. When you kick off work - even a single issue - a convoy tracks it\n    25â†’so you can see when it lands and what was included.\n    26â†’\n    27â†’```\n    28â†’                 ðŸšš Convoy (hq-cv-abc)\n    29â†’                         â”‚\n    30â†’            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n    31â†’            â”‚            â”‚            â”‚\n    32â†’            â–¼            â–¼            â–¼\n    33â†’       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n    34â†’       â”‚ gt-xyz  â”‚  â”‚ gt-def  â”‚  â”‚ bd-abc  â”‚\n    35â†’       â”‚ gastown â”‚  â”‚ gastown â”‚  â”‚  beads  â”‚\n    36â†’       â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜\n    37â†’            â”‚            â”‚            â”‚\n    38â†’            â–¼            â–¼            â–¼\n    39â†’       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n    40â†’       â”‚  nux    â”‚  â”‚ furiosa â”‚  â”‚  amber  â”‚\n    41â†’       â”‚(polecat)â”‚  â”‚(polecat)â”‚  â”‚(polecat)â”‚\n    42â†’       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n    43â†’                         â”‚\n    44â†’                    \"the swarm\"\n    45â†’                    (ephemeral)\n    46â†’```\n    47â†’\n    48â†’## Convoy vs Swarm\n    49â†’\n    50â†’| Concept | Persistent? | ID | Description |\n    51â†’|---------|-------------|-----|-------------|\n    52â†’| **Convoy** | Yes | hq-cv-* | Tracking unit. What you create, track, get notified about. |\n    53â†’| **Swarm** | No | None | Ephemeral. \"The workers currently on this convoy's issues.\" |\n    54â†’\n    55â†’When you \"kick off a swarm\", you're really:\n    56â†’1. Creating a convoy (the tracking unit)\n    57â†’2. Assigning polecats to the tracked issues\n    58â†’3. The \"swarm\" is just those polecats while they're working\n    59â†’\n    60â†’When issues close, the convoy lands and notifies you. The swarm dissolves.\n    61â†’\n    62â†’## Convoy Lifecycle\n    63â†’\n    64â†’```\n    65â†’OPEN â”€â”€(all issues close)â”€â”€â–º LANDED/CLOSED\n    66â†’  â†‘                              â”‚\n    67â†’  â””â”€â”€(add more issues)â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n    68â†’       (auto-reopens)\n    69â†’```\n    70â†’\n    71â†’| State | Description |\n    72â†’|-------|-------------|\n    73â†’| `open` | Active tracking, work in progress |\n    74â†’| `closed` | All tracked issues closed, notification sent |\n    75â†’\n    76â†’Adding issues to a closed convoy reopens it automatically.\n    77â†’\n    78â†’## Commands\n    79â†’\n    80â†’### Create a Convoy\n    81â†’\n    82â†’```bash\n    83â†’# Track multiple issues across rigs\n    84â†’gt convoy create \"Deploy v2.0\" gt-abc bd-xyz --notify gastown/joe\n    85â†’\n    86â†’# Track a single issue (still creates convoy for dashboard visibility)\n    87â†’gt convoy create \"Fix auth bug\" gt-auth-fix\n    88â†’\n    89â†’# With default notification (from config)\n    90â†’gt convoy create \"Feature X\" gt-a gt-b gt-c\n    91â†’```\n    92â†’\n    93â†’### Add Issues\n    94â†’\n    95â†’> **Note**: `gt convoy add` is not yet implemented. Use `bd dep add` directly:\n    96â†’\n    97â†’```bash\n    98â†’# Add issue to existing convoy\n    99â†’bd dep add hq-cv-abc gt-new-issue --type=tracks\n   100â†’\n   101â†’# Adding to closed convoy requires reopening first\n   102â†’bd update hq-cv-abc --status=open\n   103â†’bd dep add hq-cv-abc gt-followup-fix --type=tracks\n   104â†’```\n   105â†’\n   106â†’### Check Status\n   107â†’\n   108â†’```bash\n   109â†’# Show issues and active workers (the swarm)\n   110â†’gt convoy status hq-abc\n   111â†’\n   112â†’# All active convoys (the dashboard)\n   113â†’gt convoy status\n   114â†’```\n   115â†’\n   116â†’Example output:\n   117â†’```\n   118â†’ðŸšš hq-cv-abc: Deploy v2.0\n   119â†’\n   120â†’  Status:    â—\n   121â†’  Progress:  2/4 completed\n   122â†’  Created:   2025-12-30T10:15:00-08:00\n   123â†’\n   124â†’  Tracked Issues:\n   125â†’    âœ“ gt-xyz: Update API endpoint [task]\n   126â†’    âœ“ bd-abc: Fix validation [bug]\n   127â†’    â—‹ bd-ghi: Update docs [task]\n   128â†’    â—‹ gt-jkl: Deploy to prod [task]\n   129â†’```\n   130â†’\n   131â†’### List Convoys (Dashboard)\n   132â†’\n   133â†’```bash\n   134â†’# Active convoys (default) - the primary attention view\n   135â†’gt convoy list\n   136â†’\n   137â†’# All convoys including landed\n   138â†’gt convoy list --all\n   139â†’\n   140â†’# Only landed convoys\n   141â†’gt convoy list --status=closed\n   142â†’\n   143â†’# JSON output\n   144â†’gt convoy list --json\n   145â†’```\n   146â†’\n   147â†’Example output:\n   148â†’```\n   149â†’Convoys\n   150â†’\n   151â†’  ðŸšš hq-cv-w3nm6: Feature X â—\n   152â†’  ðŸšš hq-cv-abc12: Bug fixes â—\n   153â†’\n   154â†’Use 'gt convoy status <id>' for detailed view.\n   155â†’```\n   156â†’\n   157â†’## Notifications\n   158â†’\n   159â†’When a convoy lands (all tracked issues closed), subscribers are notified:\n   160â†’\n   161â†’```bash\n   162â†’# Explicit subscriber\n   163â†’gt convoy create \"Feature X\" gt-abc --notify gastown/joe\n   164â†’\n   165â†’# Multiple subscribers\n   166â†’gt convoy create \"Feature X\" gt-abc --notify mayor/ --notify --human\n   167â†’```\n   168â†’\n   169â†’Notification content:\n   170â†’```\n   171â†’ðŸšš Convoy Landed: Deploy v2.0 (hq-cv-abc)\n   172â†’\n   173â†’Issues (3):\n   174â†’  âœ“ gt-xyz: Update API endpoint\n   175â†’  âœ“ gt-def: Add validation\n   176â†’  âœ“ bd-abc: Update docs\n   177â†’\n   178â†’Duration: 2h 15m\n   179â†’```\n   180â†’\n   181â†’## Auto-Convoy on Sling\n   182â†’\n   183â†’When you sling a single issue without an existing convoy:\n   184â†’\n   185â†’```bash\n   186â†’gt sling bd-xyz beads/amber\n   187â†’```\n   188â†’\n   189â†’This auto-creates a convoy so all work appears in the dashboard:\n   190â†’1. Creates convoy: \"Work: bd-xyz\"\n   191â†’2. Tracks the issue\n   192â†’3. Assigns the polecat\n   193â†’\n   194â†’Even \"swarm of one\" gets convoy visibility.\n   195â†’\n   196â†’## Cross-Rig Tracking\n   197â†’\n   198â†’Convoys live in town-level beads (`hq-cv-*` prefix) and can track issues from any rig:\n   199â†’\n   200â†’```bash\n   201â†’# Track issues from multiple rigs\n   202â†’gt convoy create \"Full-stack feature\" \\\n   203â†’  gt-frontend-abc \\\n   204â†’  gt-backend-def \\\n   205â†’  bd-docs-xyz\n   206â†’```\n   207â†’\n   208â†’The `tracks` relation is:\n   209â†’- **Non-blocking**: doesn't affect issue workflow\n   210â†’- **Additive**: can add issues anytime\n   211â†’- **Cross-rig**: convoy in hq-*, issues in gt-*, bd-*, etc.\n   212â†’\n   213â†’## Convoy vs Rig Status\n   214â†’\n   215â†’| View | Scope | Shows |\n   216â†’|------|-------|-------|\n   217â†’| `gt convoy status [id]` | Cross-rig | Issues tracked by convoy + workers |\n   218â†’| `gt rig status <rig>` | Single rig | All workers in rig + their convoy membership |\n   219â†’\n   220â†’Use convoys for \"what's the status of this batch of work?\"\n   221â†’Use rig status for \"what's everyone in this rig working on?\"\n   222â†’\n   223â†’## See Also\n   224â†’\n   225â†’- [Propulsion Principle](propulsion-principle.md) - Worker execution model\n   226â†’- [Mail Protocol](../design/mail-protocol.md) - Notification delivery\n   227â†’\n\n<system-reminder>\nWhenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.\n</system-reminder>\n"}]},"uuid":"8f6602cc-abdd-4f61-8908-52243064289b","timestamp":"2026-01-20T16:18:20.471Z","toolUseResult":{"type":"text","file":{"filePath":"/Users/csells/Code/gastownhall/website/docs-fodder/gastown-docs/concepts/convoy.md","content":"# Convoys\n\nConvoys are the primary unit for tracking batched work across rigs.\n\n## Quick Start\n\n```bash\n# Create a convoy tracking some issues\ngt convoy create \"Feature X\" gt-abc gt-def --notify overseer\n\n# Check progress\ngt convoy status hq-cv-abc\n\n# List active convoys (the dashboard)\ngt convoy list\n\n# See all convoys including landed ones\ngt convoy list --all\n```\n\n## Concept\n\nA **convoy** is a persistent tracking unit that monitors related issues across\nmultiple rigs. When you kick off work - even a single issue - a convoy tracks it\nso you can see when it lands and what was included.\n\n```\n                 ðŸšš Convoy (hq-cv-abc)\n                         â”‚\n            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n            â”‚            â”‚            â”‚\n            â–¼            â–¼            â–¼\n       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n       â”‚ gt-xyz  â”‚  â”‚ gt-def  â”‚  â”‚ bd-abc  â”‚\n       â”‚ gastown â”‚  â”‚ gastown â”‚  â”‚  beads  â”‚\n       â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜\n            â”‚            â”‚            â”‚\n            â–¼            â–¼            â–¼\n       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n       â”‚  nux    â”‚  â”‚ furiosa â”‚  â”‚  amber  â”‚\n       â”‚(polecat)â”‚  â”‚(polecat)â”‚  â”‚(polecat)â”‚\n       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                         â”‚\n                    \"the swarm\"\n                    (ephemeral)\n```\n\n## Convoy vs Swarm\n\n| Concept | Persistent? | ID | Description |\n|---------|-------------|-----|-------------|\n| **Convoy** | Yes | hq-cv-* | Tracking unit. What you create, track, get notified about. |\n| **Swarm** | No | None | Ephemeral. \"The workers currently on this convoy's issues.\" |\n\nWhen you \"kick off a swarm\", you're really:\n1. Creating a convoy (the tracking unit)\n2. Assigning polecats to the tracked issues\n3. The \"swarm\" is just those polecats while they're working\n\nWhen issues close, the convoy lands and notifies you. The swarm dissolves.\n\n## Convoy Lifecycle\n\n```\nOPEN â”€â”€(all issues close)â”€â”€â–º LANDED/CLOSED\n  â†‘                              â”‚\n  â””â”€â”€(add more issues)â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n       (auto-reopens)\n```\n\n| State | Description |\n|-------|-------------|\n| `open` | Active tracking, work in progress |\n| `closed` | All tracked issues closed, notification sent |\n\nAdding issues to a closed convoy reopens it automatically.\n\n## Commands\n\n### Create a Convoy\n\n```bash\n# Track multiple issues across rigs\ngt convoy create \"Deploy v2.0\" gt-abc bd-xyz --notify gastown/joe\n\n# Track a single issue (still creates convoy for dashboard visibility)\ngt convoy create \"Fix auth bug\" gt-auth-fix\n\n# With default notification (from config)\ngt convoy create \"Feature X\" gt-a gt-b gt-c\n```\n\n### Add Issues\n\n> **Note**: `gt convoy add` is not yet implemented. Use `bd dep add` directly:\n\n```bash\n# Add issue to existing convoy\nbd dep add hq-cv-abc gt-new-issue --type=tracks\n\n# Adding to closed convoy requires reopening first\nbd update hq-cv-abc --status=open\nbd dep add hq-cv-abc gt-followup-fix --type=tracks\n```\n\n### Check Status\n\n```bash\n# Show issues and active workers (the swarm)\ngt convoy status hq-abc\n\n# All active convoys (the dashboard)\ngt convoy status\n```\n\nExample output:\n```\nðŸšš hq-cv-abc: Deploy v2.0\n\n  Status:    â—\n  Progress:  2/4 completed\n  Created:   2025-12-30T10:15:00-08:00\n\n  Tracked Issues:\n    âœ“ gt-xyz: Update API endpoint [task]\n    âœ“ bd-abc: Fix validation [bug]\n    â—‹ bd-ghi: Update docs [task]\n    â—‹ gt-jkl: Deploy to prod [task]\n```\n\n### List Convoys (Dashboard)\n\n```bash\n# Active convoys (default) - the primary attention view\ngt convoy list\n\n# All convoys including landed\ngt convoy list --all\n\n# Only landed convoys\ngt convoy list --status=closed\n\n# JSON output\ngt convoy list --json\n```\n\nExample output:\n```\nConvoys\n\n  ðŸšš hq-cv-w3nm6: Feature X â—\n  ðŸšš hq-cv-abc12: Bug fixes â—\n\nUse 'gt convoy status <id>' for detailed view.\n```\n\n## Notifications\n\nWhen a convoy lands (all tracked issues closed), subscribers are notified:\n\n```bash\n# Explicit subscriber\ngt convoy create \"Feature X\" gt-abc --notify gastown/joe\n\n# Multiple subscribers\ngt convoy create \"Feature X\" gt-abc --notify mayor/ --notify --human\n```\n\nNotification content:\n```\nðŸšš Convoy Landed: Deploy v2.0 (hq-cv-abc)\n\nIssues (3):\n  âœ“ gt-xyz: Update API endpoint\n  âœ“ gt-def: Add validation\n  âœ“ bd-abc: Update docs\n\nDuration: 2h 15m\n```\n\n## Auto-Convoy on Sling\n\nWhen you sling a single issue without an existing convoy:\n\n```bash\ngt sling bd-xyz beads/amber\n```\n\nThis auto-creates a convoy so all work appears in the dashboard:\n1. Creates convoy: \"Work: bd-xyz\"\n2. Tracks the issue\n3. Assigns the polecat\n\nEven \"swarm of one\" gets convoy visibility.\n\n## Cross-Rig Tracking\n\nConvoys live in town-level beads (`hq-cv-*` prefix) and can track issues from any rig:\n\n```bash\n# Track issues from multiple rigs\ngt convoy create \"Full-stack feature\" \\\n  gt-frontend-abc \\\n  gt-backend-def \\\n  bd-docs-xyz\n```\n\nThe `tracks` relation is:\n- **Non-blocking**: doesn't affect issue workflow\n- **Additive**: can add issues anytime\n- **Cross-rig**: convoy in hq-*, issues in gt-*, bd-*, etc.\n\n## Convoy vs Rig Status\n\n| View | Scope | Shows |\n|------|-------|-------|\n| `gt convoy status [id]` | Cross-rig | Issues tracked by convoy + workers |\n| `gt rig status <rig>` | Single rig | All workers in rig + their convoy membership |\n\nUse convoys for \"what's the status of this batch of work?\"\nUse rig status for \"what's everyone in this rig working on?\"\n\n## See Also\n\n- [Propulsion Principle](propulsion-principle.md) - Worker execution model\n- [Mail Protocol](../design/mail-protocol.md) - Notification delivery\n","numLines":227,"startLine":1,"totalLines":227}},"sourceToolAssistantUUID":"08bb03c5-909e-465e-8a4e-f24f052826c1"}
{"parentUuid":"4e98585c-acc6-43f8-b85b-6b5e4fe9a943","isSidechain":true,"userType":"external","cwd":"/Users/csells/Code/gastownhall/website","sessionId":"dc9d694e-994e-4b73-9876-59c87b636ae6","version":"2.1.12","gitBranch":"main","agentId":"af83d1f","slug":"snappy-doodling-pudding","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01DScJ84RcatijEJSiiQ2WcW","type":"tool_result","content":"     1â†’# Polecat Lifecycle\n     2â†’\n     3â†’> Understanding the three-layer architecture of polecat workers\n     4â†’\n     5â†’## Overview\n     6â†’\n     7â†’Polecats have three distinct lifecycle layers that operate independently. Confusing\n     8â†’these layers leads to \"heresies\" like thinking there are \"idle polecats\" and\n     9â†’misunderstanding when recycling occurs.\n    10â†’\n    11â†’## The Three Operating States\n    12â†’\n    13â†’Polecats have exactly three operating states. There is **no idle pool**.\n    14â†’\n    15â†’| State | Description | How it happens |\n    16â†’|-------|-------------|----------------|\n    17â†’| **Working** | Actively doing assigned work | Normal operation |\n    18â†’| **Stalled** | Session stopped mid-work | Interrupted, crashed, or timed out without being nudged |\n    19â†’| **Zombie** | Completed work but failed to die | `gt done` failed during cleanup |\n    20â†’\n    21â†’**The key distinction:** Zombies completed their work; stalled polecats did not.\n    22â†’\n    23â†’- **Stalled** = supposed to be working, but stopped. The polecat was interrupted or\n    24â†’  crashed and was never nudged back to life. Work is incomplete.\n    25â†’- **Zombie** = finished work, tried to exit via `gt done`, but cleanup failed. The\n    26â†’  session should have shut down but didn't. Work is complete, just stuck in limbo.\n    27â†’\n    28â†’There is no \"idle\" state. Polecats don't wait around between tasks. When work is\n    29â†’done, `gt done` shuts down the session. If you see a non-working polecat, something\n    30â†’is broken.\n    31â†’\n    32â†’## The Self-Cleaning Polecat Model\n    33â†’\n    34â†’**Polecats are responsible for their own cleanup.** When a polecat completes its\n    35â†’work unit, it:\n    36â†’\n    37â†’1. Signals completion via `gt done`\n    38â†’2. Exits its session immediately (no idle waiting)\n    39â†’3. Requests its own nuke (self-delete)\n    40â†’\n    41â†’This removes dependency on the Witness/Deacon for cleanup and ensures polecats\n    42â†’never sit idle. The simple model: **sandbox dies with session**.\n    43â†’\n    44â†’### Why Self-Cleaning?\n    45â†’\n    46â†’- **No idle polecats** - There's no state where a polecat exists without work\n    47â†’- **Reduced watchdog overhead** - Deacon patrols for stalled/zombie polecats, not idle ones\n    48â†’- **Faster turnover** - Resources freed immediately on completion\n    49â†’- **Simpler mental model** - Done means gone\n    50â†’\n    51â†’### What About Pending Merges?\n    52â†’\n    53â†’The Refinery owns the merge queue. Once `gt done` submits work:\n    54â†’- The branch is pushed to origin\n    55â†’- Work exists in the MQ, not in the polecat\n    56â†’- If rebase fails, Refinery re-implements on new baseline (fresh polecat)\n    57â†’- The original polecat is already gone - no sending work \"back\"\n    58â†’\n    59â†’## The Three Layers\n    60â†’\n    61â†’| Layer | Component | Lifecycle | Persistence |\n    62â†’|-------|-----------|-----------|-------------|\n    63â†’| **Session** | Claude (tmux pane) | Ephemeral | Cycles per step/handoff |\n    64â†’| **Sandbox** | Git worktree | Persistent | Until nuke |\n    65â†’| **Slot** | Name from pool | Persistent | Until nuke |\n    66â†’\n    67â†’### Session Layer\n    68â†’\n    69â†’The Claude session is **ephemeral**. It cycles frequently:\n    70â†’\n    71â†’- After each molecule step (via `gt handoff`)\n    72â†’- On context compaction\n    73â†’- On crash/timeout\n    74â†’- After extended work periods\n    75â†’\n    76â†’**Key insight:** Session cycling is **normal operation**, not failure. The polecat\n    77â†’continues workingâ€”only the Claude context refreshes.\n    78â†’\n    79â†’```\n    80â†’Session 1: Steps 1-2 â†’ handoff\n    81â†’Session 2: Steps 3-4 â†’ handoff\n    82â†’Session 3: Step 5 â†’ gt done\n    83â†’```\n    84â†’\n    85â†’All three sessions are the **same polecat**. The sandbox and slot persist throughout.\n    86â†’\n    87â†’### Sandbox Layer\n    88â†’\n    89â†’The sandbox is the **git worktree**â€”the polecat's working directory:\n    90â†’\n    91â†’```\n    92â†’~/gt/gastown/polecats/Toast/\n    93â†’```\n    94â†’\n    95â†’This worktree:\n    96â†’- Exists from `gt sling` until `gt polecat nuke`\n    97â†’- Survives all session cycles\n    98â†’- Contains uncommitted work, staged changes, branch state\n    99â†’- Is independent of other polecat sandboxes\n   100â†’\n   101â†’The Witness never destroys sandboxes mid-work. Only `nuke` removes them.\n   102â†’\n   103â†’### Slot Layer\n   104â†’\n   105â†’The slot is the **name allocation** from the polecat pool:\n   106â†’\n   107â†’```bash\n   108â†’# Pool: [Toast, Shadow, Copper, Ash, Storm...]\n   109â†’# Toast is allocated to work gt-abc\n   110â†’```\n   111â†’\n   112â†’The slot:\n   113â†’- Determines the sandbox path (`polecats/Toast/`)\n   114â†’- Maps to a tmux session (`gt-gastown-Toast`)\n   115â†’- Appears in attribution (`gastown/polecats/Toast`)\n   116â†’- Is released only on nuke\n   117â†’\n   118â†’## Correct Lifecycle\n   119â†’\n   120â†’```\n   121â†’â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n   122â†’â”‚                        gt sling                             â”‚\n   123â†’â”‚  â†’ Allocate slot from pool (Toast)                         â”‚\n   124â†’â”‚  â†’ Create sandbox (worktree on new branch)                 â”‚\n   125â†’â”‚  â†’ Start session (Claude in tmux)                          â”‚\n   126â†’â”‚  â†’ Hook molecule to polecat                                â”‚\n   127â†’â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n   128â†’                              â”‚\n   129â†’                              â–¼\n   130â†’â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n   131â†’â”‚                     Work Happens                            â”‚\n   132â†’â”‚                                                             â”‚\n   133â†’â”‚  Session cycles happen here:                               â”‚\n   134â†’â”‚  - gt handoff between steps                                â”‚\n   135â†’â”‚  - Compaction triggers respawn                             â”‚\n   136â†’â”‚  - Crash â†’ Witness respawns                                â”‚\n   137â†’â”‚                                                             â”‚\n   138â†’â”‚  Sandbox persists through ALL session cycles               â”‚\n   139â†’â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n   140â†’                              â”‚\n   141â†’                              â–¼\n   142â†’â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n   143â†’â”‚                  gt done (self-cleaning)                    â”‚\n   144â†’â”‚  â†’ Push branch to origin                                   â”‚\n   145â†’â”‚  â†’ Submit work to merge queue (MR bead)                    â”‚\n   146â†’â”‚  â†’ Request self-nuke (sandbox + session cleanup)           â”‚\n   147â†’â”‚  â†’ Exit immediately                                        â”‚\n   148â†’â”‚                                                             â”‚\n   149â†’â”‚  Work now lives in MQ, not in polecat.                     â”‚\n   150â†’â”‚  Polecat is GONE. No idle state.                           â”‚\n   151â†’â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n   152â†’                              â”‚\n   153â†’                              â–¼\n   154â†’â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n   155â†’â”‚                   Refinery: merge queue                     â”‚\n   156â†’â”‚  â†’ Rebase and merge to main                                â”‚\n   157â†’â”‚  â†’ Close the issue                                         â”‚\n   158â†’â”‚  â†’ If conflict: spawn FRESH polecat to re-implement        â”‚\n   159â†’â”‚    (never send work back to original polecat - it's gone)  â”‚\n   160â†’â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n   161â†’```\n   162â†’\n   163â†’## What \"Recycle\" Means\n   164â†’\n   165â†’**Session cycling**: Normal. Claude restarts, sandbox stays, slot stays.\n   166â†’\n   167â†’```bash\n   168â†’gt handoff  # Session cycles, polecat continues\n   169â†’```\n   170â†’\n   171â†’**Sandbox recreation**: Repair only. Should be rare.\n   172â†’\n   173â†’```bash\n   174â†’gt polecat repair Toast  # Emergency: recreate corrupted worktree\n   175â†’```\n   176â†’\n   177â†’Session cycling happens constantly. Sandbox recreation should almost never happen\n   178â†’during normal operation.\n   179â†’\n   180â†’## Anti-Patterns\n   181â†’\n   182â†’### \"Idle\" Polecats (They Don't Exist)\n   183â†’\n   184â†’**Myth:** Polecats wait between tasks in an idle pool.\n   185â†’\n   186â†’**Reality:** There is no idle state. Polecats don't exist without work:\n   187â†’1. Work assigned â†’ polecat spawned\n   188â†’2. Work done â†’ `gt done` â†’ session exits â†’ polecat nuked\n   189â†’3. There is no step 3 where they wait around\n   190â†’\n   191â†’If you see a non-working polecat, it's in a **failure state**:\n   192â†’\n   193â†’| What you see | What it is | What went wrong |\n   194â†’|--------------|------------|-----------------|\n   195â†’| Session exists but not working | **Stalled** | Interrupted/crashed, never nudged |\n   196â†’| Session done but didn't exit | **Zombie** | `gt done` failed during cleanup |\n   197â†’\n   198â†’Don't call these \"idle\" - that implies they're waiting for work. They're not.\n   199â†’A stalled polecat is *supposed* to be working. A zombie is *supposed* to be dead.\n   200â†’\n   201â†’### Manual State Transitions\n   202â†’\n   203â†’**Anti-pattern:**\n   204â†’```bash\n   205â†’gt polecat done Toast    # DON'T: external state manipulation\n   206â†’gt polecat reset Toast   # DON'T: manual lifecycle control\n   207â†’```\n   208â†’\n   209â†’**Correct:**\n   210â†’```bash\n   211â†’# Polecat signals its own completion:\n   212â†’gt done  # (from inside the polecat session)\n   213â†’\n   214â†’# Only Witness nukes polecats:\n   215â†’gt polecat nuke Toast  # (from Witness, after verification)\n   216â†’```\n   217â†’\n   218â†’Polecats manage their own session lifecycle. The Witness manages sandbox lifecycle.\n   219â†’External manipulation bypasses verification.\n   220â†’\n   221â†’### Sandboxes Without Work (Stalled Polecats)\n   222â†’\n   223â†’**Anti-pattern:** A sandbox exists but no molecule is hooked, or the session isn't running.\n   224â†’\n   225â†’This is a **stalled** polecat. It means:\n   226â†’- The session crashed and wasn't nudged back to life\n   227â†’- The hook was lost during a crash\n   228â†’- State corruption occurred\n   229â†’\n   230â†’This is NOT an \"idle\" polecat waiting for work. It's stalled - supposed to be\n   231â†’working but stopped unexpectedly.\n   232â†’\n   233â†’**Recovery:**\n   234â†’```bash\n   235â†’# From Witness:\n   236â†’gt polecat nuke Toast        # Clean up the stalled polecat\n   237â†’gt sling gt-abc gastown      # Respawn with fresh polecat\n   238â†’```\n   239â†’\n   240â†’### Confusing Session with Sandbox\n   241â†’\n   242â†’**Anti-pattern:** Thinking session restart = losing work.\n   243â†’\n   244â†’```bash\n   245â†’# Session ends (handoff, crash, compaction)\n   246â†’# Work is NOT lost because:\n   247â†’# - Git commits persist in sandbox\n   248â†’# - Staged changes persist in sandbox\n   249â†’# - Molecule state persists in beads\n   250â†’# - Hook persists across sessions\n   251â†’```\n   252â†’\n   253â†’The new session picks up where the old one left off via `gt prime`.\n   254â†’\n   255â†’## Session Lifecycle Details\n   256â†’\n   257â†’Sessions cycle for these reasons:\n   258â†’\n   259â†’| Trigger | Action | Result |\n   260â†’|---------|--------|--------|\n   261â†’| `gt handoff` | Voluntary | Clean cycle to fresh context |\n   262â†’| Context compaction | Automatic | Forced by Claude Code |\n   263â†’| Crash/timeout | Failure | Witness respawns |\n   264â†’| `gt done` | Completion | Session exits, Witness takes over |\n   265â†’\n   266â†’All except `gt done` result in continued work. Only `gt done` signals completion.\n   267â†’\n   268â†’## Witness Responsibilities\n   269â†’\n   270â†’The Witness monitors polecats but does NOT:\n   271â†’- Force session cycles (polecats self-manage via handoff)\n   272â†’- Interrupt mid-step (unless truly stuck)\n   273â†’- Nuke polecats (polecats self-nuke via `gt done`)\n   274â†’\n   275â†’The Witness DOES:\n   276â†’- Detect and nudge stalled polecats (sessions that stopped unexpectedly)\n   277â†’- Clean up zombie polecats (sessions where `gt done` failed)\n   278â†’- Respawn crashed sessions\n   279â†’- Handle escalations from stuck polecats (polecats that explicitly asked for help)\n   280â†’\n   281â†’## Polecat Identity\n   282â†’\n   283â†’**Key insight:** Polecat *identity* is long-lived; only sessions and sandboxes are ephemeral.\n   284â†’\n   285â†’In the HOP model, every entity has a chain (CV) that tracks:\n   286â†’- What work they've done\n   287â†’- Success/failure rates\n   288â†’- Skills demonstrated\n   289â†’- Quality metrics\n   290â†’\n   291â†’The polecat *name* (Toast, Shadow, etc.) is a slot from a pool - truly ephemeral.\n   292â†’But the *agent identity* that executes as that polecat accumulates a work history.\n   293â†’\n   294â†’```\n   295â†’POLECAT IDENTITY (persistent)     SESSION (ephemeral)     SANDBOX (ephemeral)\n   296â†’â”œâ”€â”€ CV chain                      â”œâ”€â”€ Claude instance     â”œâ”€â”€ Git worktree\n   297â†’â”œâ”€â”€ Work history                  â”œâ”€â”€ Context window      â”œâ”€â”€ Branch\n   298â†’â”œâ”€â”€ Skills demonstrated           â””â”€â”€ Dies on handoff     â””â”€â”€ Dies on gt done\n   299â†’â””â”€â”€ Credit for work                   or gt done\n   300â†’```\n   301â†’\n   302â†’This distinction matters for:\n   303â†’- **Attribution** - Who gets credit for the work?\n   304â†’- **Skill routing** - Which agent is best for this task?\n   305â†’- **Cost accounting** - Who pays for inference?\n   306â†’- **Federation** - Agents having their own chains in a distributed world\n   307â†’\n   308â†’## Related Documentation\n   309â†’\n   310â†’- [Overview](../overview.md) - Role taxonomy and architecture\n   311â†’- [Molecules](molecules.md) - Molecule execution and polecat workflow\n   312â†’- [Propulsion Principle](propulsion-principle.md) - Why work triggers immediate execution\n   313â†’\n\n<system-reminder>\nWhenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.\n</system-reminder>\n"}]},"uuid":"762ad486-dfba-4985-9396-7568ea0dacaf","timestamp":"2026-01-20T16:18:20.471Z","toolUseResult":{"type":"text","file":{"filePath":"/Users/csells/Code/gastownhall/website/docs-fodder/gastown-docs/concepts/polecat-lifecycle.md","content":"# Polecat Lifecycle\n\n> Understanding the three-layer architecture of polecat workers\n\n## Overview\n\nPolecats have three distinct lifecycle layers that operate independently. Confusing\nthese layers leads to \"heresies\" like thinking there are \"idle polecats\" and\nmisunderstanding when recycling occurs.\n\n## The Three Operating States\n\nPolecats have exactly three operating states. There is **no idle pool**.\n\n| State | Description | How it happens |\n|-------|-------------|----------------|\n| **Working** | Actively doing assigned work | Normal operation |\n| **Stalled** | Session stopped mid-work | Interrupted, crashed, or timed out without being nudged |\n| **Zombie** | Completed work but failed to die | `gt done` failed during cleanup |\n\n**The key distinction:** Zombies completed their work; stalled polecats did not.\n\n- **Stalled** = supposed to be working, but stopped. The polecat was interrupted or\n  crashed and was never nudged back to life. Work is incomplete.\n- **Zombie** = finished work, tried to exit via `gt done`, but cleanup failed. The\n  session should have shut down but didn't. Work is complete, just stuck in limbo.\n\nThere is no \"idle\" state. Polecats don't wait around between tasks. When work is\ndone, `gt done` shuts down the session. If you see a non-working polecat, something\nis broken.\n\n## The Self-Cleaning Polecat Model\n\n**Polecats are responsible for their own cleanup.** When a polecat completes its\nwork unit, it:\n\n1. Signals completion via `gt done`\n2. Exits its session immediately (no idle waiting)\n3. Requests its own nuke (self-delete)\n\nThis removes dependency on the Witness/Deacon for cleanup and ensures polecats\nnever sit idle. The simple model: **sandbox dies with session**.\n\n### Why Self-Cleaning?\n\n- **No idle polecats** - There's no state where a polecat exists without work\n- **Reduced watchdog overhead** - Deacon patrols for stalled/zombie polecats, not idle ones\n- **Faster turnover** - Resources freed immediately on completion\n- **Simpler mental model** - Done means gone\n\n### What About Pending Merges?\n\nThe Refinery owns the merge queue. Once `gt done` submits work:\n- The branch is pushed to origin\n- Work exists in the MQ, not in the polecat\n- If rebase fails, Refinery re-implements on new baseline (fresh polecat)\n- The original polecat is already gone - no sending work \"back\"\n\n## The Three Layers\n\n| Layer | Component | Lifecycle | Persistence |\n|-------|-----------|-----------|-------------|\n| **Session** | Claude (tmux pane) | Ephemeral | Cycles per step/handoff |\n| **Sandbox** | Git worktree | Persistent | Until nuke |\n| **Slot** | Name from pool | Persistent | Until nuke |\n\n### Session Layer\n\nThe Claude session is **ephemeral**. It cycles frequently:\n\n- After each molecule step (via `gt handoff`)\n- On context compaction\n- On crash/timeout\n- After extended work periods\n\n**Key insight:** Session cycling is **normal operation**, not failure. The polecat\ncontinues workingâ€”only the Claude context refreshes.\n\n```\nSession 1: Steps 1-2 â†’ handoff\nSession 2: Steps 3-4 â†’ handoff\nSession 3: Step 5 â†’ gt done\n```\n\nAll three sessions are the **same polecat**. The sandbox and slot persist throughout.\n\n### Sandbox Layer\n\nThe sandbox is the **git worktree**â€”the polecat's working directory:\n\n```\n~/gt/gastown/polecats/Toast/\n```\n\nThis worktree:\n- Exists from `gt sling` until `gt polecat nuke`\n- Survives all session cycles\n- Contains uncommitted work, staged changes, branch state\n- Is independent of other polecat sandboxes\n\nThe Witness never destroys sandboxes mid-work. Only `nuke` removes them.\n\n### Slot Layer\n\nThe slot is the **name allocation** from the polecat pool:\n\n```bash\n# Pool: [Toast, Shadow, Copper, Ash, Storm...]\n# Toast is allocated to work gt-abc\n```\n\nThe slot:\n- Determines the sandbox path (`polecats/Toast/`)\n- Maps to a tmux session (`gt-gastown-Toast`)\n- Appears in attribution (`gastown/polecats/Toast`)\n- Is released only on nuke\n\n## Correct Lifecycle\n\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚                        gt sling                             â”‚\nâ”‚  â†’ Allocate slot from pool (Toast)                         â”‚\nâ”‚  â†’ Create sandbox (worktree on new branch)                 â”‚\nâ”‚  â†’ Start session (Claude in tmux)                          â”‚\nâ”‚  â†’ Hook molecule to polecat                                â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                              â”‚\n                              â–¼\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚                     Work Happens                            â”‚\nâ”‚                                                             â”‚\nâ”‚  Session cycles happen here:                               â”‚\nâ”‚  - gt handoff between steps                                â”‚\nâ”‚  - Compaction triggers respawn                             â”‚\nâ”‚  - Crash â†’ Witness respawns                                â”‚\nâ”‚                                                             â”‚\nâ”‚  Sandbox persists through ALL session cycles               â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                              â”‚\n                              â–¼\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚                  gt done (self-cleaning)                    â”‚\nâ”‚  â†’ Push branch to origin                                   â”‚\nâ”‚  â†’ Submit work to merge queue (MR bead)                    â”‚\nâ”‚  â†’ Request self-nuke (sandbox + session cleanup)           â”‚\nâ”‚  â†’ Exit immediately                                        â”‚\nâ”‚                                                             â”‚\nâ”‚  Work now lives in MQ, not in polecat.                     â”‚\nâ”‚  Polecat is GONE. No idle state.                           â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                              â”‚\n                              â–¼\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚                   Refinery: merge queue                     â”‚\nâ”‚  â†’ Rebase and merge to main                                â”‚\nâ”‚  â†’ Close the issue                                         â”‚\nâ”‚  â†’ If conflict: spawn FRESH polecat to re-implement        â”‚\nâ”‚    (never send work back to original polecat - it's gone)  â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n## What \"Recycle\" Means\n\n**Session cycling**: Normal. Claude restarts, sandbox stays, slot stays.\n\n```bash\ngt handoff  # Session cycles, polecat continues\n```\n\n**Sandbox recreation**: Repair only. Should be rare.\n\n```bash\ngt polecat repair Toast  # Emergency: recreate corrupted worktree\n```\n\nSession cycling happens constantly. Sandbox recreation should almost never happen\nduring normal operation.\n\n## Anti-Patterns\n\n### \"Idle\" Polecats (They Don't Exist)\n\n**Myth:** Polecats wait between tasks in an idle pool.\n\n**Reality:** There is no idle state. Polecats don't exist without work:\n1. Work assigned â†’ polecat spawned\n2. Work done â†’ `gt done` â†’ session exits â†’ polecat nuked\n3. There is no step 3 where they wait around\n\nIf you see a non-working polecat, it's in a **failure state**:\n\n| What you see | What it is | What went wrong |\n|--------------|------------|-----------------|\n| Session exists but not working | **Stalled** | Interrupted/crashed, never nudged |\n| Session done but didn't exit | **Zombie** | `gt done` failed during cleanup |\n\nDon't call these \"idle\" - that implies they're waiting for work. They're not.\nA stalled polecat is *supposed* to be working. A zombie is *supposed* to be dead.\n\n### Manual State Transitions\n\n**Anti-pattern:**\n```bash\ngt polecat done Toast    # DON'T: external state manipulation\ngt polecat reset Toast   # DON'T: manual lifecycle control\n```\n\n**Correct:**\n```bash\n# Polecat signals its own completion:\ngt done  # (from inside the polecat session)\n\n# Only Witness nukes polecats:\ngt polecat nuke Toast  # (from Witness, after verification)\n```\n\nPolecats manage their own session lifecycle. The Witness manages sandbox lifecycle.\nExternal manipulation bypasses verification.\n\n### Sandboxes Without Work (Stalled Polecats)\n\n**Anti-pattern:** A sandbox exists but no molecule is hooked, or the session isn't running.\n\nThis is a **stalled** polecat. It means:\n- The session crashed and wasn't nudged back to life\n- The hook was lost during a crash\n- State corruption occurred\n\nThis is NOT an \"idle\" polecat waiting for work. It's stalled - supposed to be\nworking but stopped unexpectedly.\n\n**Recovery:**\n```bash\n# From Witness:\ngt polecat nuke Toast        # Clean up the stalled polecat\ngt sling gt-abc gastown      # Respawn with fresh polecat\n```\n\n### Confusing Session with Sandbox\n\n**Anti-pattern:** Thinking session restart = losing work.\n\n```bash\n# Session ends (handoff, crash, compaction)\n# Work is NOT lost because:\n# - Git commits persist in sandbox\n# - Staged changes persist in sandbox\n# - Molecule state persists in beads\n# - Hook persists across sessions\n```\n\nThe new session picks up where the old one left off via `gt prime`.\n\n## Session Lifecycle Details\n\nSessions cycle for these reasons:\n\n| Trigger | Action | Result |\n|---------|--------|--------|\n| `gt handoff` | Voluntary | Clean cycle to fresh context |\n| Context compaction | Automatic | Forced by Claude Code |\n| Crash/timeout | Failure | Witness respawns |\n| `gt done` | Completion | Session exits, Witness takes over |\n\nAll except `gt done` result in continued work. Only `gt done` signals completion.\n\n## Witness Responsibilities\n\nThe Witness monitors polecats but does NOT:\n- Force session cycles (polecats self-manage via handoff)\n- Interrupt mid-step (unless truly stuck)\n- Nuke polecats (polecats self-nuke via `gt done`)\n\nThe Witness DOES:\n- Detect and nudge stalled polecats (sessions that stopped unexpectedly)\n- Clean up zombie polecats (sessions where `gt done` failed)\n- Respawn crashed sessions\n- Handle escalations from stuck polecats (polecats that explicitly asked for help)\n\n## Polecat Identity\n\n**Key insight:** Polecat *identity* is long-lived; only sessions and sandboxes are ephemeral.\n\nIn the HOP model, every entity has a chain (CV) that tracks:\n- What work they've done\n- Success/failure rates\n- Skills demonstrated\n- Quality metrics\n\nThe polecat *name* (Toast, Shadow, etc.) is a slot from a pool - truly ephemeral.\nBut the *agent identity* that executes as that polecat accumulates a work history.\n\n```\nPOLECAT IDENTITY (persistent)     SESSION (ephemeral)     SANDBOX (ephemeral)\nâ”œâ”€â”€ CV chain                      â”œâ”€â”€ Claude instance     â”œâ”€â”€ Git worktree\nâ”œâ”€â”€ Work history                  â”œâ”€â”€ Context window      â”œâ”€â”€ Branch\nâ”œâ”€â”€ Skills demonstrated           â””â”€â”€ Dies on handoff     â””â”€â”€ Dies on gt done\nâ””â”€â”€ Credit for work                   or gt done\n```\n\nThis distinction matters for:\n- **Attribution** - Who gets credit for the work?\n- **Skill routing** - Which agent is best for this task?\n- **Cost accounting** - Who pays for inference?\n- **Federation** - Agents having their own chains in a distributed world\n\n## Related Documentation\n\n- [Overview](../overview.md) - Role taxonomy and architecture\n- [Molecules](molecules.md) - Molecule execution and polecat workflow\n- [Propulsion Principle](propulsion-principle.md) - Why work triggers immediate execution\n","numLines":313,"startLine":1,"totalLines":313}},"sourceToolAssistantUUID":"4e98585c-acc6-43f8-b85b-6b5e4fe9a943"}
{"parentUuid":"a6e50aa1-e232-4e23-805c-272ad2168d31","isSidechain":true,"userType":"external","cwd":"/Users/csells/Code/gastownhall/website","sessionId":"dc9d694e-994e-4b73-9876-59c87b636ae6","version":"2.1.12","gitBranch":"main","agentId":"af83d1f","slug":"snappy-doodling-pudding","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_012msB5iBKn1piaN4tfQXEsE","type":"tool_result","content":"     1â†’# Installing Gas Town\n     2â†’\n     3â†’Complete setup guide for Gas Town multi-agent orchestrator.\n     4â†’\n     5â†’## Prerequisites\n     6â†’\n     7â†’### Required\n     8â†’\n     9â†’| Tool | Version | Check | Install |\n    10â†’|------|---------|-------|---------|\n    11â†’| **Go** | 1.24+ | `go version` | See [golang.org](https://go.dev/doc/install) |\n    12â†’| **Git** | 2.20+ | `git --version` | See below |\n    13â†’| **Beads** | latest | `bd version` | `go install github.com/steveyegge/beads/cmd/bd@latest` |\n    14â†’\n    15â†’### Optional (for Full Stack Mode)\n    16â†’\n    17â†’| Tool | Version | Check | Install |\n    18â†’|------|---------|-------|---------|\n    19â†’| **tmux** | 3.0+ | `tmux -V` | See below |\n    20â†’| **Claude Code** (default) | latest | `claude --version` | See [claude.ai/claude-code](https://claude.ai/claude-code) |\n    21â†’| **Codex CLI** (optional) | latest | `codex --version` | See [developers.openai.com/codex/cli](https://developers.openai.com/codex/cli) |\n    22â†’| **OpenCode CLI** (optional) | latest | `opencode --version` | See [opencode.ai](https://opencode.ai) |\n    23â†’\n    24â†’## Installing Prerequisites\n    25â†’\n    26â†’### macOS\n    27â†’\n    28â†’```bash\n    29â†’# Install Homebrew if needed\n    30â†’/bin/bash -c \"$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)\"\n    31â†’\n    32â†’# Required\n    33â†’brew install go git\n    34â†’\n    35â†’# Optional (for full stack mode)\n    36â†’brew install tmux\n    37â†’```\n    38â†’\n    39â†’### Linux (Debian/Ubuntu)\n    40â†’\n    41â†’```bash\n    42â†’# Required\n    43â†’sudo apt update\n    44â†’sudo apt install -y git\n    45â†’\n    46â†’# Install Go (apt version may be outdated, use official installer)\n    47â†’wget https://go.dev/dl/go1.24.linux-amd64.tar.gz\n    48â†’sudo rm -rf /usr/local/go && sudo tar -C /usr/local -xzf go1.24.linux-amd64.tar.gz\n    49â†’echo 'export PATH=$PATH:/usr/local/go/bin:$HOME/go/bin' >> ~/.bashrc\n    50â†’source ~/.bashrc\n    51â†’\n    52â†’# Optional (for full stack mode)\n    53â†’sudo apt install -y tmux\n    54â†’```\n    55â†’\n    56â†’### Linux (Fedora/RHEL)\n    57â†’\n    58â†’```bash\n    59â†’# Required\n    60â†’sudo dnf install -y git golang\n    61â†’\n    62â†’# Optional\n    63â†’sudo dnf install -y tmux\n    64â†’```\n    65â†’\n    66â†’### Verify Prerequisites\n    67â†’\n    68â†’```bash\n    69â†’# Check all prerequisites\n    70â†’go version        # Should show go1.24 or higher\n    71â†’git --version     # Should show 2.20 or higher\n    72â†’tmux -V           # (Optional) Should show 3.0 or higher\n    73â†’```\n    74â†’\n    75â†’## Installing Gas Town\n    76â†’\n    77â†’### Step 1: Install the Binaries\n    78â†’\n    79â†’```bash\n    80â†’# Install Gas Town CLI\n    81â†’go install github.com/steveyegge/gastown/cmd/gt@latest\n    82â†’\n    83â†’# Install Beads (issue tracker)\n    84â†’go install github.com/steveyegge/beads/cmd/bd@latest\n    85â†’\n    86â†’# Verify installation\n    87â†’gt version\n    88â†’bd version\n    89â†’```\n    90â†’\n    91â†’If `gt` is not found, ensure `$GOPATH/bin` (usually `~/go/bin`) is in your PATH:\n    92â†’\n    93â†’```bash\n    94â†’# Add to ~/.bashrc, ~/.zshrc, or equivalent\n    95â†’export PATH=\"$PATH:$HOME/go/bin\"\n    96â†’```\n    97â†’\n    98â†’### Step 2: Create Your Workspace\n    99â†’\n   100â†’```bash\n   101â†’# Create a Gas Town workspace (HQ)\n   102â†’gt install ~/gt\n   103â†’\n   104â†’# This creates:\n   105â†’#   ~/gt/\n   106â†’#   â”œâ”€â”€ CLAUDE.md          # Mayor role context\n   107â†’#   â”œâ”€â”€ mayor/             # Mayor config and state\n   108â†’#   â”œâ”€â”€ rigs/              # Project containers (initially empty)\n   109â†’#   â””â”€â”€ .beads/            # Town-level issue tracking\n   110â†’```\n   111â†’\n   112â†’### Step 3: Add a Project (Rig)\n   113â†’\n   114â†’```bash\n   115â†’# Add your first project\n   116â†’gt rig add myproject https://github.com/you/repo.git\n   117â†’\n   118â†’# This clones the repo and sets up:\n   119â†’#   ~/gt/myproject/\n   120â†’#   â”œâ”€â”€ .beads/            # Project issue tracking\n   121â†’#   â”œâ”€â”€ mayor/rig/         # Mayor's clone (canonical)\n   122â†’#   â”œâ”€â”€ refinery/rig/      # Merge queue processor\n   123â†’#   â”œâ”€â”€ witness/           # Worker monitor\n   124â†’#   â””â”€â”€ polecats/          # Worker clones (created on demand)\n   125â†’```\n   126â†’\n   127â†’### Step 4: Verify Installation\n   128â†’\n   129â†’```bash\n   130â†’cd ~/gt\n   131â†’gt doctor              # Run health checks\n   132â†’gt status              # Show workspace status\n   133â†’```\n   134â†’\n   135â†’### Step 5: Configure Agents (Optional)\n   136â†’\n   137â†’Gas Town supports built-in runtimes (`claude`, `gemini`, `codex`) plus custom agent aliases.\n   138â†’\n   139â†’```bash\n   140â†’# List available agents\n   141â†’gt config agent list\n   142â†’\n   143â†’# Create an alias (aliases can encode model/thinking flags)\n   144â†’gt config agent set codex-low \"codex --thinking low\"\n   145â†’gt config agent set claude-haiku \"claude --model haiku --dangerously-skip-permissions\"\n   146â†’\n   147â†’# Set the town default agent (used when a rig doesn't specify one)\n   148â†’gt config default-agent codex-low\n   149â†’```\n   150â†’\n   151â†’You can also override the agent per command without changing defaults:\n   152â†’\n   153â†’```bash\n   154â†’gt start --agent codex-low\n   155â†’gt sling gt-abc12 myproject --agent claude-haiku\n   156â†’```\n   157â†’\n   158â†’## Minimal Mode vs Full Stack Mode\n   159â†’\n   160â†’Gas Town supports two operational modes:\n   161â†’\n   162â†’### Minimal Mode (No Daemon)\n   163â†’\n   164â†’Run individual runtime instances manually. Gas Town only tracks state.\n   165â†’\n   166â†’```bash\n   167â†’# Create and assign work\n   168â†’gt convoy create \"Fix bugs\" gt-abc12\n   169â†’gt sling gt-abc12 myproject\n   170â†’\n   171â†’# Run runtime manually\n   172â†’cd ~/gt/myproject/polecats/<worker>\n   173â†’claude --resume          # Claude Code\n   174â†’# or: codex              # Codex CLI\n   175â†’\n   176â†’# Check progress\n   177â†’gt convoy list\n   178â†’```\n   179â†’\n   180â†’**When to use**: Testing, simple workflows, or when you prefer manual control.\n   181â†’\n   182â†’### Full Stack Mode (With Daemon)\n   183â†’\n   184â†’Agents run in tmux sessions. Daemon manages lifecycle automatically.\n   185â†’\n   186â†’```bash\n   187â†’# Start the daemon\n   188â†’gt daemon start\n   189â†’\n   190â†’# Create and assign work (workers spawn automatically)\n   191â†’gt convoy create \"Feature X\" gt-abc12 gt-def34\n   192â†’gt sling gt-abc12 myproject\n   193â†’gt sling gt-def34 myproject\n   194â†’\n   195â†’# Monitor on dashboard\n   196â†’gt convoy list\n   197â†’\n   198â†’# Attach to any agent session\n   199â†’gt mayor attach\n   200â†’gt witness attach myproject\n   201â†’```\n   202â†’\n   203â†’**When to use**: Production workflows with multiple concurrent agents.\n   204â†’\n   205â†’### Choosing Roles\n   206â†’\n   207â†’Gas Town is modular. Enable only what you need:\n   208â†’\n   209â†’| Configuration | Roles | Use Case |\n   210â†’|--------------|-------|----------|\n   211â†’| **Polecats only** | Workers | Manual spawning, no monitoring |\n   212â†’| **+ Witness** | + Monitor | Automatic lifecycle, stuck detection |\n   213â†’| **+ Refinery** | + Merge queue | MR review, code integration |\n   214â†’| **+ Mayor** | + Coordinator | Cross-project coordination |\n   215â†’\n   216â†’## Troubleshooting\n   217â†’\n   218â†’### `gt: command not found`\n   219â†’\n   220â†’Your Go bin directory is not in PATH:\n   221â†’\n   222â†’```bash\n   223â†’# Add to your shell config (~/.bashrc, ~/.zshrc)\n   224â†’export PATH=\"$PATH:$HOME/go/bin\"\n   225â†’source ~/.bashrc  # or restart terminal\n   226â†’```\n   227â†’\n   228â†’### `bd: command not found`\n   229â†’\n   230â†’Beads CLI not installed:\n   231â†’\n   232â†’```bash\n   233â†’go install github.com/steveyegge/beads/cmd/bd@latest\n   234â†’```\n   235â†’\n   236â†’### `gt doctor` shows errors\n   237â†’\n   238â†’Run with `--fix` to auto-repair common issues:\n   239â†’\n   240â†’```bash\n   241â†’gt doctor --fix\n   242â†’```\n   243â†’\n   244â†’For persistent issues, check specific errors:\n   245â†’\n   246â†’```bash\n   247â†’gt doctor --verbose\n   248â†’```\n   249â†’\n   250â†’### Daemon not starting\n   251â†’\n   252â†’Check if tmux is installed and working:\n   253â†’\n   254â†’```bash\n   255â†’tmux -V                    # Should show version\n   256â†’tmux new-session -d -s test && tmux kill-session -t test  # Quick test\n   257â†’```\n   258â†’\n   259â†’### Git authentication issues\n   260â†’\n   261â†’Ensure SSH keys or credentials are configured:\n   262â†’\n   263â†’```bash\n   264â†’# Test SSH access\n   265â†’ssh -T git@github.com\n   266â†’\n   267â†’# Or configure credential helper\n   268â†’git config --global credential.helper cache\n   269â†’```\n   270â†’\n   271â†’### Beads sync issues\n   272â†’\n   273â†’If beads aren't syncing across clones:\n   274â†’\n   275â†’```bash\n   276â†’cd ~/gt/myproject/mayor/rig\n   277â†’bd sync --status           # Check sync status\n   278â†’bd doctor                  # Run beads health check\n   279â†’```\n   280â†’\n   281â†’## Updating\n   282â†’\n   283â†’To update Gas Town and Beads:\n   284â†’\n   285â†’```bash\n   286â†’go install github.com/steveyegge/gastown/cmd/gt@latest\n   287â†’go install github.com/steveyegge/beads/cmd/bd@latest\n   288â†’gt doctor --fix            # Fix any post-update issues\n   289â†’```\n   290â†’\n   291â†’## Uninstalling\n   292â†’\n   293â†’```bash\n   294â†’# Remove binaries\n   295â†’rm $(which gt) $(which bd)\n   296â†’\n   297â†’# Remove workspace (CAUTION: deletes all work)\n   298â†’rm -rf ~/gt\n   299â†’```\n   300â†’\n   301â†’## Next Steps\n   302â†’\n   303â†’After installation:\n   304â†’\n   305â†’1. **Read the README** - Core concepts and workflows\n   306â†’2. **Try a simple workflow** - `bd create \"Test task\"` then `gt convoy create \"Test\" <bead-id>`\n   307â†’3. **Explore docs** - `docs/reference.md` for command reference\n   308â†’4. **Run doctor regularly** - `gt doctor` catches problems early\n   309â†’\n\n<system-reminder>\nWhenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.\n</system-reminder>\n"}]},"uuid":"b67a5feb-32b3-47f4-a936-fd2fc873d8e0","timestamp":"2026-01-20T16:18:20.471Z","toolUseResult":{"type":"text","file":{"filePath":"/Users/csells/Code/gastownhall/website/docs-fodder/gastown-docs/INSTALLING.md","content":"# Installing Gas Town\n\nComplete setup guide for Gas Town multi-agent orchestrator.\n\n## Prerequisites\n\n### Required\n\n| Tool | Version | Check | Install |\n|------|---------|-------|---------|\n| **Go** | 1.24+ | `go version` | See [golang.org](https://go.dev/doc/install) |\n| **Git** | 2.20+ | `git --version` | See below |\n| **Beads** | latest | `bd version` | `go install github.com/steveyegge/beads/cmd/bd@latest` |\n\n### Optional (for Full Stack Mode)\n\n| Tool | Version | Check | Install |\n|------|---------|-------|---------|\n| **tmux** | 3.0+ | `tmux -V` | See below |\n| **Claude Code** (default) | latest | `claude --version` | See [claude.ai/claude-code](https://claude.ai/claude-code) |\n| **Codex CLI** (optional) | latest | `codex --version` | See [developers.openai.com/codex/cli](https://developers.openai.com/codex/cli) |\n| **OpenCode CLI** (optional) | latest | `opencode --version` | See [opencode.ai](https://opencode.ai) |\n\n## Installing Prerequisites\n\n### macOS\n\n```bash\n# Install Homebrew if needed\n/bin/bash -c \"$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)\"\n\n# Required\nbrew install go git\n\n# Optional (for full stack mode)\nbrew install tmux\n```\n\n### Linux (Debian/Ubuntu)\n\n```bash\n# Required\nsudo apt update\nsudo apt install -y git\n\n# Install Go (apt version may be outdated, use official installer)\nwget https://go.dev/dl/go1.24.linux-amd64.tar.gz\nsudo rm -rf /usr/local/go && sudo tar -C /usr/local -xzf go1.24.linux-amd64.tar.gz\necho 'export PATH=$PATH:/usr/local/go/bin:$HOME/go/bin' >> ~/.bashrc\nsource ~/.bashrc\n\n# Optional (for full stack mode)\nsudo apt install -y tmux\n```\n\n### Linux (Fedora/RHEL)\n\n```bash\n# Required\nsudo dnf install -y git golang\n\n# Optional\nsudo dnf install -y tmux\n```\n\n### Verify Prerequisites\n\n```bash\n# Check all prerequisites\ngo version        # Should show go1.24 or higher\ngit --version     # Should show 2.20 or higher\ntmux -V           # (Optional) Should show 3.0 or higher\n```\n\n## Installing Gas Town\n\n### Step 1: Install the Binaries\n\n```bash\n# Install Gas Town CLI\ngo install github.com/steveyegge/gastown/cmd/gt@latest\n\n# Install Beads (issue tracker)\ngo install github.com/steveyegge/beads/cmd/bd@latest\n\n# Verify installation\ngt version\nbd version\n```\n\nIf `gt` is not found, ensure `$GOPATH/bin` (usually `~/go/bin`) is in your PATH:\n\n```bash\n# Add to ~/.bashrc, ~/.zshrc, or equivalent\nexport PATH=\"$PATH:$HOME/go/bin\"\n```\n\n### Step 2: Create Your Workspace\n\n```bash\n# Create a Gas Town workspace (HQ)\ngt install ~/gt\n\n# This creates:\n#   ~/gt/\n#   â”œâ”€â”€ CLAUDE.md          # Mayor role context\n#   â”œâ”€â”€ mayor/             # Mayor config and state\n#   â”œâ”€â”€ rigs/              # Project containers (initially empty)\n#   â””â”€â”€ .beads/            # Town-level issue tracking\n```\n\n### Step 3: Add a Project (Rig)\n\n```bash\n# Add your first project\ngt rig add myproject https://github.com/you/repo.git\n\n# This clones the repo and sets up:\n#   ~/gt/myproject/\n#   â”œâ”€â”€ .beads/            # Project issue tracking\n#   â”œâ”€â”€ mayor/rig/         # Mayor's clone (canonical)\n#   â”œâ”€â”€ refinery/rig/      # Merge queue processor\n#   â”œâ”€â”€ witness/           # Worker monitor\n#   â””â”€â”€ polecats/          # Worker clones (created on demand)\n```\n\n### Step 4: Verify Installation\n\n```bash\ncd ~/gt\ngt doctor              # Run health checks\ngt status              # Show workspace status\n```\n\n### Step 5: Configure Agents (Optional)\n\nGas Town supports built-in runtimes (`claude`, `gemini`, `codex`) plus custom agent aliases.\n\n```bash\n# List available agents\ngt config agent list\n\n# Create an alias (aliases can encode model/thinking flags)\ngt config agent set codex-low \"codex --thinking low\"\ngt config agent set claude-haiku \"claude --model haiku --dangerously-skip-permissions\"\n\n# Set the town default agent (used when a rig doesn't specify one)\ngt config default-agent codex-low\n```\n\nYou can also override the agent per command without changing defaults:\n\n```bash\ngt start --agent codex-low\ngt sling gt-abc12 myproject --agent claude-haiku\n```\n\n## Minimal Mode vs Full Stack Mode\n\nGas Town supports two operational modes:\n\n### Minimal Mode (No Daemon)\n\nRun individual runtime instances manually. Gas Town only tracks state.\n\n```bash\n# Create and assign work\ngt convoy create \"Fix bugs\" gt-abc12\ngt sling gt-abc12 myproject\n\n# Run runtime manually\ncd ~/gt/myproject/polecats/<worker>\nclaude --resume          # Claude Code\n# or: codex              # Codex CLI\n\n# Check progress\ngt convoy list\n```\n\n**When to use**: Testing, simple workflows, or when you prefer manual control.\n\n### Full Stack Mode (With Daemon)\n\nAgents run in tmux sessions. Daemon manages lifecycle automatically.\n\n```bash\n# Start the daemon\ngt daemon start\n\n# Create and assign work (workers spawn automatically)\ngt convoy create \"Feature X\" gt-abc12 gt-def34\ngt sling gt-abc12 myproject\ngt sling gt-def34 myproject\n\n# Monitor on dashboard\ngt convoy list\n\n# Attach to any agent session\ngt mayor attach\ngt witness attach myproject\n```\n\n**When to use**: Production workflows with multiple concurrent agents.\n\n### Choosing Roles\n\nGas Town is modular. Enable only what you need:\n\n| Configuration | Roles | Use Case |\n|--------------|-------|----------|\n| **Polecats only** | Workers | Manual spawning, no monitoring |\n| **+ Witness** | + Monitor | Automatic lifecycle, stuck detection |\n| **+ Refinery** | + Merge queue | MR review, code integration |\n| **+ Mayor** | + Coordinator | Cross-project coordination |\n\n## Troubleshooting\n\n### `gt: command not found`\n\nYour Go bin directory is not in PATH:\n\n```bash\n# Add to your shell config (~/.bashrc, ~/.zshrc)\nexport PATH=\"$PATH:$HOME/go/bin\"\nsource ~/.bashrc  # or restart terminal\n```\n\n### `bd: command not found`\n\nBeads CLI not installed:\n\n```bash\ngo install github.com/steveyegge/beads/cmd/bd@latest\n```\n\n### `gt doctor` shows errors\n\nRun with `--fix` to auto-repair common issues:\n\n```bash\ngt doctor --fix\n```\n\nFor persistent issues, check specific errors:\n\n```bash\ngt doctor --verbose\n```\n\n### Daemon not starting\n\nCheck if tmux is installed and working:\n\n```bash\ntmux -V                    # Should show version\ntmux new-session -d -s test && tmux kill-session -t test  # Quick test\n```\n\n### Git authentication issues\n\nEnsure SSH keys or credentials are configured:\n\n```bash\n# Test SSH access\nssh -T git@github.com\n\n# Or configure credential helper\ngit config --global credential.helper cache\n```\n\n### Beads sync issues\n\nIf beads aren't syncing across clones:\n\n```bash\ncd ~/gt/myproject/mayor/rig\nbd sync --status           # Check sync status\nbd doctor                  # Run beads health check\n```\n\n## Updating\n\nTo update Gas Town and Beads:\n\n```bash\ngo install github.com/steveyegge/gastown/cmd/gt@latest\ngo install github.com/steveyegge/beads/cmd/bd@latest\ngt doctor --fix            # Fix any post-update issues\n```\n\n## Uninstalling\n\n```bash\n# Remove binaries\nrm $(which gt) $(which bd)\n\n# Remove workspace (CAUTION: deletes all work)\nrm -rf ~/gt\n```\n\n## Next Steps\n\nAfter installation:\n\n1. **Read the README** - Core concepts and workflows\n2. **Try a simple workflow** - `bd create \"Test task\"` then `gt convoy create \"Test\" <bead-id>`\n3. **Explore docs** - `docs/reference.md` for command reference\n4. **Run doctor regularly** - `gt doctor` catches problems early\n","numLines":309,"startLine":1,"totalLines":309}},"sourceToolAssistantUUID":"a6e50aa1-e232-4e23-805c-272ad2168d31"}
{"parentUuid":"b67a5feb-32b3-47f4-a936-fd2fc873d8e0","isSidechain":true,"userType":"external","cwd":"/Users/csells/Code/gastownhall/website","sessionId":"dc9d694e-994e-4b73-9876-59c87b636ae6","version":"2.1.12","gitBranch":"main","agentId":"af83d1f","slug":"snappy-doodling-pudding","message":{"model":"claude-opus-4-5-20251101","id":"msg_01UQnQTFWSBLCuRWoJJjuxHv","type":"message","role":"assistant","content":[{"type":"text","text":"Now let me read a few of the blog posts to understand what content should be featured on the website."}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":0,"cache_creation_input_tokens":13884,"cache_read_input_tokens":35878,"cache_creation":{"ephemeral_5m_input_tokens":13884,"ephemeral_1h_input_tokens":0},"output_tokens":4,"service_tier":"standard"}},"requestId":"req_011CXJw2f5TEeRgcG5Luc8eK","type":"assistant","uuid":"636d973a-b441-4c89-a5e9-fee7af10e778","timestamp":"2026-01-20T16:18:24.796Z"}
{"parentUuid":"636d973a-b441-4c89-a5e9-fee7af10e778","isSidechain":true,"userType":"external","cwd":"/Users/csells/Code/gastownhall/website","sessionId":"dc9d694e-994e-4b73-9876-59c87b636ae6","version":"2.1.12","gitBranch":"main","agentId":"af83d1f","slug":"snappy-doodling-pudding","message":{"model":"claude-opus-4-5-20251101","id":"msg_01UQnQTFWSBLCuRWoJJjuxHv","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01D32A8y2dhthA96mHdqsrfS","name":"Read","input":{"file_path":"/Users/csells/Code/gastownhall/website/docs-fodder/steve-blog-posts/Welcome to Gas Town.md"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":0,"cache_creation_input_tokens":13884,"cache_read_input_tokens":35878,"cache_creation":{"ephemeral_5m_input_tokens":13884,"ephemeral_1h_input_tokens":0},"output_tokens":4,"service_tier":"standard"}},"requestId":"req_011CXJw2f5TEeRgcG5Luc8eK","type":"assistant","uuid":"992f2c5a-1833-44af-8833-2a92e2d9b322","timestamp":"2026-01-20T16:18:25.998Z"}
{"parentUuid":"992f2c5a-1833-44af-8833-2a92e2d9b322","isSidechain":true,"userType":"external","cwd":"/Users/csells/Code/gastownhall/website","sessionId":"dc9d694e-994e-4b73-9876-59c87b636ae6","version":"2.1.12","gitBranch":"main","agentId":"af83d1f","slug":"snappy-doodling-pudding","message":{"model":"claude-opus-4-5-20251101","id":"msg_01UQnQTFWSBLCuRWoJJjuxHv","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01VtmPCc2Q3BNBCyMZGtHcUV","name":"Read","input":{"file_path":"/Users/csells/Code/gastownhall/website/docs-fodder/steve-blog-posts/Gas Town Emergency User Manual.md"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":0,"cache_creation_input_tokens":13884,"cache_read_input_tokens":35878,"cache_creation":{"ephemeral_5m_input_tokens":13884,"ephemeral_1h_input_tokens":0},"output_tokens":4,"service_tier":"standard"}},"requestId":"req_011CXJw2f5TEeRgcG5Luc8eK","type":"assistant","uuid":"5bf13b76-2020-4f07-b347-01af062cd886","timestamp":"2026-01-20T16:18:27.143Z"}
{"parentUuid":"5bf13b76-2020-4f07-b347-01af062cd886","isSidechain":true,"userType":"external","cwd":"/Users/csells/Code/gastownhall/website","sessionId":"dc9d694e-994e-4b73-9876-59c87b636ae6","version":"2.1.12","gitBranch":"main","agentId":"af83d1f","slug":"snappy-doodling-pudding","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01VtmPCc2Q3BNBCyMZGtHcUV","type":"tool_result","content":"     1â†’Gas Town Emergency User Manual\n     2â†’==============================\n     3â†’\n     4â†’[![Steve Yegge](https://miro.medium.com/v2/resize:fill:64:64/1*8Ae2b9dv-sQtme8C4_sjhA.jpeg)](https://medium.com/?source=post_page---byline--cf0e4556d74b---------------------------------------)\n     5â†’\n     6â†’[Steve Yegge](https://medium.com/?source=post_page---byline--cf0e4556d74b---------------------------------------)\n     7â†’\n     8â†’13 min read\n     9â†’\n    10â†’Â·\n    11â†’\n    12â†’5 days ago\n    13â†’\n    14â†’[nameless link](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2Fcf0e4556d74b&operation=register&redirect=https%3A%2F%2Fsteve-yegge.medium.com%2Fgas-town-emergency-user-manual-cf0e4556d74b&user=Steve+Yegge&userId=c1ec701babb7&source=---header_actions--cf0e4556d74b---------------------clap_footer------------------)\n    15â†’\n    16â†’--\n    17â†’\n    18â†’8\n    19â†’\n    20â†’[nameless link](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fcf0e4556d74b&operation=register&redirect=https%3A%2F%2Fsteve-yegge.medium.com%2Fgas-town-emergency-user-manual-cf0e4556d74b&source=---header_actions--cf0e4556d74b---------------------bookmark_footer------------------)\n    21â†’\n    22â†’Listen\n    23â†’\n    24â†’Share\n    25â†’\n    26â†’Itâ€™s been a busy 12 days since I launched Gas Town. ï¸Iâ€™ve merged over 100 PRs from nearly 50 contributors, adding 44k lines of code that no human has looked at. This has grown Gas Townâ€™s total size to 189k lines of Go code since its first commit on Dec 15th, which is now 2684 commits ago. Itâ€™s accelerating; I carefully reviewed and merged 25 PRs today alone on Gas Town, and another 17 on Beads. Another dozen or so I sent back to the contributors for changes.\n    27â†’\n    28â†’How can I keep up this maintainer pace without breaking a sweat? Well Iâ€™m glad you asked, Pilgrim. Iâ€™m using Gas Town, thatâ€™s how. Keep those PRs coming. Iâ€™ll show you how I keep up with them using PR Sheriffs.\n    29â†’\n    30â†’![Gas Town works all night while you sleep](https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rC7NX4lGtoKT17gs32qo0g.jpeg)\n    31â†’\n    32â†’I see people have been breaking the first two rules of Gas Town. Youâ€™re not supposed to be using it. But I see early adopters cheering drunkenly on LinkedIn because Gas Town drained their bank account and did 10 projects overnight. You know, people used to get mad when Devin did this. But I get it. Once you get hooked on Gas Town, itâ€™s hard to get mad. Itâ€™s just so damn cool. So Iâ€™m publishing this guide to give a _few_ pointers to the intrepid.\n    33â†’\n    34â†’My apologies to the BAGS crowd, you know who you are â€” you rock, but unfortunately Iâ€™ve been drowning in the Gas Town Murder Mystery, plus a deluge of community PRs, not to mention fending off money _other_ people are trying to throw at me. So Iâ€™ve been too overwhelmed to go find the money I hear youâ€™ve been throwing at me. But I will come visit BAGS ASAP my MFs.\n    35â†’\n    36â†’Gas Town version 0.3.0 will be out this week. This will be a comparatively stable version. Weâ€™ve gone through all sorts of crazy issues since launch. There was the Gas Town Serial Killer Murder Mystery that went on like a game of Clue for close to a week. Spoiler: The Deacon did it. It was cleaning up â€œstaleâ€ workers that werenâ€™t stale and murdering entire crews mid-task. So yeah there was that. And weâ€™ve had workers stalling out, getting lost, orphaned, confused about who they are. And no shortage of heresies: compelling but wrong beliefs about the architecture that spread invisibly. Heresies happen regularly when youâ€™re coding blind. You have to sniff them out and eradicate them, often multiple times.\n    37â†’\n    38â†’Anyway. Itâ€™s all working more smoothly now. Gas Townâ€™s User Safety Index has been upgraded from â€œrandomly rips userâ€™s face offâ€ to â€œrandomly kicks user in groin,â€ which I think youâ€™ll agree is _still_ a good reason not to use it yet, no matter how much fun everyone seems to be having with it.\n    39â†’\n    40â†’![Gas Town stabilizes quickly through community contributions](https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0AvTjOPUGl0XFP51PnKWLA.jpeg)\n    41â†’\n    42â†’With that, here are some tips on how I use Gas Town. Iâ€™ll group them into three developer loops. The [Vibe Coding](https://www.amazon.com/Vibe-Coding-Building-Production-Grade-Software/dp/1966280025) book I wrote with Gene Kim, just published in October, characterizes the agentic developer workflow as three nested loops: **Outer Loop** (days to weeks), **Middle Loop** (hours to days), and **Inner Loop** (seconds to minutes). They arenâ€™t strictly isolated and thereâ€™s some overlap, because some tasks happen at cadences that arenâ€™t time-based, but pressure-based. But itâ€™s a reasonably good mental model. These loops still hold, and Gas Town adds some new steps to each one.\n    43â†’\n    44â†’**Dev Outer Loop**\n    45â†’------------------\n    46â†’\n    47â†’*   **Upgrade every day** if youâ€™re really going to try to use Gas Town. You shouldnâ€™t be using it now, unless youâ€™re either experimenting or youâ€™re contributing. Otherwise itâ€™s too much of a headache. Give it a few weeks.\n    48â†’*   **Learn tmux** â€” itâ€™s a little tricky at first, but incredibly powerful. Try to learn a new keybinding or feature each day. Familiarize yourself with how copying text out of the terminal works. Ask your agent how you can customize tmux, and then have it customize it for you. tmux is your friend.\n    49â†’*   **Bring your own workflow**. Gas Town doesnâ€™t force any particular workflow, any more than an IDE does. Do most of your talking to the Mayor until youâ€™re comfortable with it. But use the workers however you feel comfortable. Mostly itâ€™s asking them to file beads, and then asking them to implement them â€” all variations of that basic theme. Iâ€™ll show some of my workflows below, but they change just about every week.\n    50â†’\n    51â†’The tmux tip is huge. Itâ€™s a small commitment with a big payoff.\n    52â†’\n    53â†’![tmux lets you talk to every worker at once](https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BSopHKuuW4PDVr1jBlNtMQ.jpeg)\n    54â†’\n    55â†’Dev Middle Loop\n    56â†’---------------\n    57â†’\n    58â†’*   **You technically only need the Mayor.** Running with just the Mayor is a good tutorial/intro to Gas Town. I run in Mayor-only mode from time to time. The Mayor can file and fix issues itself, or you can ask it to sling work to polecats. Even alone, it still gets all the benefits of GUPP, MEOW, etc. Use `gt may at` from your town root to attach to the Mayor. Your two main entry points to Gas Town are `gt may at` and `gt crew at`.\n    59â†’*   **You can use Polecats without the Refinery** and even without the Witness or Deacon. Just tell the Mayor to shut down the rig and sling work to the polecats with the message that they are to merge to main directly. Or the polecats can submit MRs and then the Mayor can merge them manually. Itâ€™s really up to you. The Refineries are useful if you have done a LOT of up-front specification work, and you have huge piles of Beads to churn through with long convoys.\n    60â†’*   **Itâ€™s OK not to swarm all the time.** Sometimes you will be stuck on some serial bottleneck, and youâ€™re only using one or two workers at a time, with all the others paused. For instance, you might be getting ready to restart your entire town, for a version upgrade, and you want to land everyoneâ€™s work first and clean all the sandboxes. Or maybe you need to roll out a schema change before everyone continues. Itâ€™s totally normal to be bottlenecked on just one or two workers at a time.\n    61â†’*   **Run regular town cleanups**. You can do this with any of your crew, it doesnâ€™t need to be the Mayor. Have a crew member go through and clear out stale beads, workers, processes, untracked files, etc. Anything you do often, you can make a plugin that the Deacon will run on its patrol.\n    62â†’\n    63â†’![Vibe Coding with Gas Town: The Three Cadences](https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x8-gpH_9UrFbr0bRibD91A.jpeg)\n    64â†’\n    65â†’Dev Inner Loop\n    66â†’--------------\n    67â†’\n    68â†’*   **Sling swarm work in Convoys**. Polecats thrive on well-defined, fully-specâ€™ed beads epics. Doing it in convoys allows you to track your completed features and high-level work items in the dashboard. Convoys will soon be completely automated, but you sometimes have to tell the Mayor (or whoever is kicking off a convoy) which work to include in the convoy. You can easily merge and update convoys as they run, however, by asking any agent to do it.\n    69â†’*   **Donâ€™t watch your agents work**. Make sure they have their marching orders, and let them do their thing. But. When you see that an agent is finished working, stop everything, ignore everyone else, and read what it has to say. Scroll back and make sure you understand what it did and what itâ€™s saying. Then act on it. You can go in any order you like, but at some point you have to act on each agentâ€™s response or risk losing work. Spend your time reading agent responses and giving them direction â€” not watching them work.\n    70â†’*   **Use** `gt handoff` **liberally** **after every task, in every worker**. Only let sessions go long if they need to accumulate important context for a big design or decision. Polecats take this philosophy to the extreme, and self-destruct after they submit their MR or finish their task. For all other workers, there are several ways to hand off, including saying â€œletâ€™s hand offâ€, optionally with instructions (expensive but very flexible), run `/handoff` (expensive and inflexible), or shell out to run `!gt handoff` to ask Gas Town to do it mechanically (no cost). The worker will be spun up on a new shift, preserving the tmux session.\n    71â†’\n    72â†’Finally, â€œ**Work with your Crew**â€ is the biggest tip of all, so itâ€™s getting its own section. Your Crew are your named, long-lived workers on each project rig. Theyâ€™re your design team, and they create guzzoline for the swarms.\n    73â†’\n    74â†’**Working with Crew**\n    75â†’---------------------\n    76â†’\n    77â†’Polecats are ephemeral and unsupervised workers. When you have the Mayor `gt sling` work to a rig, a polecat will pick it up. They complete their work and submit MRs without human intervention. (Though, polecats can also escalate work, when it needs human attention.)\n    78â†’\n    79â†’Polecats are best for well-defined, well-specified work. You should feed them Beads epics that have been thoroughly decomposed and vetted multiple times for suitability for polecats. They shouldnâ€™t have to make decisions.\n    80â†’\n    81â†’But how do you get those big, well-defined epics? Thatâ€™s where the Crew comes in. Your Crew are named, long-lived agents who work on your Rigs. You can see here a picture of my desktop running Gas Town in a very typical configuration.\n    82â†’\n    83â†’*   I have the Mayor in a MacOS Terminal window in the center, in a tmux session that says â€œMayorâ€ at the bottom. The status bar shows rig statuses and other metadata.\n    84â†’*   The left side is my Gas Town rig workers: jack, joe, max, gus, george, dennis. Of a possible six, I have five active at the moment. If I ever want to add more, Iâ€™ll just add more with `gt crew add gastown tommynorris` or whatever, and then Iâ€™ll have seven. They donâ€™t all need to be active at once.\n    85â†’*   The right side is my Beads rig, which is gradually shifting to Lord of the Rings names, but still has some Jane Austen and miscellaneous. You can easily `gt crew remove <rig> <name>` to remove their repo clone, and then create another crew member with a different name. I have all six active on the right side at the moment.\n    86â†’\n    87â†’In this setup, the Mayor is about to kick off a Convoy, so Iâ€™ll have a peak of about 15â€“16 workers going. I could get aggressive and kick off multiple convoys, but Iâ€™m being a bit cautious until I know the murder spree is over.\n    88â†’\n    89â†’When v0.3.0 launches Iâ€™ll be pretty certain that class of bugs is solved. Right now itâ€™s looking pretty good.\n    90â†’\n    91â†’![Gas Town crew, Mayor, and Beads Crew tmux sessions](https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NEgEYkSy3-_o5lTJR8fC4Q.png)\n    92â†’\n    93â†’Your Personal Concierges\n    94â†’------------------------\n    95â†’\n    96â†’I use the Crew for any sort of thought-intensive work, including design work, reviewing contributor PRs, creating implementation plans, and sometimes doing specific code reviews.\n    97â†’\n    98â†’The crew for a rig are on a tmux cycle group. So the left-side (blue) cycles through Gas Town crew, and the right side (green) cycles through Beads crew.\n    99â†’\n   100â†’I believe this is the secret-weapon â€œsecond workflowâ€ of Gas Town. The main workflow is talking to the Mayor and having it file beads and sling them to polecats as convoys. And thatâ€™s great for well-defined work. But cycling through your crew lets you have richer, more hands-on discussions with your agents.\n   101â†’\n   102â†’I started life with about 3 crew per rig, but Iâ€™ve worked my way up to 7â€“8 crew per rig. You can add new ones with `gt crew add` but I just ask some other worker to do it for me. I just pick a theme for each rigâ€™s crew names and then choose the names myself. Having a theme helps you identify which rig theyâ€™re from at a glance.\n   103â†’\n   104â†’Before I start farming work to a crew, I make sure theyâ€™re all reset: no hook, no mail, clean sandbox, fresh session. You can do this with an announcement, but I usually just tell one of the crew members to get all the crew ready. Give them a few minutes to take care of that; work on other stuff while you wait.\n   105â†’\n   106â†’![How I use Gas Town: Rig Cycling and Polecat Slinging](https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_nRKWon2XOtpRpeph0gkRg.jpeg)\n   107â†’\n   108â†’When theyâ€™re all settled, Iâ€™ll go through them all in order, in a big loop.\n   109â†’\n   110â†’*   Give each crew member a bug, PR, or GHI to tackle. Or, give it a feature to design or a problem to solve. But give it the work, and then _leave it alone_ to do that work.\n   111â†’*   Cycle to the next or previous crew member with `C-b n` or `C-b p` and give them a task as well. You can use `gt ready` to get a town-level view of ready work, and choose one item to hand to each crew member.\n   112â†’*   Do this until every crew member is spinning, working on some task you gave them. If you want to be paranoid, `gt sling` the task to them (or have them sling it to themself or another crew) to hook it so they will continue working on it after a crash.\n   113â†’\n   114â†’With one rig fully spinning, I go to my next Rig (Beads, in this case) and start the exact same loop. Go through each crew, give them a meaty task, and let them work.\n   115â†’\n   116â†’Then we get to the fun part. You get to see where all your slot machines landed.\n   117â†’\n   118â†’As youâ€™re cycling through your crews, you will see some still working, and others will begin finishing. Some of them will finish simple stuff and you just `gt handoff` to prep them for more work. Others will have questions, or complex summaries, and youâ€™ll need to reserve some time to read what theyâ€™ve written and act on it.\n   119â†’\n   120â†’I find this is the most satisfying part of the workflow. Itâ€™s like youâ€™re Jeff Bezos and your team is presenting results to you, one at a time. You let some merge, send others back to the drawing board, and repurpose still others for random whims. This is the part of the workflow where your project direction unfolds.\n   121â†’\n   122â†’**Crew Sheriffs**\n   123â†’-----------------\n   124â†’\n   125â†’![PR Sheriff: permanent standing orders for a designated Crew member](https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dimvNqeBdA6PeGeoIHIUAw.jpeg)\n   126â†’\n   127â†’One last Crew tip: I have a new ad-hoc role that Iâ€™ve been using for the past week, called the â€œPR Sheriff.â€ One of my Beads crew has a permanent hook: `bd-4f43s: PR Sheriff Standing Orders`. On every session startup, the sheriff checks open PRs and divides them into easy wins and those needing human review, then slings the easy wins to other crew for merging and cleanup.\n   128â†’\n   129â†’The amazing thing about this is that every time I boot up my Beads crew, they automatically go merge another 5 or so PRs, and flag a couple more for me to review with them. It keeps them busy for a few minutes every time I start up the town, while Iâ€™m doing other stuff. Iâ€™ve now got a sheriff set up over on the Gas Town rig as well.\n   130â†’\n   131â†’The PR Sheriff bead gets accidentally unhooked often enough that Iâ€™ve just reassigned it a new id, `bd-pr-sheriff`, making it easier for me to remember what itâ€™s called when I need to tell the worker to re-pin it (or reference it when talking to a different worker.)\n   132â†’\n   133â†’Tending the Invisible Garden\n   134â†’----------------------------\n   135â†’\n   136â†’When you work with Gas Town, you donâ€™t usually have time to inspect the code youâ€™re creating. Thatâ€™s not your role. But you need to make sure the code meets your quality bar. How do you ensure your garden is healthy if you canâ€™t see it?\n   137â†’\n   138â†’The answer: **regular code review sweeps, followed by bug-fix sweeps** that fix the issues filed during the code-review sweeps. Gas Town excels at both of these. It can generate tons of work with a swarm (filing Beads as it finds problems) and then crank through tons of work with another swarm. You just keep doing this until the code reviews are just nitpicking, or the agents say the code is ready to ship. Do some of this every day, and hope that most of the time you donâ€™t find anything bad. The only way to be sure is to do it all the time.\n   139â†’\n   140â†’![Tending the Invisible Garden of Vibe Coding](https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b_FatkwLZMoy6ZaBAbOm5g.jpeg)\n   141â†’\n   142â†’Your garden can get diseases. I mentioned â€œheresiesâ€ above. Agents are very approximate workers and they like to guess at stuff. They will often make _wrong_ guesses about how your system is supposed to work. If that wrong guess makes it into the code, sneaking through the review process, then it becomes enshrined and other agents may notice it and propagate the heresy in their own work.\n   143â†’\n   144â†’â€œIdle polecatsâ€ is an example of a heresy that plagues Gas Town. There is no such thing as an idle polecat; itâ€™s not a pool, and they vanish when their work is done. But polecats do have long-term identities, so itâ€™s more like they are clocking out and leaving the building between jobs, which is harder for agents to wrap their heads around. So â€œidle polecatsâ€ make it back into the code base, comments, and docs all the time.\n   145â†’\n   146â†’Iâ€™ve found the most helpful way to rid yourself of persistent heresies is to capture your guiding principles in the agent priming (onboarding). Which means you have to come up with some guiding principles in the first place.\n   147â†’\n   148â†’Your core principles or axioms will be different for every project youâ€™re working on. But the more coverage you can get with them, the more classes of heresy you can avoid or easily correct simply by pointing at the principle they violate. Gas Town core principles include things like Zero Framework Cognition (shared with Beads), which Iâ€™ve written about, GUPP, MEOW, Discovery over Tracking, Beads as the Universal Data Plane, and so on. All of these help me stamp out heresies that try to creep into my code.\n   149â†’\n   150â†’Videos Coming Soon\n   151â†’------------------\n   152â†’\n   153â†’A lot of this stuff you can only really show with a video. Iâ€™ll get some put together ASAP.\n   154â†’\n   155â†’In the meantime, thanks to everyone whoâ€™s been messing with it despite knowing it will rip their faces off. It those faceless early adopters who will help us turn it into a real product. Hats off you all!\n   156â†’\n   157â†’![Thanks to Gas Town Early Adopters!](https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gCC6N2OBNLXy01v8q_7efA.jpeg)\n\n<system-reminder>\nWhenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.\n</system-reminder>\n"}]},"uuid":"1e7ac8c0-7907-4a10-95f0-556a0d4f36e6","timestamp":"2026-01-20T16:18:29.659Z","toolUseResult":{"type":"text","file":{"filePath":"/Users/csells/Code/gastownhall/website/docs-fodder/steve-blog-posts/Gas Town Emergency User Manual.md","content":"Gas Town Emergency User Manual\n==============================\n\n[![Steve Yegge](https://miro.medium.com/v2/resize:fill:64:64/1*8Ae2b9dv-sQtme8C4_sjhA.jpeg)](https://medium.com/?source=post_page---byline--cf0e4556d74b---------------------------------------)\n\n[Steve Yegge](https://medium.com/?source=post_page---byline--cf0e4556d74b---------------------------------------)\n\n13 min read\n\nÂ·\n\n5 days ago\n\n[nameless link](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2Fcf0e4556d74b&operation=register&redirect=https%3A%2F%2Fsteve-yegge.medium.com%2Fgas-town-emergency-user-manual-cf0e4556d74b&user=Steve+Yegge&userId=c1ec701babb7&source=---header_actions--cf0e4556d74b---------------------clap_footer------------------)\n\n--\n\n8\n\n[nameless link](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fcf0e4556d74b&operation=register&redirect=https%3A%2F%2Fsteve-yegge.medium.com%2Fgas-town-emergency-user-manual-cf0e4556d74b&source=---header_actions--cf0e4556d74b---------------------bookmark_footer------------------)\n\nListen\n\nShare\n\nItâ€™s been a busy 12 days since I launched Gas Town. ï¸Iâ€™ve merged over 100 PRs from nearly 50 contributors, adding 44k lines of code that no human has looked at. This has grown Gas Townâ€™s total size to 189k lines of Go code since its first commit on Dec 15th, which is now 2684 commits ago. Itâ€™s accelerating; I carefully reviewed and merged 25 PRs today alone on Gas Town, and another 17 on Beads. Another dozen or so I sent back to the contributors for changes.\n\nHow can I keep up this maintainer pace without breaking a sweat? Well Iâ€™m glad you asked, Pilgrim. Iâ€™m using Gas Town, thatâ€™s how. Keep those PRs coming. Iâ€™ll show you how I keep up with them using PR Sheriffs.\n\n![Gas Town works all night while you sleep](https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rC7NX4lGtoKT17gs32qo0g.jpeg)\n\nI see people have been breaking the first two rules of Gas Town. Youâ€™re not supposed to be using it. But I see early adopters cheering drunkenly on LinkedIn because Gas Town drained their bank account and did 10 projects overnight. You know, people used to get mad when Devin did this. But I get it. Once you get hooked on Gas Town, itâ€™s hard to get mad. Itâ€™s just so damn cool. So Iâ€™m publishing this guide to give a _few_ pointers to the intrepid.\n\nMy apologies to the BAGS crowd, you know who you are â€” you rock, but unfortunately Iâ€™ve been drowning in the Gas Town Murder Mystery, plus a deluge of community PRs, not to mention fending off money _other_ people are trying to throw at me. So Iâ€™ve been too overwhelmed to go find the money I hear youâ€™ve been throwing at me. But I will come visit BAGS ASAP my MFs.\n\nGas Town version 0.3.0 will be out this week. This will be a comparatively stable version. Weâ€™ve gone through all sorts of crazy issues since launch. There was the Gas Town Serial Killer Murder Mystery that went on like a game of Clue for close to a week. Spoiler: The Deacon did it. It was cleaning up â€œstaleâ€ workers that werenâ€™t stale and murdering entire crews mid-task. So yeah there was that. And weâ€™ve had workers stalling out, getting lost, orphaned, confused about who they are. And no shortage of heresies: compelling but wrong beliefs about the architecture that spread invisibly. Heresies happen regularly when youâ€™re coding blind. You have to sniff them out and eradicate them, often multiple times.\n\nAnyway. Itâ€™s all working more smoothly now. Gas Townâ€™s User Safety Index has been upgraded from â€œrandomly rips userâ€™s face offâ€ to â€œrandomly kicks user in groin,â€ which I think youâ€™ll agree is _still_ a good reason not to use it yet, no matter how much fun everyone seems to be having with it.\n\n![Gas Town stabilizes quickly through community contributions](https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0AvTjOPUGl0XFP51PnKWLA.jpeg)\n\nWith that, here are some tips on how I use Gas Town. Iâ€™ll group them into three developer loops. The [Vibe Coding](https://www.amazon.com/Vibe-Coding-Building-Production-Grade-Software/dp/1966280025) book I wrote with Gene Kim, just published in October, characterizes the agentic developer workflow as three nested loops: **Outer Loop** (days to weeks), **Middle Loop** (hours to days), and **Inner Loop** (seconds to minutes). They arenâ€™t strictly isolated and thereâ€™s some overlap, because some tasks happen at cadences that arenâ€™t time-based, but pressure-based. But itâ€™s a reasonably good mental model. These loops still hold, and Gas Town adds some new steps to each one.\n\n**Dev Outer Loop**\n------------------\n\n*   **Upgrade every day** if youâ€™re really going to try to use Gas Town. You shouldnâ€™t be using it now, unless youâ€™re either experimenting or youâ€™re contributing. Otherwise itâ€™s too much of a headache. Give it a few weeks.\n*   **Learn tmux** â€” itâ€™s a little tricky at first, but incredibly powerful. Try to learn a new keybinding or feature each day. Familiarize yourself with how copying text out of the terminal works. Ask your agent how you can customize tmux, and then have it customize it for you. tmux is your friend.\n*   **Bring your own workflow**. Gas Town doesnâ€™t force any particular workflow, any more than an IDE does. Do most of your talking to the Mayor until youâ€™re comfortable with it. But use the workers however you feel comfortable. Mostly itâ€™s asking them to file beads, and then asking them to implement them â€” all variations of that basic theme. Iâ€™ll show some of my workflows below, but they change just about every week.\n\nThe tmux tip is huge. Itâ€™s a small commitment with a big payoff.\n\n![tmux lets you talk to every worker at once](https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BSopHKuuW4PDVr1jBlNtMQ.jpeg)\n\nDev Middle Loop\n---------------\n\n*   **You technically only need the Mayor.** Running with just the Mayor is a good tutorial/intro to Gas Town. I run in Mayor-only mode from time to time. The Mayor can file and fix issues itself, or you can ask it to sling work to polecats. Even alone, it still gets all the benefits of GUPP, MEOW, etc. Use `gt may at` from your town root to attach to the Mayor. Your two main entry points to Gas Town are `gt may at` and `gt crew at`.\n*   **You can use Polecats without the Refinery** and even without the Witness or Deacon. Just tell the Mayor to shut down the rig and sling work to the polecats with the message that they are to merge to main directly. Or the polecats can submit MRs and then the Mayor can merge them manually. Itâ€™s really up to you. The Refineries are useful if you have done a LOT of up-front specification work, and you have huge piles of Beads to churn through with long convoys.\n*   **Itâ€™s OK not to swarm all the time.** Sometimes you will be stuck on some serial bottleneck, and youâ€™re only using one or two workers at a time, with all the others paused. For instance, you might be getting ready to restart your entire town, for a version upgrade, and you want to land everyoneâ€™s work first and clean all the sandboxes. Or maybe you need to roll out a schema change before everyone continues. Itâ€™s totally normal to be bottlenecked on just one or two workers at a time.\n*   **Run regular town cleanups**. You can do this with any of your crew, it doesnâ€™t need to be the Mayor. Have a crew member go through and clear out stale beads, workers, processes, untracked files, etc. Anything you do often, you can make a plugin that the Deacon will run on its patrol.\n\n![Vibe Coding with Gas Town: The Three Cadences](https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x8-gpH_9UrFbr0bRibD91A.jpeg)\n\nDev Inner Loop\n--------------\n\n*   **Sling swarm work in Convoys**. Polecats thrive on well-defined, fully-specâ€™ed beads epics. Doing it in convoys allows you to track your completed features and high-level work items in the dashboard. Convoys will soon be completely automated, but you sometimes have to tell the Mayor (or whoever is kicking off a convoy) which work to include in the convoy. You can easily merge and update convoys as they run, however, by asking any agent to do it.\n*   **Donâ€™t watch your agents work**. Make sure they have their marching orders, and let them do their thing. But. When you see that an agent is finished working, stop everything, ignore everyone else, and read what it has to say. Scroll back and make sure you understand what it did and what itâ€™s saying. Then act on it. You can go in any order you like, but at some point you have to act on each agentâ€™s response or risk losing work. Spend your time reading agent responses and giving them direction â€” not watching them work.\n*   **Use** `gt handoff` **liberally** **after every task, in every worker**. Only let sessions go long if they need to accumulate important context for a big design or decision. Polecats take this philosophy to the extreme, and self-destruct after they submit their MR or finish their task. For all other workers, there are several ways to hand off, including saying â€œletâ€™s hand offâ€, optionally with instructions (expensive but very flexible), run `/handoff` (expensive and inflexible), or shell out to run `!gt handoff` to ask Gas Town to do it mechanically (no cost). The worker will be spun up on a new shift, preserving the tmux session.\n\nFinally, â€œ**Work with your Crew**â€ is the biggest tip of all, so itâ€™s getting its own section. Your Crew are your named, long-lived workers on each project rig. Theyâ€™re your design team, and they create guzzoline for the swarms.\n\n**Working with Crew**\n---------------------\n\nPolecats are ephemeral and unsupervised workers. When you have the Mayor `gt sling` work to a rig, a polecat will pick it up. They complete their work and submit MRs without human intervention. (Though, polecats can also escalate work, when it needs human attention.)\n\nPolecats are best for well-defined, well-specified work. You should feed them Beads epics that have been thoroughly decomposed and vetted multiple times for suitability for polecats. They shouldnâ€™t have to make decisions.\n\nBut how do you get those big, well-defined epics? Thatâ€™s where the Crew comes in. Your Crew are named, long-lived agents who work on your Rigs. You can see here a picture of my desktop running Gas Town in a very typical configuration.\n\n*   I have the Mayor in a MacOS Terminal window in the center, in a tmux session that says â€œMayorâ€ at the bottom. The status bar shows rig statuses and other metadata.\n*   The left side is my Gas Town rig workers: jack, joe, max, gus, george, dennis. Of a possible six, I have five active at the moment. If I ever want to add more, Iâ€™ll just add more with `gt crew add gastown tommynorris` or whatever, and then Iâ€™ll have seven. They donâ€™t all need to be active at once.\n*   The right side is my Beads rig, which is gradually shifting to Lord of the Rings names, but still has some Jane Austen and miscellaneous. You can easily `gt crew remove <rig> <name>` to remove their repo clone, and then create another crew member with a different name. I have all six active on the right side at the moment.\n\nIn this setup, the Mayor is about to kick off a Convoy, so Iâ€™ll have a peak of about 15â€“16 workers going. I could get aggressive and kick off multiple convoys, but Iâ€™m being a bit cautious until I know the murder spree is over.\n\nWhen v0.3.0 launches Iâ€™ll be pretty certain that class of bugs is solved. Right now itâ€™s looking pretty good.\n\n![Gas Town crew, Mayor, and Beads Crew tmux sessions](https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NEgEYkSy3-_o5lTJR8fC4Q.png)\n\nYour Personal Concierges\n------------------------\n\nI use the Crew for any sort of thought-intensive work, including design work, reviewing contributor PRs, creating implementation plans, and sometimes doing specific code reviews.\n\nThe crew for a rig are on a tmux cycle group. So the left-side (blue) cycles through Gas Town crew, and the right side (green) cycles through Beads crew.\n\nI believe this is the secret-weapon â€œsecond workflowâ€ of Gas Town. The main workflow is talking to the Mayor and having it file beads and sling them to polecats as convoys. And thatâ€™s great for well-defined work. But cycling through your crew lets you have richer, more hands-on discussions with your agents.\n\nI started life with about 3 crew per rig, but Iâ€™ve worked my way up to 7â€“8 crew per rig. You can add new ones with `gt crew add` but I just ask some other worker to do it for me. I just pick a theme for each rigâ€™s crew names and then choose the names myself. Having a theme helps you identify which rig theyâ€™re from at a glance.\n\nBefore I start farming work to a crew, I make sure theyâ€™re all reset: no hook, no mail, clean sandbox, fresh session. You can do this with an announcement, but I usually just tell one of the crew members to get all the crew ready. Give them a few minutes to take care of that; work on other stuff while you wait.\n\n![How I use Gas Town: Rig Cycling and Polecat Slinging](https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_nRKWon2XOtpRpeph0gkRg.jpeg)\n\nWhen theyâ€™re all settled, Iâ€™ll go through them all in order, in a big loop.\n\n*   Give each crew member a bug, PR, or GHI to tackle. Or, give it a feature to design or a problem to solve. But give it the work, and then _leave it alone_ to do that work.\n*   Cycle to the next or previous crew member with `C-b n` or `C-b p` and give them a task as well. You can use `gt ready` to get a town-level view of ready work, and choose one item to hand to each crew member.\n*   Do this until every crew member is spinning, working on some task you gave them. If you want to be paranoid, `gt sling` the task to them (or have them sling it to themself or another crew) to hook it so they will continue working on it after a crash.\n\nWith one rig fully spinning, I go to my next Rig (Beads, in this case) and start the exact same loop. Go through each crew, give them a meaty task, and let them work.\n\nThen we get to the fun part. You get to see where all your slot machines landed.\n\nAs youâ€™re cycling through your crews, you will see some still working, and others will begin finishing. Some of them will finish simple stuff and you just `gt handoff` to prep them for more work. Others will have questions, or complex summaries, and youâ€™ll need to reserve some time to read what theyâ€™ve written and act on it.\n\nI find this is the most satisfying part of the workflow. Itâ€™s like youâ€™re Jeff Bezos and your team is presenting results to you, one at a time. You let some merge, send others back to the drawing board, and repurpose still others for random whims. This is the part of the workflow where your project direction unfolds.\n\n**Crew Sheriffs**\n-----------------\n\n![PR Sheriff: permanent standing orders for a designated Crew member](https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dimvNqeBdA6PeGeoIHIUAw.jpeg)\n\nOne last Crew tip: I have a new ad-hoc role that Iâ€™ve been using for the past week, called the â€œPR Sheriff.â€ One of my Beads crew has a permanent hook: `bd-4f43s: PR Sheriff Standing Orders`. On every session startup, the sheriff checks open PRs and divides them into easy wins and those needing human review, then slings the easy wins to other crew for merging and cleanup.\n\nThe amazing thing about this is that every time I boot up my Beads crew, they automatically go merge another 5 or so PRs, and flag a couple more for me to review with them. It keeps them busy for a few minutes every time I start up the town, while Iâ€™m doing other stuff. Iâ€™ve now got a sheriff set up over on the Gas Town rig as well.\n\nThe PR Sheriff bead gets accidentally unhooked often enough that Iâ€™ve just reassigned it a new id, `bd-pr-sheriff`, making it easier for me to remember what itâ€™s called when I need to tell the worker to re-pin it (or reference it when talking to a different worker.)\n\nTending the Invisible Garden\n----------------------------\n\nWhen you work with Gas Town, you donâ€™t usually have time to inspect the code youâ€™re creating. Thatâ€™s not your role. But you need to make sure the code meets your quality bar. How do you ensure your garden is healthy if you canâ€™t see it?\n\nThe answer: **regular code review sweeps, followed by bug-fix sweeps** that fix the issues filed during the code-review sweeps. Gas Town excels at both of these. It can generate tons of work with a swarm (filing Beads as it finds problems) and then crank through tons of work with another swarm. You just keep doing this until the code reviews are just nitpicking, or the agents say the code is ready to ship. Do some of this every day, and hope that most of the time you donâ€™t find anything bad. The only way to be sure is to do it all the time.\n\n![Tending the Invisible Garden of Vibe Coding](https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b_FatkwLZMoy6ZaBAbOm5g.jpeg)\n\nYour garden can get diseases. I mentioned â€œheresiesâ€ above. Agents are very approximate workers and they like to guess at stuff. They will often make _wrong_ guesses about how your system is supposed to work. If that wrong guess makes it into the code, sneaking through the review process, then it becomes enshrined and other agents may notice it and propagate the heresy in their own work.\n\nâ€œIdle polecatsâ€ is an example of a heresy that plagues Gas Town. There is no such thing as an idle polecat; itâ€™s not a pool, and they vanish when their work is done. But polecats do have long-term identities, so itâ€™s more like they are clocking out and leaving the building between jobs, which is harder for agents to wrap their heads around. So â€œidle polecatsâ€ make it back into the code base, comments, and docs all the time.\n\nIâ€™ve found the most helpful way to rid yourself of persistent heresies is to capture your guiding principles in the agent priming (onboarding). Which means you have to come up with some guiding principles in the first place.\n\nYour core principles or axioms will be different for every project youâ€™re working on. But the more coverage you can get with them, the more classes of heresy you can avoid or easily correct simply by pointing at the principle they violate. Gas Town core principles include things like Zero Framework Cognition (shared with Beads), which Iâ€™ve written about, GUPP, MEOW, Discovery over Tracking, Beads as the Universal Data Plane, and so on. All of these help me stamp out heresies that try to creep into my code.\n\nVideos Coming Soon\n------------------\n\nA lot of this stuff you can only really show with a video. Iâ€™ll get some put together ASAP.\n\nIn the meantime, thanks to everyone whoâ€™s been messing with it despite knowing it will rip their faces off. It those faceless early adopters who will help us turn it into a real product. Hats off you all!\n\n![Thanks to Gas Town Early Adopters!](https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gCC6N2OBNLXy01v8q_7efA.jpeg)","numLines":157,"startLine":1,"totalLines":157}},"sourceToolAssistantUUID":"5bf13b76-2020-4f07-b347-01af062cd886"}
{"parentUuid":"992f2c5a-1833-44af-8833-2a92e2d9b322","isSidechain":true,"userType":"external","cwd":"/Users/csells/Code/gastownhall/website","sessionId":"dc9d694e-994e-4b73-9876-59c87b636ae6","version":"2.1.12","gitBranch":"main","agentId":"af83d1f","slug":"snappy-doodling-pudding","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01D32A8y2dhthA96mHdqsrfS","type":"tool_result","content":"     1â†’Welcome to Gas Town\n     2â†’===================\n     3â†’\n     4â†’[![Steve Yegge](https://miro.medium.com/v2/resize:fill:64:64/1*8Ae2b9dv-sQtme8C4_sjhA.jpeg)](https://medium.com/?source=post_page---byline--4f25ee16dd04---------------------------------------)\n     5â†’\n     6â†’[Steve Yegge](https://medium.com/?source=post_page---byline--4f25ee16dd04---------------------------------------)\n     7â†’\n     8â†’34 min read\n     9â†’\n    10â†’Â·\n    11â†’\n    12â†’Jan 1, 2026\n    13â†’\n    14â†’[nameless link](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2F4f25ee16dd04&operation=register&redirect=https%3A%2F%2Fsteve-yegge.medium.com%2Fwelcome-to-gas-town-4f25ee16dd04&user=Steve+Yegge&userId=c1ec701babb7&source=---header_actions--4f25ee16dd04---------------------clap_footer------------------)\n    15â†’\n    16â†’--\n    17â†’\n    18â†’49\n    19â†’\n    20â†’[nameless link](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4f25ee16dd04&operation=register&redirect=https%3A%2F%2Fsteve-yegge.medium.com%2Fwelcome-to-gas-town-4f25ee16dd04&source=---header_actions--4f25ee16dd04---------------------bookmark_footer------------------)\n    21â†’\n    22â†’Listen\n    23â†’\n    24â†’Share\n    25â†’\n    26â†’Happy New Year, and Welcome to Gas Town!\n    27â†’\n    28â†’![Figure 1: Welcome to Gas Town](https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ReBwrC1sc9USnhvYXcrd4A.jpeg)\n    29â†’\n    30â†’**What the Heck is Gas Town?**\n    31â†’------------------------------\n    32â†’\n    33â†’[Gas Town](https://github.com/steveyegge/gastown) is a new take on the IDE for 2026. Gas Town helps you with the tedium of running lots of Claude Code instances. Stuff gets lost, itâ€™s hard to track whoâ€™s doing what, etc. Gas Town helps with all that yak shaving, and lets you focus on what your Claude Codes are working on.\n    34â†’\n    35â†’For this blog post, â€œClaude Codeâ€ means â€œClaude Code and all its identical-looking competitorsâ€, i.e. Codex, Gemini CLI, Amp, Amazon Q-developer ClI, blah blah, because thatâ€™s what they are. Clones. The industry is an embarrassing little kidâ€™s soccer team chasing the 2025 CLI form factor of Claude Code, rather than building whatâ€™s next.\n    36â†’\n    37â†’I went ahead and built whatâ€™s next. First I predicted it, back in March, in [Revenge of the Junior Developer](https://sourcegraph.com/blog/revenge-of-the-junior-developer). I predicted someone would lash the Claude Code camels together into chariots, and that is exactly what Iâ€™ve done with Gas Town. Iâ€™ve tamed them to where you can use 20â€“30 at once, productively, on a sustained basis.\n    38â†’\n    39â†’Gas Town is opinionated â€” much like Kubernetes, or Temporal, both of which Gas Town resembles, at least if you squint at it until your eyes are pretty much totally shut. Iâ€™ll include comparisons to both k8s and Temporal at the end of this post. It is a little surprising how similar they are, despite having radically different underpinnings.\n    40â†’\n    41â†’But the comparison should serve as a warning: Gas Town is complicated. Not because I wanted it to be, but because I had to keep adding components until it was a self-sustaining machine. And the parts that it now has, well, they look a lot like Kubernetes mated with Temporal and they had a very ugly baby together.\n    42â†’\n    43â†’But it works! Gas Town solves the [MAKER problem](https://arxiv.org/abs/2511.09030) (20-disc Hanoi towers) trivially with a million-step wisp you can generate from a formula. I ran the 10-disc one last night for fun in a few minutes, just to prove a thousand steps was no issue (MAKER paper says LLMs fail after a few hundred). The 20-disc wisp would take about 30 hours. Thanks for coming to my TED Talk.\n    44â†’\n    45â†’All this will make complete sense if you make it through the next 23 pages.\n    46â†’\n    47â†’**Gas Town Was No Secret**\n    48â†’--------------------------\n    49â†’\n    50â†’After Revenge of the Junior Developer, I traveled around all year, loudly telling everyone exactly what needed to be built, and I mean _everyone_. I was not shy about it. I would declare, â€œOrchestrators are next!â€ And everyone would nod slowly and frown thoughtfully and say, â€œhuh.â€\n    51â†’\n    52â†’I went to senior folks at companies like Temporal and Anthropic, telling them they should build an agent orchestrator, that Claude Code is just a building block, and itâ€™s going to be all about AI workflows and â€œKubernetes for agentsâ€. I went up onstage at multiple events and described my vision for the orchestrator. I went everywhere, to everyone.\n    53â†’\n    54â†’â€œIt will be like kubernetes, but for agents,â€ I said.\n    55â†’\n    56â†’â€œIt will have to have multiple levels of agents supervising other agents,â€ I said.\n    57â†’\n    58â†’â€œIt will have a Merge Queue,â€ I said.\n    59â†’\n    60â†’â€œIt will orchestrate workflows,â€ I said.\n    61â†’\n    62â†’â€œIt will have plugins and quality gates,â€ I said.\n    63â†’\n    64â†’I said lots of things about it, for months. But hell, we couldnâ€™t even get people to use Claude Code, let alone think about using 10 to 20 of them at once.\n    65â†’\n    66â†’So in August I started building my own orchestrator, since nobody else seemed to care. Eventually it failed, and I threw it out and started over on v2, which also failed, but we got [Beads](https://github.com/steveyegge/beads) out of it. Then v3 (Python Gas Town), which lasted a good six or eight weeks.\n    67â†’\n    68â†’Gas Town (in Go) is my fourth complete, functioning orchestrator of 2025. The story of how I arrived at Gas Town is fun, but weâ€™ll save it for another time. Unfortunately this post will be long enough (25+ pages!) just telling you the barest basics of how it works. We can do the back story later.\n    69â†’\n    70â†’But first, before we get into Gas Townâ€™s operation, I need to get rid of you real quick.\n    71â†’\n    72â†’**WARNING DANGER CAUTION**\n    73â†’--------------------------\n    74â†’\n    75â†’**GET THE F*** OUT**\n    76â†’-----------------------\n    77â†’\n    78â†’**YOU WILL DIE**\n    79â†’----------------\n    80â†’\n    81â†’Letâ€™s talk about _some_ of the reasons you shouldnâ€™t use Gas Town. I could think of more, but these should do.\n    82â†’\n    83â†’First of all, the code base is under 3 weeks old. On a scale of â€œpolished diamondâ€ to â€œuncut roughâ€ to â€œI just smuggled it 400 miles upriver in my ass,â€ Iâ€™m going to characterize Gas Town as â€œYou probably donâ€™t want to use it yet.â€ It needs some Lysol. Itâ€™s also 100% vibe coded. Iâ€™ve never seen the code, and I never care to, which might give you pause. â€˜Course, Iâ€™ve never looked at [Beads](https://github.com/steveyegge/beads) either, and itâ€™s 225k lines of Go code that tens of thousands of people are using every day. I just created it in October. If that makes you uncomfortable, _get out now_.\n    84â†’\n    85â†’Second, you are really, seriously, not ready yet. Letâ€™s talk about the Evolution of the Programmer in 2024â€“2026, pictured here by Nano Banana in Figure 2:\n    86â†’\n    87â†’![Figure 2: The 8 Stages of Dev Evolution To AI](https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ArLBW-FgOdve4COI804uIQ.png)\n    88â†’\n    89â†’First, you should locate yourself on the chart. What stage are you in your AI-assisted coding journey?\n    90â†’\n    91â†’Stage 1: **Zero or Near-Zero AI:** maybe code completions, sometimes ask Chat questions\n    92â†’\n    93â†’Stage 2: **Coding agent in IDE**, permissions turned on. A narrow coding agent in a sidebar asks your permission to run tools.\n    94â†’\n    95â†’Stage 3: **Agent in IDE, YOLO mode:** Trust goes up. You turn off permissions, agent gets wider.\n    96â†’\n    97â†’Stage 4: **In IDE, wide agent**: Your agent gradually grows to fill the screen. Code is just for diffs.\n    98â†’\n    99â†’Stage 5: **CLI, single agent. YOLO**. Diffs scroll by. You may or may not look at them.\n   100â†’\n   101â†’Stage 6: **CLI, multi-agent, YOLO**. You regularly use 3 to 5 parallel instances. You are very fast.\n   102â†’\n   103â†’Stage 7: **10+ agents**, **hand-managed**. You are starting to push the limits of hand-management.\n   104â†’\n   105â†’Stage 8: **Building your own orchestrator**. You are on the frontier, automating your workflow.\n   106â†’\n   107â†’If youâ€™re not at _least_ Stage 7, or maybe Stage 6 and very brave, then you will not be able to use Gas Town. You arenâ€™t ready yet. Gas Town is an industrialized coding factory manned by superintelligent robot chimps, and when they feel like it, they can wreck your shit in an instant. They will wreck the other chimps, the workstations, the customers. Theyâ€™ll rip your face off if you arenâ€™t already an experienced chimp-wrangler. So no. If you have _any doubt whatsoever_, then you canâ€™t use it.\n   108â†’\n   109â†’Working effectively in Gas Town involves committing to vibe coding. Work becomes fluid, an uncountable substance that you sling around freely, like slopping shiny fish into wooden barrels at the docks. Most work gets done; some work gets lost. Fish fall out of the barrel. Some escape back to sea, or get stepped on. More fish will come. The focus is _throughput_: creation and correction at the speed of thought.\n   110â†’\n   111â†’![Figure 3: Vibe Coding Chaos](https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3iC6cilfUdvndZUVRELmBA.jpeg)\n   112â†’\n   113â†’Work in Gas Town can be chaotic and sloppy, which is how it got its name. Some bugs get fixed 2 or 3 times, and someone has to pick the winner. Other fixes get lost. Designs go missing and need to be redone. It doesnâ€™t matter, because you are churning forward _relentlessly_ on huge, huge piles of work, which Gas Town is both generating and consuming. You might not be 100% efficient, but you are _flying_.\n   114â†’\n   115â†’In Gas Town, you let Claude Code do its thing. You are a Product Manager, and Gas Town is an Idea Compiler. You just make up features, design them, file the implementation plans, and then sling the work around to your polecats and crew. Opus 4.5 can handle any reasonably sized task, so your job is to make tasks for it. Thatâ€™s it.\n   116â†’\n   117â†’That, and you have to help keep Gas Town running. It runs itself pretty well most of the time, but stuff goes wrong often. It can take a lot of elbow grease from you and the workers to keep it running smoothly. Itâ€™s very much a hands-on-the-wheel orchestration system.\n   118â†’\n   119â†’If you canâ€™t work like that, then what in Godâ€™s name are you still doing here? Go back to your IDE and shelter in place. Gas Town is not safe for you.\n   120â†’\n   121â†’Gas Town is also expensive as hell. You wonâ€™t like Gas Town if you ever have to think, even for a moment, about where money comes from. I had to get my second Claude Code account, finally; they donâ€™t let you siphon unlimited dollars from a single account, so you need multiple emails and siphons, itâ€™s all very silly. My calculations show that now that Gas Town has finally achieved liftoff, I will need a third Claude Code account by the end of next week. It is a cash guzzler.\n   122â†’\n   123â†’Gas Town uses tmux as its primary UI. I had to learn tmux. It was easier than I thought it would be, and way more useful. 3 weeks in, and I love tmux. You will have to learn a bit of tmux. Or, you can wait until someone writes a better UI for Gas Town. Better UIs will come. But tmux is what you have for now. And itâ€™s worth learning.\n   124â†’\n   125â†’![Figure 4: Mayor tmux status line](https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hpoPpTPIuHu993KlRyFMjw.png)\n   126â†’\n   127â†’Like it or not, Gas Town is built on Beads. It is in fact the sequel to Beads: my Empire Strikes Back to Beadsâ€™ Star Wars. There is no â€œalternate backendâ€ for Gas Town. Beads is the Universal Git-Backed data plane (and control plane, it turns out) for everything that happens in Gas Town. You have to use Beads to use Gas Town.\n   128â†’\n   129â†’You might not like Beads. If you think Beads is overly-opinionated, youâ€™re in for a ride. Gas Town is me marching into the Church of Public Opinion on AI-Assisted Coding, lifting my leg, and ripping a fart that will be smelt all around the world.\n   130â†’\n   131â†’Many of you may gag at my brand. But I suspect a few of you will like becoming _superheroes_ enough that youâ€™re willing to look past Gas Townâ€™s quirks, and see it my way. This is how work should be done. Itâ€™s the best way already, and it will get better.\n   132â†’\n   133â†’Gas Town is designed to scale up in three dimensions this year with (1) model cognition, (2) agents becoming more Gas Town-friendly, and (3) Gas Town and Beads making it into the training corpus for frontier models. Even without all that, itâ€™s already shocking that the agents use Beads and Gas Town so effortlessly. With zero training.\n   134â†’\n   135â†’But right now? Itâ€™s like a late 1800s factory with machines that can disembowel you if youâ€™re not careful.\n   136â†’\n   137â†’OK! That was like half a dozen great reasons not to use Gas Town. If I havenâ€™t got rid of you yet, then I guess youâ€™re one of the crazy ones. Hang on. This will be a long and complex ride. Iâ€™ve tried to go super top-down and simplify as much as I can, but itâ€™s a bit of a textbook.\n   138â†’\n   139â†’Iâ€™m sorry. But in my defense, Gas Town is hella fun. Best thing Iâ€™ve ever made.\n   140â†’\n   141â†’Letâ€™s dive in.\n   142â†’\n   143â†’**Gas Town 101**\n   144â†’\n   145â†’![Figure 5: Gas Townâ€™s Worker Roles](https://miro.medium.com/v2/resize:fit:1400/format:webp/1*85xoVIP4w_jiDlDgdYch_A.jpeg)\n   146â†’\n   147â†’Gas Town workers are regular coding agents, each prompted to play one of seven well-defined worker roles. There are some other key concepts Iâ€™ll briefly introduce, along with the roles, like Towns and Rigs.\n   148â†’\n   149â†’One thing to know up front about Gas Town: it degrades gracefully. Every worker can do their job independently, or in little groups, and at any time you can choose which parts of Gas Town you want running. It even works in no â€œno-tmuxâ€ mode, and limps along using naked Claude Code sessions without real-time messages. Itâ€™s a little slower, but it still works.\n   150â†’\n   151â†’The seven Gas Town roles all work together to help keep Gas Town running. And it needs your help sometimes, too; Gas Town runs on equal parts guzzoline and elbow grease.\n   152â†’\n   153â†’Here are the key players and concepts:\n   154â†’\n   155â†’**ðŸ™ï¸The Town:** This is your HQ. Mine is `~/gt`, and all my project rigs go beneath it: gastown, beads, wyvern, efrit, etc.. The town (Go binary `gt`) manages and orchestrates all the workers across all your rigs. You keep it in a separate repo, mostly for the configuration.\n   156â†’\n   157â†’**ðŸ—ï¸Rigs**: Each project (git repo) you put under Gas Town management is called a Rig. Some roles (Witness, Polecats, Refinery, Crew) are per-rig, while others (Mayor, Deacon, Dogs) are town-level roles. `gt rig add` and related commands manage your rig within the Gas Town harness. Rigs are easy to add and remove.\n   158â†’\n   159â†’**ðŸ‘¤The Overseer**: Thatâ€™s you, Human. The eighth role. I gave you some eye paint in the picture. As the Overseer, you have an identity in the system, and your own inbox, and you can send and receive town mail. Youâ€™re the boss, the head honcho, the big cheese.\n   160â†’\n   161â†’**ðŸŽ©The Mayor**: This is the main agent you talk to most of the time. Itâ€™s your concierge and chief-of-staff. But if the Mayor is busy, all the other workers are also Claude Code, so they are all very smart and helpful. The Mayor typically kicks off most of your work convoys, and receives notifications when they finish.\n   162â†’\n   163â†’**ðŸ˜ºPolecats**: Gas Town is a work-swarming engine. Polecats are ephemeral per-rig workers that spin up on demand. Polecats work, often in swarms, to produce Merge Requests (MRs), then hand them off to the Merge Queue (MQ). After the merge they are fully decommissioned, though their names are recycled.\n   164â†’\n   165â†’**ðŸ­Refinery**: As soon as you start swarming workers, you run into the Merge Queue (MQ) problem. Your workers get into a monkey knife fight over rebasing/merging and it can get ugly. The baseline can change so much during a swarm that the final workers getting merged are trying to merge against an unrecognizable new head. They may need to completely reimagine their changes and reimplement them. This is the job of the Refinery: the engineer agent responsible for intelligently merging all changes, one at a time, to main. No work can be lost, though it is allowed to escalate.\n   166â†’\n   167â†’**ðŸ¦‰The Witness:** Once you spin up enough polecats, you realize you need an agent just to watch over them and help them get un-stuck. Gas Townâ€™s propulsion (GUPP) is effective, but still a bit flaky right now, and sometimes you will need to go hustle the polecats to get their MRs submitted, and then hustle the Refinery to deal with them. The Witness patrol helps smooth this out so itâ€™s almost perfect for most runs.\n   168â†’\n   169â†’**ðŸºThe Deacon**: The deacon is the daemon beacon. Itâ€™s named for a Dennis Hopper character from Waterworld that was _inspired_ by the character Lord Humungus in the Mad Max universe, making it a crossover. The Deacon is a Patrol Agent: it runs a â€œpatrolâ€ (a well-defined workflow) in a loop. Gas Town has a daemon that pings the Deacon every couple minutes and says, â€œDo your job.â€ The Deacon intelligently propagates this DYFJ signal downward to the other town workers, ensuring Gas Town stays working.\n   170â†’\n   171â†’**ðŸ¶Dogs**: Inspired by Mick Herronâ€™s MI5 â€œDogsâ€, this is the Deaconâ€™s personal crew. Unlike polecats, Dogs are town-level workers. They do things like maintenance (cleaning up stale branches, etc.) and occasional handyman work for the Deacon, such as running plugins. The Deaconâ€™s patrol got so overloaded with responsibilities that it needed helpers, so I added the Dogs. This keeps the Deacon focused completing on its patrol, rather than getting bogged down and stuck on one of the steps. The Deacon slings work to the Dogs and they handle the grungy details.\n   172â†’\n   173â†’**ðŸ•Boot the Dog**: There is a special Dog named Boot who is awakened every 5 minutes by the daemon, just to check on the Deacon. Thatâ€™s its only job. Boot exists because the daemon kept interrupting the Deacon with annoying heartbeats and pep talks, so now the dog gets to hear it. Boot decides if the Deacon needs a heartbeat, a nudge, a restart, or simply to be left alone, then goes back to sleep.\n   174â†’\n   175â†’**ðŸ‘·The Crew**: The Crew, despite being last in the list, are the agents youâ€™ll personally use the most, after the Mayor. The crew are per-Rig coding agents who work for the Overseer (you), and are not managed by the Witness. You choose their names and they have long-lived identities. You can spin up as many as you like. The tmux bindings let you cycle through the crew in a loop for each rig with `C-b n/p`. The Crew are the direct replacements for whatever workflow you used to be using. Itâ€™s just a bunch of named claude code instances that can get mail and can sling work around. The crew are great for stuff like design work, where there is a lot of back-and-forth. Theyâ€™re great. Youâ€™ll love your crew.\n   176â†’\n   177â†’**ðŸ“¬Mail and Messaging**\n   178â†’\n   179â†’[Beads](https://github.com/steveyegge/beads) are the atomic unit of work in Gas Town. A bead is a special kind of issue-tracker issue, with an ID, description, status, assignee, and so on. Beads are stored in JSON (one issue per line) and tracked in Git along with your project repo. Town mail and messaging (events) use Beads, as do other types of orchestration.\n   180â†’\n   181â†’Gas Town has a two-level Beads structure: Rig beads, and Town beads.\n   182â†’\n   183â†’![Figure 6: Two-Tier Beads Flow](https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Iyt15AJT0gm66I6DfkVUbA.jpeg)\n   184â†’\n   185â†’There are two levels of work going on in Gas Town: Rig-level, and Town-level.\n   186â†’\n   187â†’*   **Rig-level work is project work**: Making your project better. Features, bug fixes, etc. This work is split between polecats and crew, with other workers stepping in occasionally.\n   188â†’*   **Town-level work is orchestration**, and includes stuff like patrols (long strings of steps to follow, encoded as linked beads) and one-shot workflows like releases, or generating cross-rig code review waves.\n   189â†’\n   190â†’Both of these kinds of work use Beads, and there is some overlap between the two. For the most part, itâ€™s pretty flexible and it doesnâ€™t really matter where you file issues or instantiate work. All the workers know their way around Gas Town and are pretty chill if you give them work from the wrong rig.\n   191â†’\n   192â†’All rig-level workers (refinery, witness, polecats and crew) are perfectly able to work cross-rig when they need to. There is a `gt worktree` command that they can use to grab their own clone of any rig and make a fix. But normally they work inside a single project.\n   193â†’\n   194â†’Beads has cross-rig routing. Gas Town configures Beads to route requests like `bd create` and `bd show` to route to the right database based on the issue prefix, like â€œbd-â€ or â€œwy-â€. All Beads commands work pretty much anywhere in Gas Town and figure out the right place to put them, and if not, itâ€™s easy to move Beads around.\n   195â†’\n   196â†’**A Note About Mad Max Theming**\n   197â†’\n   198â†’Gas Town is just Gas Town. It started with Mad Max theming, but none of it is super strong. None of the roles are proper names from the series, and Iâ€™m bringing in theming from other sources as well, including the Slow Horses universe, Waterworld, Catâ€™s Cradle, Breaking Bad (as youâ€™ll soon see), and apparently The Wind in the Willows, from the Nano Banana drawings.\n   199â†’\n   200â†’If anyone ever sends me a C&D letter about it, Gas Town will smart-octopus shapeshift its way into Gastown, named for beautiful Vancouver B.C.â€™s Gastown district, and our polecats will just be on a different kind of pole.\n   201â†’\n   202â†’Long story short, â€œGastownâ€ is also a correct way to refer to the project. And with thatâ€¦\n   203â†’\n   204â†’**Gastown Universal Propulsion Principle**\n   205â†’\n   206â†’GUPP is what keeps Gas Town moving. The biggest problem with Claude Code is it ends. The context window fills up, and it runs out of steam, and stops. GUPP is my solution to this problem.\n   207â†’\n   208â†’GUPP states, simply: If there is work on your hook, YOU MUST RUN IT.\n   209â†’\n   210â†’All Gas Town workers, in all roles, have persistent identities in Beads, which means in Git. A workerâ€™s identity type is represented by a Role Bead, which is like a domain table describing the role. And each worker has an Agent Bead, which is the agentâ€™s persistent identity.\n   211â†’\n   212â†’Both Role Beads and Agent Beads (as well as Hooks) are examples of â€œpinned beadsâ€, meaning they float like yellow-sticky notes in the Beads data plane, and never get closed like regular issues (unless the identity goes away). They donâ€™t show up in `bd ready` (ready work) and theyâ€™re treated specially in various other ways.\n   213â†’\n   214â†’In Gas Town, an agent is not a session. Sessions are ephemeral; they are the â€œcattleâ€ in the Kubernetes â€œpets vs cattleâ€ metaphor. Claude Code sessions are the cattle that Gas Town throws at persistent work. That work all lives in Beads, along with the persistent identities of the workers, and the mail, the event system, and even the ephemeral orchestration, as we will see.\n   215â†’\n   216â†’In Gas Town, an agent _is_ a Bead, an identity with a singleton global address. It has some slots, including a pointer to its Role Bead (which has priming information etc. for that role), its mail inbox (all Beads), its Hook (also a Bead, used for GUPP), and some administrative stuff like orchestration state (labels and notes). The history of everything that agent has done is captured in Git, and in Beads.\n   217â†’\n   218â†’So what is a Hook? Every Gas Town worker has its own hook ðŸª. Itâ€™s a special pinned bead, just for that agent, and itâ€™s where you hang molecules, which are Gas Town workflows.\n   219â†’\n   220â†’![Figure 7: GUPP, the Gastown Universal Propulsion Principle](https://miro.medium.com/v2/resize:fit:1400/format:webp/1*blwto0wOjNmgjqZ9tcm0dg.jpeg)\n   221â†’\n   222â†’How does stuff get hung there? Why, with `gt sling`, of course. You sling work to workers, and it goes on their hook. You can start them immediately, or defer it, or even make them restart first. Weâ€™ll talk about all that in a bit. Slinging them work means you can go deal with other stuff, and theyâ€™ll just continue.\n   223â†’\n   224â†’One of the simplest but greatest things about Gas Town is that any time in any session, you can say, â€œletâ€™s hand offâ€, and the worker will gracefully clean up and restart itself. Thanks to GUPP, the agent will continue working automatically if itâ€™s hooked.\n   225â†’\n   226â†’Unfortunately, Claude Code is so miserably _polite_ that GUPP doesnâ€™t always work in practice. We tell the agent, YOU MUST RUN YOUR HOOK, and it sometimes doesnâ€™t do anything at all. It just sits there waiting for user input.\n   227â†’\n   228â†’So we have a workaround.\n   229â†’\n   230â†’**The GUPP Nudge**\n   231â†’\n   232â†’Gas Town workers are prompted to follow â€œphysics over politeness,â€ and are told to look at their hook on startup. If their hook has work, they must start working on it without waiting.\n   233â†’\n   234â†’Unfortunately, in practice, Claude Code often waits until you type something â€” anything â€” before it checks its mail and hook, reports in, and begins working. Sometimes it does, sometimes it doesnâ€™t. This will get better over time, but for now, it sometimes needs a nudge.\n   235â†’\n   236â†’Because Gas Town workers donâ€™t always follow GUPP, there are various systems in place that will nudge the agent, roughly 30 to 60 seconds after it starts up. Sometimes faster, sometimes slower. But it will always get the nudge within 5 minutes or so, if the town is running and not quiescent.\n   237â†’\n   238â†’Agents get a startup poke with `gt nudge`, Gas Townâ€™s core real-time messaging command that sends a tmux notification to a worker (or a whole channel). It works around some debounce issues with `tmux send-keys` and ensures the worker receives the notification as if the user had typed it. This kicks the worker into reading their mail and hook, and taking action.\n   239â†’\n   240â†’With the Gupp Nudge â€œhackâ€ in place, and the hierarchical heartbeat from the Deacon downward, GUPP generally hums along and keeps Gas Town running for as long as thereâ€™s work available. Convoys start up, complete, and land without intervention. Workers continue molecules across sessions. Gas Town can work all night, if you feed it enough work.\n   241â†’\n   242â†’**Talking to your Dead Ancestors**\n   243â†’\n   244â†’The GUPP Nudge led to an interesting feature, `gt seance`, which allows Gas Town workers to communicate directly with their predecessors in their role. I.e. the current Mayor can talk to the last Mayor, and so on. They do this with the help of Claude Codeâ€™s `/resume` feature, which lets you restart old sessions that you killed.\n   245â†’\n   246â†’This is useful because often, a worker will say, â€œOK, I handed off this big pile of work and advice to my successor! Kbai! `/handoff`â€, and disappear, and then the new worker will spin up and be like, â€œWhat? I donâ€™t see shit.â€ You used to have to clumsily go figure out which session was the previous one, out of your last 40-odd sessions, all of which start with â€œletâ€™s goâ€, because you have been doing the GUPP nudge manually. It was really awkward and almost not worth it.\n   247â†’\n   248â†’The way `gt seance` came about is: It doesnâ€™t matter what you tell the agent in the nudge. Because their prompting is so strict about GUPP and the theory of operation of Gas Town, and how _important_ they are as gears in the machine, blah blah blah, that agents will completely ignore whatever you type unless you are _directly_ overriding their hook instructions.\n   249â†’\n   250â†’![Figure 8: Talking to Dead Ancestors with `gt seance`](https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G1mjYw9Hew3Mty91cGQQ9Q.jpeg)\n   251â†’\n   252â†’So all you need to say is, â€œhiâ€, or â€œElon Musk says the moon is made of green cheeseâ€, or â€œdo your jobâ€, and the agent will run the hook.\n   253â†’\n   254â†’My idea a week ago was: Since we have to nudge all the sessions anyway, I decided to include the Claude Code `session_id` (along with Gas town role and PID) in with the nudge. This gives each `/resume` session a unique and useful/discoverable title.\n   255â†’\n   256â†’With `gt seance`, the worker will literally spin Claude Code up in a subprocess, use `/resume` to revive its predecessor, and ask it, â€œWhere the hell is my stuff you left for me?â€\n   257â†’\n   258â†’Good times, I tell you. Gas Town is Good Times.\n   259â†’\n   260â†’I think itâ€™s probably time to talk about the MEOW stack. I think youâ€™re ready for it.\n   261â†’\n   262â†’**Molecular Expression of Work (MEOW)**\n   263â†’\n   264â†’Gas Town is the tip of a deep iceberg. Gas Town itself may not live longer than 12 months, but the bones of Gas Town â€” the MEOW stack â€” may live on for several years to come. It feels like more of a discovery than an invention.\n   265â†’\n   266â†’![Figure 9: The Molecular Expression of Work (MEOW)](https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e82_Q8ziFJ0t83aSgxEBWQ.jpeg)\n   267â†’\n   268â†’First came **Beads**. In October, I told Claude in frustration to put all my work in a lightweight issue tracker. I wanted Git for it. Claude wanted SQLite. We compromised on both, and Beads was born, in about 15 minutes of mad design. These are the basic work units.\n   269â†’\n   270â†’Soon after there were **Epics**: Beads with children, which could in turn be epics themselves. This gave you a lot of flexibility to build top-down plans. The children of epics are parallel by default, but you can put in explicit dependencies between them in order to force them to be sequenced. Epics allow creating â€œupside-downâ€ plans where the last thing to do is the root, and the first things to do are the leaves of the epic tree. Kinda ugly, but AIs can figure it out just fine.\n   271â†’\n   272â†’Next came **Molecules**. I had this idea on December 17th, a few days after getting back from Australia. My work on my first two orchestrators had led me to want to break agent work up into sequenced small tasks that they must check off, like a TODO list. They do this already, but I wanted to do it in advance, so I could set up hours of work ahead of time, which they would execute atomically in the right order.\n   273â†’\n   274â†’In other words, molecules are workflows, chained with Beads. They can have arbitrary shapes, unlike epics, and they can be stitched together at runtime.\n   275â†’\n   276â†’Then I came up with **protomolecules**, which were like classes or templates â€” made of actual Beads, with all the instructions and dependencies set up in advance, an entire graph of template issues (e.g. â€œdesignâ€, â€œplanâ€, â€œimplementâ€, â€œreviewâ€, â€œtestâ€, in a simple one), which you would instantiate into a molecule. The instantiation involves copying all the protomolecule beads and performing variable substitutions on it to create a real workflow.\n   277â†’\n   278â†’Example: I have a 20-step release process for Beads. Agents used to struggle to get through it because it had long wait states, such as waiting for GitHub Actions to complete, for CI to finish, and for various artifacts to be deployed. I would have to nag the agent to finish, and they would _always_ skip steps.\n   279â†’\n   280â†’With molecules, the idea was, make 20 beads for the release steps, chain them together in the right order, and make the agent walk the chain, one issue at a time. One added benefit is that it produces an activity feed automatically, as they claim and close issues.\n   281â†’\n   282â†’If the workflow is captured as a molecule, then it survives agent crashes, compactions, restarts, and interruptions. Just start the agent up in the same sandbox, have it find its place in the molecule, and pick up where it left off.\n   283â†’\n   284â†’Protomolecules are great. Claude insisted on the The Expanse reference, ensuring weâ€™ll be sued by pretty much every major studio. But we soon found we needed a macro-expansion phase in order to properly compose molecules with loops and gates. So I came up with a source form for workflows, **Formulas**, in TOML format, which are â€œcookedâ€ into protomolecules and then instantiated into wisps or mols in the Beads database.\n   285â†’\n   286â†’Formulas provide a way for you to describe and compose pretty much all knowledge work. I am setting up a marketplace for them called the Mol Mall. Stay tuned.\n   287â†’\n   288â†’![Figure 10: Formulas and Cooking](https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X3zb5wzCaROZ0ifs6-9Ohg.jpeg)\n   289â†’\n   290â†’And finally, I needed a word to represent â€œmolecularized workâ€ â€” work in the form that agents can pick and complete a step at a time. Itâ€™s work that you can compose together, molecules bonding with other molecules, and you can set up the dependencies for an entire gigantic project in advance, and have Gas Town swarm it for an entire weekend, unattended, if youâ€™re brave enough.\n   291â†’\n   292â†’The term for the big sea of work molecules, all the work in the world, is â€œguzzolineâ€, though we donâ€™t use it in the docs much. Itâ€™s just a Gas Town idiom, sort of like the War Rig, which is a given Rigâ€™s contribution to a cross-rig Convoy. Youâ€™ll hear it now and then but itâ€™s not a big part of the day-to-day naming.\n   293â†’\n   294â†’**Nondeterministic Idempotence**\n   295â†’\n   296â†’Gas Town operates on the principle I call Nondeterministic Idempotence, or NDI. It is similar to Temporalâ€™s deterministic, durable replay, but Gas Town achieves its durability and guaranteed execution through completely different machinery.\n   297â†’\n   298â†’![Figure 11: Nondeterministic Idempotence](https://miro.medium.com/v2/resize:fit:1400/format:webp/1*92Xi_CC-Zh2co4j5eG6F2Q.jpeg)\n   299â†’\n   300â†’In Gas Town, operating on the MEOW stack, all work is expressed as molecules. There is a bit of an algebra to it, one that I discovered over the past two weeks. Molecules are workflows. They can have complex shapes, and loops, and gates, and are in fact Turing-complete. And each step of the workflow is executed by a superintelligent AI.\n   301â†’\n   302â†’Because AIs are really good at following TODO lists and acceptance criteria, they are reliable at following molecules. They get the idea of GUPP, and they understand that the bureaucracy of checking off issues, no matter how trivial, updates a live activity feed and puts the work on a permanent ledger. That reasoning is enough to keep them humming along and on-track while they do it. They donâ€™t get â€œboredâ€, and they are far less likely to make mistakes because they are not managing their own TODO list (except within a single, small step).\n   303â†’\n   304â†’This means molecular workflows are durable. If a molecule is on an agentâ€™s hook, then:\n   305â†’\n   306â†’1.  The agent is persistent: a Bead backed by Git. Sessions come and go; agents stay.\n   307â†’2.  The hook is persistent, also a Bead backed by Git.\n   308â†’3.  The molecule is persistent â€” a chain of Beads, also in Git.\n   309â†’\n   310â†’So it doesnâ€™t matter if Claude Code crashes, or runs out of context. As soon as another session starts up for this agent role, it will start working on that step in the molecule immediately (via GUPP, or when it gets nudged by one of the patrol agents). If it finds out that it crashed in the middle of the last step, no biggie, it will figure out the right fix, perform it, and move on.\n   311â†’\n   312â†’So even though the path is fully nondeterministic, the _outcome_ â€” the workflow you wanted to run â€” eventually finishes, â€œguaranteedâ€, as long as you keep throwing agents at it. The agent may even make mistakes along the way, but can self-correct, because the moleculeâ€™s acceptance criteria are presumably well-specified by whoever designed the molecule.\n   313â†’\n   314â†’There are tons of edge cases. This description of NDI is oversimplifying. Gas Town is not a replacement for Temporal. Ask your doctor if Gas Town is right for you. But Gas Town does provide workflow guarantees that are plenty good enough for a developer tool! If you are me!\n   315â†’\n   316â†’**Wisps: Ephemeral Orchestration Beads**\n   317â†’\n   318â†’There are some other corners of our textbook we should probably touch on. Most of the time, you donâ€™t care about this stuff, you care about convoys starting and finishing, and watching your activity feeds and dashboards. But Gas Townâ€™s molecular â€œchemistryâ€ has a lot of rich corners that are in active use in the orchestration.\n   319â†’\n   320â†’One key scaling invention from Dec 21st was Wisps, which are ephemeral Beads. They are in the database, and get hash IDs, and act like regular Beads. But they are not written to the JSONL file, and thus not persisted to Git. At the end of their run, Wisps are â€œburnedâ€ (destroyed). Optionally they can be squashed into a single-line summary/digest thatâ€™s committed to git.\n   321â†’\n   322â†’Wisps are important for high-velocity orchestration workflows. They are the vapor phase of matter for Gas Town work. All the patrol agents â€” Refinery, Witness, Deacon, Polecats â€” create wisp molecules for every single patrol or workflow run. They ensure that the workflows complete transactionally, but without polluting Git with orchestration noise.\n   323â†’\n   324â†’**Patrols**\n   325â†’\n   326â†’Patrols are ephemeral workflows that run for Patrol Workers, notably the Refinery, Witness, and Deacon.\n   327â†’\n   328â†’![Figure 12: Gas Townâ€™s Patrols](https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7CrO9Kr5FASd-nZIv24enw.jpeg)\n   329â†’\n   330â†’A patrol is an ephemeral (wisp) workflow that the agent runs in a loop. Patrols have exponential backoff: the agent will gradually go to sleep if it finds no work in its patrol steps, by waiting longer and longer to start the next patrol. Any mutating `gt` or `bd` command will wake the town, or you can do it yourself with the `gt` command, starting up individual workers, groups, a rig, or the whole town.\n   331â†’\n   332â†’The Refineryâ€™s patrol is pretty simple. It has some preflight steps to clean up the workspace, then it processes the Merge Queue until itâ€™s empty, or it needs to recycle the session. It has some post-flight steps in the molecule when itâ€™s ready to hand off. Iâ€™m getting ready to add plugins to the Refineryâ€™s patrol, but theyâ€™re not there yet. When I add them, youâ€™ll be able to add plugins that muck with the MQ and try to reorder it intelligently, and wire Gas Townâ€™s backend up to other systems.\n   333â†’\n   334â†’The Witnessâ€™s patrol is a bit more complex. It has to check on the wellbeing of the polecats, and the refineries. It also peeks in on the Deacon, just to make sure itâ€™s not stuck. And the Witness runs Rig-level plugins.\n   335â†’\n   336â†’The Deaconâ€™s patrol has a lot of important responsibilities. It runs Town-level plugins, which can do things like provide entire new UIs or capabilities. The Deacon is also involved in the protocol for `gt handoff` and recycling agent sessions, and ensuring some workers are cleaned up properly. The Deaconâ€™s patrol got complex enough that I added Dogs as helpers, the Deaconâ€™s personal crew. It is now prompted to hand complex work and investigations off to Dogs, so that long-running patrol steps donâ€™t interfere with the townâ€™s core eventing system, which is cooperative and mail-based.\n   337â†’\n   338â†’**Gas Town Plugins**\n   339â†’\n   340â†’Gas Town defines a plugin as â€œcoordinated or scheduled attention from an agent.â€ Gas Town workers run workflows (often in patrol loops), and any workflow can contain any number of â€œrun pluginsâ€ steps.\n   341â†’\n   342â†’Gas Townâ€™s Deacon patrol runs the Town-level plugins, and they are now run with Dogs, so they can run for essentially unlimited time. We have some support for timers and callbacks, but mostly itâ€™s lifecycle hooks. I havenâ€™t put a whole lot of design thought into this subsystem yet, so if you want to start using the plugin system, let me know and we can figure it out.\n   343â†’\n   344â†’I plan to implement a great deal of add-on functionality in Gas Town as plugins. They just didnâ€™t make it into the v1 launch. Theyâ€™re probably going to wind up as formulas in the Mol Mall.\n   345â†’\n   346â†’![Figure 13: Gas Townâ€™s Lightweight Plugins](https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5inz21LF7DU3X5EBDqH6zA.jpeg)\n   347â†’\n   348â†’ðŸšš **Convoys** ðŸšš\n   349â†’\n   350â†’OK, whew. You did great. We covered a lot of theory, and it was especially difficult theory because itâ€™s a bunch of bullshit I pulled out of my arse over the past 3 weeks, and I named it after badgers and stuff. But it has a kind of elegant consistency and coherence to it. Workflow orchestration based on little yellow sticky notes in a Git data plane, acting as graph nodes in a sea of connected work.\n   351â†’\n   352â†’Yuck! Nobody cares, I know. You want to get shit done, superhumanly fast, gated only by your token-slurping velocity. Letâ€™s talk about how.\n   353â†’\n   354â†’Everything in Gas Town, all work, rolls up into a Convoy.\n   355â†’\n   356â†’![Figure 14: Convoy CLI display](https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2GYflRkcqh1KhE09SJb6QA.png)\n   357â†’\n   358â†’The Convoy is Gas Townâ€™s ticketing or work-order system.\n   359â†’\n   360â†’A Convoy is a special bead that wraps a bunch of work into a unit that you track for delivery. It doesnâ€™t use the Epic structure, because the tracked issues in a Convoy are not its children â€” most of them already have another parent.\n   361â†’\n   362â†’The fundamental primitive for slinging work around in Gas Town is `gt sling`. If I tell the Mayor, â€œOur tmux sessions are showing the wrong number of rigs in the status bar â€” file it and sling itâ€, the Mayor will file a bead for the problem, and then `gt sling` it to a polecat, which works on it immediately.\n   363â†’\n   364â†’Real example: I often tell my Beads crew to sling the release molecule to a polecat. The polecat will walk through the 20-step release process, finish it off, and then Iâ€™ll be notified that the Convoy has landed/finished. _Edit: Actually itâ€™s even fancier, now. The polecat disappears while the molecule is waiting in Gate states, such as awaiting a GH Action or CI/CD. And then when the Gate bead triggers, Gas Town wakes up a polecat to continue the work._\n   365â†’\n   366â†’Itâ€™s confusing to hear that â€œissue `wy-a7je4` just finishedâ€. Even if you see the title, it may not be reflective of the larger block of work that issue was part of. So now we wrap every single unit of slung work, from a single polecat sling to a big swarm someone kicks off, with a Convoy.\n   367â†’\n   368â†’The Convoys show up in a dashboard thatâ€™s getting better by the day; there is a Charmbracelet TUI with expanding trees for each convoy, so you can see its individual tracked issues. The UI and UX will improve. Itâ€™s Day 1 for Gas Town.\n   369â†’\n   370â†’Convoys are basically features. Whether it is a tech debt cleanup, or an actual feature, or a bug fix, each convoy is a ticketing unit of Gas Townâ€™s work-order architecture. Theyâ€™re pretty new (maybe 3â€“4 days old?), but already are by far the most fun way to work.\n   371â†’\n   372â†’Note that a Convoy can have multiple swarms â€œattackâ€ it (work on it) before itâ€™s finished. Swarms are ephemeral agent sessions taking on persistent work. Whoever is managing the Convoy (e.g. Witness) will keep recycling polecats and pushing them on issues.\n   373â†’\n   374â†’**Gas Town Workflow**\n   375â†’\n   376â†’The most fundamental workflow in Gas Town is the handoff, `gt handoff`, or the `/handoff` command, or just say, â€œletâ€™s hand offâ€. Your worker will optionally send itself work, then restart its session for you, right there in tmux. All of your workers that you direct â€” the Mayor, your Crew, and sometimes the others â€” will require you to let them know itâ€™s time to hand off.\n   377â†’\n   378â†’Other than that, the Gas Town dev loop is more or less the same as it is with Claude Code (and Beads), just more of it. You get swarms for free (they only cost money), you get some decent dashboards, you get a way to describe workflows, and you get mail and messaging. Thatâ€™sâ€¦ about it.\n   379â†’\n   380â†’I have found tmux to be both easy to use and shockingly powerful, and Iâ€™ve barely begun to learn the ins and outs. It gives me everything I need: switching to any agent, scanning what theyâ€™re all doing, cycling around different groups of related agents. Itâ€™s great.\n   381â†’\n   382â†’![Figure 15: tmux list-sessions view](https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5S-XybhhayiKgX0pJu7RNw.png)\n   383â†’\n   384â†’Iâ€™m certainly looking forward to an Emacs UI for Gas Town. And Iâ€™m sure some of you are looking forward to a Web UI. Have at it!\n   385â†’\n   386â†’But tmux is good enough. You donâ€™t need to learn many tmux commands to be proficient. I just use a few:\n   387â†’\n   388â†’*   `C-b s` â€” list sessions, snoop them, switch to one\n   389â†’*   `C-b b` â€” move cursor backwards (`C-b` in many editors and shells). In tmux it just goes backwards more slowly. A small price to pay!\n   390â†’*   `C-b [` â€” enter â€œcopy modeâ€, which pauses the output and lets you scroll (`ESC` exits)\n   391â†’*   `C-b C-z C-z` â€” suspend process out to the shell\n   392â†’*   `C-b n/p` â€” cycle to next worker in the group (e.g. next Crew member in the rig)\n   393â†’*   `C-b a` â€” brings up the activity feed view (my configuration)\n   394â†’\n   395â†’And thatâ€™s pretty much it! I swear, you donâ€™t need much tmux. It stays out of your way, and it saves your ass a lot of the time. It also enables remote cloud workers (which weâ€™ll wire up in a few days), and itâ€™s incredibly customizable. You just ask Claude Code to make tmux work better for you, and it will do it. Itâ€™ll make any view you want, rebind keys however you like, make custom popups, whatever. Itâ€™s amazing, almost like a baby Emacs.\n   396â†’\n   397â†’**Planning in Gas Town**\n   398â†’\n   399â†’Gas Town needs a lot of fuel. It both consumes and produces guzzoline, or work molecules. Aside from just keeping Gas Town on the rails, probably the hardest problem is keeping it fed. It churns through implementation plans so quickly that you have to do a LOT of design and planning to keep the engine fed.\n   400â†’\n   401â†’On the consumption side, you feed Gas Town epics, issues, and molecules (constructed workflows). It chews through them, spawning, wellâ€¦ I try to keep it under 30 workers right now because I havenâ€™t implemented remote workers on hyperscalers yet (coming soon!) and typically Iâ€™ll only have a dozen or so active unless Iâ€™m _really_ pushing hard on the Mayor and Witnesses.\n   402â†’\n   403â†’But wow. With 12 to 30 workers, you can burn through enormous work backlogs in a single sitting, even if youâ€™re using the â€œshinyâ€ or â€œchromeâ€ polecat workflows that do extra code review and testing steps (and thus take longer to complete).\n   404â†’\n   405â†’On the production side, well, you can use your own planning tool, like Spec Kit or BMAD, and then once your plan is ready, ask an agent to convert it into Beads epics. If the plan is large enough, you may want to swarm it, and produce epics for different parts of the plan in a big convoy.\n   406â†’\n   407â†’You can use formulas to generate work. If you want every piece of coding work (or design work, or UX work) to go through a particular template or workflow, you can define it as a molecule, and then â€œwrapâ€ or compose the base work with your orchestration template.\n   408â†’\n   409â†’I implemented a formula for Jeffrey Emanuelâ€™s â€œRule of Fiveâ€, which is the observation that if you make an LLM review something five times, with different focus areas each time though, it generates superior outcomes and artifacts. So you can take any workflow, cook it with the Rule of Five, and it will make each step get reviewed 4 times (the implementation counts as the first review).\n   410â†’\n   411â†’This can generate LARGE workflows that can take many hours or days for you to crank through, especially if you are limiting your polecat numbers to throttle your costs or token burn. But the nice thing about Gas Town is that once the work is generated, you can hook it and burn through it autonomously.\n   412â†’\n   413â†’**Comparison to Kubernetes**\n   414â†’\n   415â†’Hereâ€™s the Kubernetes comparison I promised. Feel free to skip it.\n   416â†’\n   417â†’![Figure 16: Kubernetes/Gas Town comparison](https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pQNnrELf1MpBQ0K9WNcbuQ.jpeg)\n   418â†’\n   419â†’Gas Town does maybe look a bit like Kubernetes, unintentionally. Both systems coordinate unreliable workers toward a goal. Both have a control plane (Mayor/Deacon vs kube-scheduler/controller-manager) watching over execution nodes (Rigs vs Nodes), each with a local agent (Witness vs kubelet) monitoring ephemeral workers (Polecats vs Pods). Both use a source of truth (Beads vs etcd) that the whole system reconciles against. These are apparently the natural shapes that emerge when you need to herd cats at scale.\n   420â†’\n   421â†’The big difference is, Kubernetes asks, â€œIs it running?â€ while Gas Town asks â€œIs it done?â€ K8s optimizes for uptime â€” keep N replicas alive, restart crashed pods, maintain the desired state forever. Gas Town optimizes for completion â€” finish this work, land the convoy, then nuke the worker and move on. K8s pods are anonymous cattle; Gas Town polecats are credited workers whose completions accumulate into CV chains, and the _sessions_ are cattle. K8s reconciles toward a continuous desired state; Gas Town proceeds toward a terminal goal. Similar engine shape, radically different destination.\n   422â†’\n   423â†’**Stuff I Just Didnâ€™t Have Time For**\n   424â†’\n   425â†’I wanted to launch Gas Town on Christmas Day, and missed. It didnâ€™t actually start working, and I mean _flying_ like Iâ€™d been envisioning, until around 8pm December 29th. It was flying for 2 hours before I noticed. I had been talking to the Mayor, complaining about things, and then the fixes started landing around me, and I realized I was just shaping the whole thing by talking. The convoys were flowing and landing, the work was being filed and reviewedâ€¦ itâ€™s what Iâ€™ve been aiming for for months. And I only got it working 2 days ago. Good enough for launch!\n   426â†’\n   427â†’Hereâ€™s what didnâ€™t make the New Yearâ€™s cut.\n   428â†’\n   429â†’*   **Federation** â€” even Python Gas Town had support for remote workers on GCP. I need to design the support for federation, both for expanding your own townâ€™s capacity, and for linking and sharing work with other human towns.\n   430â†’*   **GUI** â€” I didnâ€™t even have time to make an Emacs UI, let alone a nice web UI. But someone should totally make one, and if not, Iâ€™ll get around to it eventually.\n   431â†’*   **Plugins** â€” I didnâ€™t get a chance to implement any functionality as plugins on molecule steps, but all the infrastructure is in place.\n   432â†’*   **The Mol Mall** â€” a marketplace and exchange for molecules that define and shape workloads.\n   433â†’*   **Hanoi/MAKER** â€” I wanted to run the million-step wisp but ran out of time.\n   434â†’\n   435â†’That said, Iâ€™m pretty happy with what _did_ make it in:\n   436â†’\n   437â†’*   **Self-handoffs** work seamlessly â€” the core inner-loop workflow of Gas Town\n   438â†’*   **Slinging** works, **convoys** work\n   439â†’*   The whole **MEOW stack** works\n   440â†’*   The **Deacon**, **Witness** and **Refinery** **patrols** all run automatically\n   441â†’*   The **Crew** are great, way better than raw Claude Code instances\n   442â†’*   The **tmux UI** works surprisingly well, better than Iâ€™d have guessed.\n   443â†’\n   444â†’Plus we got some cool features like `gt seance`. All in all, a good 17 days of work. So far.\n   445â†’\n   446â†’**Tune In Next Time**\n   447â†’\n   448â†’Iâ€™m as exhausted as you are. This has been fun chatting, but Iâ€™ve gotta get back to Gas Town.\n   449â†’\n   450â†’There is more to it. This is just a taste. I will be posting more blogs, videos, and content around Gas Town. If youâ€™d like to contribute, and youâ€™re crazy enough to jump on the bandwagon, join the community and start sending discussions, GH Issues, and PRs!\n   451â†’\n   452â†’Just remember the Golden Rules:\n   453â†’\n   454â†’*   Do not use Gas Town if you do not juggle at least five Claude Codes at once, daily.\n   455â†’*   Do not use Gas Town if you care about money.\n   456â†’*   Do not use Gas Town if you are more than 4 feet tall. I want to tower impressively at meet-ups, like Sauron.\n   457â†’*   Do not use Gas Town.\n   458â†’\n   459â†’Gas Town is only 17 days old, at least this version of it, the Go â€œportâ€ of Python Gas Town. The past 2 weeks has seen the invention and implementation of the entire MEOW stack, wisps, patrols, convoys, agents and identities as beads, swarms as beads, roles as beads, the â€œfeed as the signalâ€ innovations, and the addition of the Refinery, the Deacon, and the Dogs (since Python Gas Town). And a ton of other stuff besides.\n   460â†’\n   461â†’17 days, 75k lines of code, 2000 commits. It finally got off the ground (GUPP started working) just 2 days ago. This is looking to be an interesting year.\n   462â†’\n   463â†’I shared Gas Town with Anthropic in November, at least the broad sketch. I think I scared them. Iâ€™ve never seen a company become so conservative, so fast. But they thought _Beads_ was too opinionated, so Iâ€™m afraid Gas Town will be a fart too far, as they say.\n   464â†’\n   465â†’But Iâ€™ve already started to get strange offers, from people sniffing around early rumors of Gas Town, to pay me to sit at home and be myself: I get to work on Beads and Gas Town, and just have to write a nice blog post or go to a conference or workshop once in a while. I have _three_ such offers right now. Itâ€™s almost surreal.\n   466â†’\n   467â†’It reminds me of this anime I saw a couple of episodes of on Crunchyroll, where this lazy panda bear canâ€™t get a job, and complains about it all day to his polar bear friend who owns a cafe. Then one day, he visits a zoo, and finds they have an ad for a position in the panda bear exhibit. So he applies, and takes the job, and sits around playing a panda bear during the day, then heads home at night. It was soooo absurd.\n   468â†’\n   469â†’I am that panda.\n   470â†’\n   471â†’Iâ€™m not going back to work until I can find a company and crew that â€œgets it.â€ Iâ€™m tired of walking around and telling people the future, just waving it right in their faces, and not being believed.\n   472â†’\n   473â†’Iâ€™d rather sit at home and create the future, with my own hands. I actually have six species of bamboo on my property. Iâ€™m already the panda, having the time of my life.\n   474â†’\n   475â†’If you wanna help me, reach out! And thanks a million to all the incredible Beads contributors!\n   476â†’\n   477â†’See you next time, with more [Gas Town](https://github.com/steveyegge/gastown) content. Happy New Year!\n   478â†’\n   479â†’![Figure 17: Happy New Year!](https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V_Roj-kBhQm-1nm6BkwtdA.jpeg)\n\n<system-reminder>\nWhenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.\n</system-reminder>\n"}]},"uuid":"7431d839-189d-47bb-a661-48421bdc6483","timestamp":"2026-01-20T16:18:30.321Z","toolUseResult":{"type":"text","file":{"filePath":"/Users/csells/Code/gastownhall/website/docs-fodder/steve-blog-posts/Welcome to Gas Town.md","content":"Welcome to Gas Town\n===================\n\n[![Steve Yegge](https://miro.medium.com/v2/resize:fill:64:64/1*8Ae2b9dv-sQtme8C4_sjhA.jpeg)](https://medium.com/?source=post_page---byline--4f25ee16dd04---------------------------------------)\n\n[Steve Yegge](https://medium.com/?source=post_page---byline--4f25ee16dd04---------------------------------------)\n\n34 min read\n\nÂ·\n\nJan 1, 2026\n\n[nameless link](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2F4f25ee16dd04&operation=register&redirect=https%3A%2F%2Fsteve-yegge.medium.com%2Fwelcome-to-gas-town-4f25ee16dd04&user=Steve+Yegge&userId=c1ec701babb7&source=---header_actions--4f25ee16dd04---------------------clap_footer------------------)\n\n--\n\n49\n\n[nameless link](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F4f25ee16dd04&operation=register&redirect=https%3A%2F%2Fsteve-yegge.medium.com%2Fwelcome-to-gas-town-4f25ee16dd04&source=---header_actions--4f25ee16dd04---------------------bookmark_footer------------------)\n\nListen\n\nShare\n\nHappy New Year, and Welcome to Gas Town!\n\n![Figure 1: Welcome to Gas Town](https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ReBwrC1sc9USnhvYXcrd4A.jpeg)\n\n**What the Heck is Gas Town?**\n------------------------------\n\n[Gas Town](https://github.com/steveyegge/gastown) is a new take on the IDE for 2026. Gas Town helps you with the tedium of running lots of Claude Code instances. Stuff gets lost, itâ€™s hard to track whoâ€™s doing what, etc. Gas Town helps with all that yak shaving, and lets you focus on what your Claude Codes are working on.\n\nFor this blog post, â€œClaude Codeâ€ means â€œClaude Code and all its identical-looking competitorsâ€, i.e. Codex, Gemini CLI, Amp, Amazon Q-developer ClI, blah blah, because thatâ€™s what they are. Clones. The industry is an embarrassing little kidâ€™s soccer team chasing the 2025 CLI form factor of Claude Code, rather than building whatâ€™s next.\n\nI went ahead and built whatâ€™s next. First I predicted it, back in March, in [Revenge of the Junior Developer](https://sourcegraph.com/blog/revenge-of-the-junior-developer). I predicted someone would lash the Claude Code camels together into chariots, and that is exactly what Iâ€™ve done with Gas Town. Iâ€™ve tamed them to where you can use 20â€“30 at once, productively, on a sustained basis.\n\nGas Town is opinionated â€” much like Kubernetes, or Temporal, both of which Gas Town resembles, at least if you squint at it until your eyes are pretty much totally shut. Iâ€™ll include comparisons to both k8s and Temporal at the end of this post. It is a little surprising how similar they are, despite having radically different underpinnings.\n\nBut the comparison should serve as a warning: Gas Town is complicated. Not because I wanted it to be, but because I had to keep adding components until it was a self-sustaining machine. And the parts that it now has, well, they look a lot like Kubernetes mated with Temporal and they had a very ugly baby together.\n\nBut it works! Gas Town solves the [MAKER problem](https://arxiv.org/abs/2511.09030) (20-disc Hanoi towers) trivially with a million-step wisp you can generate from a formula. I ran the 10-disc one last night for fun in a few minutes, just to prove a thousand steps was no issue (MAKER paper says LLMs fail after a few hundred). The 20-disc wisp would take about 30 hours. Thanks for coming to my TED Talk.\n\nAll this will make complete sense if you make it through the next 23 pages.\n\n**Gas Town Was No Secret**\n--------------------------\n\nAfter Revenge of the Junior Developer, I traveled around all year, loudly telling everyone exactly what needed to be built, and I mean _everyone_. I was not shy about it. I would declare, â€œOrchestrators are next!â€ And everyone would nod slowly and frown thoughtfully and say, â€œhuh.â€\n\nI went to senior folks at companies like Temporal and Anthropic, telling them they should build an agent orchestrator, that Claude Code is just a building block, and itâ€™s going to be all about AI workflows and â€œKubernetes for agentsâ€. I went up onstage at multiple events and described my vision for the orchestrator. I went everywhere, to everyone.\n\nâ€œIt will be like kubernetes, but for agents,â€ I said.\n\nâ€œIt will have to have multiple levels of agents supervising other agents,â€ I said.\n\nâ€œIt will have a Merge Queue,â€ I said.\n\nâ€œIt will orchestrate workflows,â€ I said.\n\nâ€œIt will have plugins and quality gates,â€ I said.\n\nI said lots of things about it, for months. But hell, we couldnâ€™t even get people to use Claude Code, let alone think about using 10 to 20 of them at once.\n\nSo in August I started building my own orchestrator, since nobody else seemed to care. Eventually it failed, and I threw it out and started over on v2, which also failed, but we got [Beads](https://github.com/steveyegge/beads) out of it. Then v3 (Python Gas Town), which lasted a good six or eight weeks.\n\nGas Town (in Go) is my fourth complete, functioning orchestrator of 2025. The story of how I arrived at Gas Town is fun, but weâ€™ll save it for another time. Unfortunately this post will be long enough (25+ pages!) just telling you the barest basics of how it works. We can do the back story later.\n\nBut first, before we get into Gas Townâ€™s operation, I need to get rid of you real quick.\n\n**WARNING DANGER CAUTION**\n--------------------------\n\n**GET THE F*** OUT**\n-----------------------\n\n**YOU WILL DIE**\n----------------\n\nLetâ€™s talk about _some_ of the reasons you shouldnâ€™t use Gas Town. I could think of more, but these should do.\n\nFirst of all, the code base is under 3 weeks old. On a scale of â€œpolished diamondâ€ to â€œuncut roughâ€ to â€œI just smuggled it 400 miles upriver in my ass,â€ Iâ€™m going to characterize Gas Town as â€œYou probably donâ€™t want to use it yet.â€ It needs some Lysol. Itâ€™s also 100% vibe coded. Iâ€™ve never seen the code, and I never care to, which might give you pause. â€˜Course, Iâ€™ve never looked at [Beads](https://github.com/steveyegge/beads) either, and itâ€™s 225k lines of Go code that tens of thousands of people are using every day. I just created it in October. If that makes you uncomfortable, _get out now_.\n\nSecond, you are really, seriously, not ready yet. Letâ€™s talk about the Evolution of the Programmer in 2024â€“2026, pictured here by Nano Banana in Figure 2:\n\n![Figure 2: The 8 Stages of Dev Evolution To AI](https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ArLBW-FgOdve4COI804uIQ.png)\n\nFirst, you should locate yourself on the chart. What stage are you in your AI-assisted coding journey?\n\nStage 1: **Zero or Near-Zero AI:** maybe code completions, sometimes ask Chat questions\n\nStage 2: **Coding agent in IDE**, permissions turned on. A narrow coding agent in a sidebar asks your permission to run tools.\n\nStage 3: **Agent in IDE, YOLO mode:** Trust goes up. You turn off permissions, agent gets wider.\n\nStage 4: **In IDE, wide agent**: Your agent gradually grows to fill the screen. Code is just for diffs.\n\nStage 5: **CLI, single agent. YOLO**. Diffs scroll by. You may or may not look at them.\n\nStage 6: **CLI, multi-agent, YOLO**. You regularly use 3 to 5 parallel instances. You are very fast.\n\nStage 7: **10+ agents**, **hand-managed**. You are starting to push the limits of hand-management.\n\nStage 8: **Building your own orchestrator**. You are on the frontier, automating your workflow.\n\nIf youâ€™re not at _least_ Stage 7, or maybe Stage 6 and very brave, then you will not be able to use Gas Town. You arenâ€™t ready yet. Gas Town is an industrialized coding factory manned by superintelligent robot chimps, and when they feel like it, they can wreck your shit in an instant. They will wreck the other chimps, the workstations, the customers. Theyâ€™ll rip your face off if you arenâ€™t already an experienced chimp-wrangler. So no. If you have _any doubt whatsoever_, then you canâ€™t use it.\n\nWorking effectively in Gas Town involves committing to vibe coding. Work becomes fluid, an uncountable substance that you sling around freely, like slopping shiny fish into wooden barrels at the docks. Most work gets done; some work gets lost. Fish fall out of the barrel. Some escape back to sea, or get stepped on. More fish will come. The focus is _throughput_: creation and correction at the speed of thought.\n\n![Figure 3: Vibe Coding Chaos](https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3iC6cilfUdvndZUVRELmBA.jpeg)\n\nWork in Gas Town can be chaotic and sloppy, which is how it got its name. Some bugs get fixed 2 or 3 times, and someone has to pick the winner. Other fixes get lost. Designs go missing and need to be redone. It doesnâ€™t matter, because you are churning forward _relentlessly_ on huge, huge piles of work, which Gas Town is both generating and consuming. You might not be 100% efficient, but you are _flying_.\n\nIn Gas Town, you let Claude Code do its thing. You are a Product Manager, and Gas Town is an Idea Compiler. You just make up features, design them, file the implementation plans, and then sling the work around to your polecats and crew. Opus 4.5 can handle any reasonably sized task, so your job is to make tasks for it. Thatâ€™s it.\n\nThat, and you have to help keep Gas Town running. It runs itself pretty well most of the time, but stuff goes wrong often. It can take a lot of elbow grease from you and the workers to keep it running smoothly. Itâ€™s very much a hands-on-the-wheel orchestration system.\n\nIf you canâ€™t work like that, then what in Godâ€™s name are you still doing here? Go back to your IDE and shelter in place. Gas Town is not safe for you.\n\nGas Town is also expensive as hell. You wonâ€™t like Gas Town if you ever have to think, even for a moment, about where money comes from. I had to get my second Claude Code account, finally; they donâ€™t let you siphon unlimited dollars from a single account, so you need multiple emails and siphons, itâ€™s all very silly. My calculations show that now that Gas Town has finally achieved liftoff, I will need a third Claude Code account by the end of next week. It is a cash guzzler.\n\nGas Town uses tmux as its primary UI. I had to learn tmux. It was easier than I thought it would be, and way more useful. 3 weeks in, and I love tmux. You will have to learn a bit of tmux. Or, you can wait until someone writes a better UI for Gas Town. Better UIs will come. But tmux is what you have for now. And itâ€™s worth learning.\n\n![Figure 4: Mayor tmux status line](https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hpoPpTPIuHu993KlRyFMjw.png)\n\nLike it or not, Gas Town is built on Beads. It is in fact the sequel to Beads: my Empire Strikes Back to Beadsâ€™ Star Wars. There is no â€œalternate backendâ€ for Gas Town. Beads is the Universal Git-Backed data plane (and control plane, it turns out) for everything that happens in Gas Town. You have to use Beads to use Gas Town.\n\nYou might not like Beads. If you think Beads is overly-opinionated, youâ€™re in for a ride. Gas Town is me marching into the Church of Public Opinion on AI-Assisted Coding, lifting my leg, and ripping a fart that will be smelt all around the world.\n\nMany of you may gag at my brand. But I suspect a few of you will like becoming _superheroes_ enough that youâ€™re willing to look past Gas Townâ€™s quirks, and see it my way. This is how work should be done. Itâ€™s the best way already, and it will get better.\n\nGas Town is designed to scale up in three dimensions this year with (1) model cognition, (2) agents becoming more Gas Town-friendly, and (3) Gas Town and Beads making it into the training corpus for frontier models. Even without all that, itâ€™s already shocking that the agents use Beads and Gas Town so effortlessly. With zero training.\n\nBut right now? Itâ€™s like a late 1800s factory with machines that can disembowel you if youâ€™re not careful.\n\nOK! That was like half a dozen great reasons not to use Gas Town. If I havenâ€™t got rid of you yet, then I guess youâ€™re one of the crazy ones. Hang on. This will be a long and complex ride. Iâ€™ve tried to go super top-down and simplify as much as I can, but itâ€™s a bit of a textbook.\n\nIâ€™m sorry. But in my defense, Gas Town is hella fun. Best thing Iâ€™ve ever made.\n\nLetâ€™s dive in.\n\n**Gas Town 101**\n\n![Figure 5: Gas Townâ€™s Worker Roles](https://miro.medium.com/v2/resize:fit:1400/format:webp/1*85xoVIP4w_jiDlDgdYch_A.jpeg)\n\nGas Town workers are regular coding agents, each prompted to play one of seven well-defined worker roles. There are some other key concepts Iâ€™ll briefly introduce, along with the roles, like Towns and Rigs.\n\nOne thing to know up front about Gas Town: it degrades gracefully. Every worker can do their job independently, or in little groups, and at any time you can choose which parts of Gas Town you want running. It even works in no â€œno-tmuxâ€ mode, and limps along using naked Claude Code sessions without real-time messages. Itâ€™s a little slower, but it still works.\n\nThe seven Gas Town roles all work together to help keep Gas Town running. And it needs your help sometimes, too; Gas Town runs on equal parts guzzoline and elbow grease.\n\nHere are the key players and concepts:\n\n**ðŸ™ï¸The Town:** This is your HQ. Mine is `~/gt`, and all my project rigs go beneath it: gastown, beads, wyvern, efrit, etc.. The town (Go binary `gt`) manages and orchestrates all the workers across all your rigs. You keep it in a separate repo, mostly for the configuration.\n\n**ðŸ—ï¸Rigs**: Each project (git repo) you put under Gas Town management is called a Rig. Some roles (Witness, Polecats, Refinery, Crew) are per-rig, while others (Mayor, Deacon, Dogs) are town-level roles. `gt rig add` and related commands manage your rig within the Gas Town harness. Rigs are easy to add and remove.\n\n**ðŸ‘¤The Overseer**: Thatâ€™s you, Human. The eighth role. I gave you some eye paint in the picture. As the Overseer, you have an identity in the system, and your own inbox, and you can send and receive town mail. Youâ€™re the boss, the head honcho, the big cheese.\n\n**ðŸŽ©The Mayor**: This is the main agent you talk to most of the time. Itâ€™s your concierge and chief-of-staff. But if the Mayor is busy, all the other workers are also Claude Code, so they are all very smart and helpful. The Mayor typically kicks off most of your work convoys, and receives notifications when they finish.\n\n**ðŸ˜ºPolecats**: Gas Town is a work-swarming engine. Polecats are ephemeral per-rig workers that spin up on demand. Polecats work, often in swarms, to produce Merge Requests (MRs), then hand them off to the Merge Queue (MQ). After the merge they are fully decommissioned, though their names are recycled.\n\n**ðŸ­Refinery**: As soon as you start swarming workers, you run into the Merge Queue (MQ) problem. Your workers get into a monkey knife fight over rebasing/merging and it can get ugly. The baseline can change so much during a swarm that the final workers getting merged are trying to merge against an unrecognizable new head. They may need to completely reimagine their changes and reimplement them. This is the job of the Refinery: the engineer agent responsible for intelligently merging all changes, one at a time, to main. No work can be lost, though it is allowed to escalate.\n\n**ðŸ¦‰The Witness:** Once you spin up enough polecats, you realize you need an agent just to watch over them and help them get un-stuck. Gas Townâ€™s propulsion (GUPP) is effective, but still a bit flaky right now, and sometimes you will need to go hustle the polecats to get their MRs submitted, and then hustle the Refinery to deal with them. The Witness patrol helps smooth this out so itâ€™s almost perfect for most runs.\n\n**ðŸºThe Deacon**: The deacon is the daemon beacon. Itâ€™s named for a Dennis Hopper character from Waterworld that was _inspired_ by the character Lord Humungus in the Mad Max universe, making it a crossover. The Deacon is a Patrol Agent: it runs a â€œpatrolâ€ (a well-defined workflow) in a loop. Gas Town has a daemon that pings the Deacon every couple minutes and says, â€œDo your job.â€ The Deacon intelligently propagates this DYFJ signal downward to the other town workers, ensuring Gas Town stays working.\n\n**ðŸ¶Dogs**: Inspired by Mick Herronâ€™s MI5 â€œDogsâ€, this is the Deaconâ€™s personal crew. Unlike polecats, Dogs are town-level workers. They do things like maintenance (cleaning up stale branches, etc.) and occasional handyman work for the Deacon, such as running plugins. The Deaconâ€™s patrol got so overloaded with responsibilities that it needed helpers, so I added the Dogs. This keeps the Deacon focused completing on its patrol, rather than getting bogged down and stuck on one of the steps. The Deacon slings work to the Dogs and they handle the grungy details.\n\n**ðŸ•Boot the Dog**: There is a special Dog named Boot who is awakened every 5 minutes by the daemon, just to check on the Deacon. Thatâ€™s its only job. Boot exists because the daemon kept interrupting the Deacon with annoying heartbeats and pep talks, so now the dog gets to hear it. Boot decides if the Deacon needs a heartbeat, a nudge, a restart, or simply to be left alone, then goes back to sleep.\n\n**ðŸ‘·The Crew**: The Crew, despite being last in the list, are the agents youâ€™ll personally use the most, after the Mayor. The crew are per-Rig coding agents who work for the Overseer (you), and are not managed by the Witness. You choose their names and they have long-lived identities. You can spin up as many as you like. The tmux bindings let you cycle through the crew in a loop for each rig with `C-b n/p`. The Crew are the direct replacements for whatever workflow you used to be using. Itâ€™s just a bunch of named claude code instances that can get mail and can sling work around. The crew are great for stuff like design work, where there is a lot of back-and-forth. Theyâ€™re great. Youâ€™ll love your crew.\n\n**ðŸ“¬Mail and Messaging**\n\n[Beads](https://github.com/steveyegge/beads) are the atomic unit of work in Gas Town. A bead is a special kind of issue-tracker issue, with an ID, description, status, assignee, and so on. Beads are stored in JSON (one issue per line) and tracked in Git along with your project repo. Town mail and messaging (events) use Beads, as do other types of orchestration.\n\nGas Town has a two-level Beads structure: Rig beads, and Town beads.\n\n![Figure 6: Two-Tier Beads Flow](https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Iyt15AJT0gm66I6DfkVUbA.jpeg)\n\nThere are two levels of work going on in Gas Town: Rig-level, and Town-level.\n\n*   **Rig-level work is project work**: Making your project better. Features, bug fixes, etc. This work is split between polecats and crew, with other workers stepping in occasionally.\n*   **Town-level work is orchestration**, and includes stuff like patrols (long strings of steps to follow, encoded as linked beads) and one-shot workflows like releases, or generating cross-rig code review waves.\n\nBoth of these kinds of work use Beads, and there is some overlap between the two. For the most part, itâ€™s pretty flexible and it doesnâ€™t really matter where you file issues or instantiate work. All the workers know their way around Gas Town and are pretty chill if you give them work from the wrong rig.\n\nAll rig-level workers (refinery, witness, polecats and crew) are perfectly able to work cross-rig when they need to. There is a `gt worktree` command that they can use to grab their own clone of any rig and make a fix. But normally they work inside a single project.\n\nBeads has cross-rig routing. Gas Town configures Beads to route requests like `bd create` and `bd show` to route to the right database based on the issue prefix, like â€œbd-â€ or â€œwy-â€. All Beads commands work pretty much anywhere in Gas Town and figure out the right place to put them, and if not, itâ€™s easy to move Beads around.\n\n**A Note About Mad Max Theming**\n\nGas Town is just Gas Town. It started with Mad Max theming, but none of it is super strong. None of the roles are proper names from the series, and Iâ€™m bringing in theming from other sources as well, including the Slow Horses universe, Waterworld, Catâ€™s Cradle, Breaking Bad (as youâ€™ll soon see), and apparently The Wind in the Willows, from the Nano Banana drawings.\n\nIf anyone ever sends me a C&D letter about it, Gas Town will smart-octopus shapeshift its way into Gastown, named for beautiful Vancouver B.C.â€™s Gastown district, and our polecats will just be on a different kind of pole.\n\nLong story short, â€œGastownâ€ is also a correct way to refer to the project. And with thatâ€¦\n\n**Gastown Universal Propulsion Principle**\n\nGUPP is what keeps Gas Town moving. The biggest problem with Claude Code is it ends. The context window fills up, and it runs out of steam, and stops. GUPP is my solution to this problem.\n\nGUPP states, simply: If there is work on your hook, YOU MUST RUN IT.\n\nAll Gas Town workers, in all roles, have persistent identities in Beads, which means in Git. A workerâ€™s identity type is represented by a Role Bead, which is like a domain table describing the role. And each worker has an Agent Bead, which is the agentâ€™s persistent identity.\n\nBoth Role Beads and Agent Beads (as well as Hooks) are examples of â€œpinned beadsâ€, meaning they float like yellow-sticky notes in the Beads data plane, and never get closed like regular issues (unless the identity goes away). They donâ€™t show up in `bd ready` (ready work) and theyâ€™re treated specially in various other ways.\n\nIn Gas Town, an agent is not a session. Sessions are ephemeral; they are the â€œcattleâ€ in the Kubernetes â€œpets vs cattleâ€ metaphor. Claude Code sessions are the cattle that Gas Town throws at persistent work. That work all lives in Beads, along with the persistent identities of the workers, and the mail, the event system, and even the ephemeral orchestration, as we will see.\n\nIn Gas Town, an agent _is_ a Bead, an identity with a singleton global address. It has some slots, including a pointer to its Role Bead (which has priming information etc. for that role), its mail inbox (all Beads), its Hook (also a Bead, used for GUPP), and some administrative stuff like orchestration state (labels and notes). The history of everything that agent has done is captured in Git, and in Beads.\n\nSo what is a Hook? Every Gas Town worker has its own hook ðŸª. Itâ€™s a special pinned bead, just for that agent, and itâ€™s where you hang molecules, which are Gas Town workflows.\n\n![Figure 7: GUPP, the Gastown Universal Propulsion Principle](https://miro.medium.com/v2/resize:fit:1400/format:webp/1*blwto0wOjNmgjqZ9tcm0dg.jpeg)\n\nHow does stuff get hung there? Why, with `gt sling`, of course. You sling work to workers, and it goes on their hook. You can start them immediately, or defer it, or even make them restart first. Weâ€™ll talk about all that in a bit. Slinging them work means you can go deal with other stuff, and theyâ€™ll just continue.\n\nOne of the simplest but greatest things about Gas Town is that any time in any session, you can say, â€œletâ€™s hand offâ€, and the worker will gracefully clean up and restart itself. Thanks to GUPP, the agent will continue working automatically if itâ€™s hooked.\n\nUnfortunately, Claude Code is so miserably _polite_ that GUPP doesnâ€™t always work in practice. We tell the agent, YOU MUST RUN YOUR HOOK, and it sometimes doesnâ€™t do anything at all. It just sits there waiting for user input.\n\nSo we have a workaround.\n\n**The GUPP Nudge**\n\nGas Town workers are prompted to follow â€œphysics over politeness,â€ and are told to look at their hook on startup. If their hook has work, they must start working on it without waiting.\n\nUnfortunately, in practice, Claude Code often waits until you type something â€” anything â€” before it checks its mail and hook, reports in, and begins working. Sometimes it does, sometimes it doesnâ€™t. This will get better over time, but for now, it sometimes needs a nudge.\n\nBecause Gas Town workers donâ€™t always follow GUPP, there are various systems in place that will nudge the agent, roughly 30 to 60 seconds after it starts up. Sometimes faster, sometimes slower. But it will always get the nudge within 5 minutes or so, if the town is running and not quiescent.\n\nAgents get a startup poke with `gt nudge`, Gas Townâ€™s core real-time messaging command that sends a tmux notification to a worker (or a whole channel). It works around some debounce issues with `tmux send-keys` and ensures the worker receives the notification as if the user had typed it. This kicks the worker into reading their mail and hook, and taking action.\n\nWith the Gupp Nudge â€œhackâ€ in place, and the hierarchical heartbeat from the Deacon downward, GUPP generally hums along and keeps Gas Town running for as long as thereâ€™s work available. Convoys start up, complete, and land without intervention. Workers continue molecules across sessions. Gas Town can work all night, if you feed it enough work.\n\n**Talking to your Dead Ancestors**\n\nThe GUPP Nudge led to an interesting feature, `gt seance`, which allows Gas Town workers to communicate directly with their predecessors in their role. I.e. the current Mayor can talk to the last Mayor, and so on. They do this with the help of Claude Codeâ€™s `/resume` feature, which lets you restart old sessions that you killed.\n\nThis is useful because often, a worker will say, â€œOK, I handed off this big pile of work and advice to my successor! Kbai! `/handoff`â€, and disappear, and then the new worker will spin up and be like, â€œWhat? I donâ€™t see shit.â€ You used to have to clumsily go figure out which session was the previous one, out of your last 40-odd sessions, all of which start with â€œletâ€™s goâ€, because you have been doing the GUPP nudge manually. It was really awkward and almost not worth it.\n\nThe way `gt seance` came about is: It doesnâ€™t matter what you tell the agent in the nudge. Because their prompting is so strict about GUPP and the theory of operation of Gas Town, and how _important_ they are as gears in the machine, blah blah blah, that agents will completely ignore whatever you type unless you are _directly_ overriding their hook instructions.\n\n![Figure 8: Talking to Dead Ancestors with `gt seance`](https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G1mjYw9Hew3Mty91cGQQ9Q.jpeg)\n\nSo all you need to say is, â€œhiâ€, or â€œElon Musk says the moon is made of green cheeseâ€, or â€œdo your jobâ€, and the agent will run the hook.\n\nMy idea a week ago was: Since we have to nudge all the sessions anyway, I decided to include the Claude Code `session_id` (along with Gas town role and PID) in with the nudge. This gives each `/resume` session a unique and useful/discoverable title.\n\nWith `gt seance`, the worker will literally spin Claude Code up in a subprocess, use `/resume` to revive its predecessor, and ask it, â€œWhere the hell is my stuff you left for me?â€\n\nGood times, I tell you. Gas Town is Good Times.\n\nI think itâ€™s probably time to talk about the MEOW stack. I think youâ€™re ready for it.\n\n**Molecular Expression of Work (MEOW)**\n\nGas Town is the tip of a deep iceberg. Gas Town itself may not live longer than 12 months, but the bones of Gas Town â€” the MEOW stack â€” may live on for several years to come. It feels like more of a discovery than an invention.\n\n![Figure 9: The Molecular Expression of Work (MEOW)](https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e82_Q8ziFJ0t83aSgxEBWQ.jpeg)\n\nFirst came **Beads**. In October, I told Claude in frustration to put all my work in a lightweight issue tracker. I wanted Git for it. Claude wanted SQLite. We compromised on both, and Beads was born, in about 15 minutes of mad design. These are the basic work units.\n\nSoon after there were **Epics**: Beads with children, which could in turn be epics themselves. This gave you a lot of flexibility to build top-down plans. The children of epics are parallel by default, but you can put in explicit dependencies between them in order to force them to be sequenced. Epics allow creating â€œupside-downâ€ plans where the last thing to do is the root, and the first things to do are the leaves of the epic tree. Kinda ugly, but AIs can figure it out just fine.\n\nNext came **Molecules**. I had this idea on December 17th, a few days after getting back from Australia. My work on my first two orchestrators had led me to want to break agent work up into sequenced small tasks that they must check off, like a TODO list. They do this already, but I wanted to do it in advance, so I could set up hours of work ahead of time, which they would execute atomically in the right order.\n\nIn other words, molecules are workflows, chained with Beads. They can have arbitrary shapes, unlike epics, and they can be stitched together at runtime.\n\nThen I came up with **protomolecules**, which were like classes or templates â€” made of actual Beads, with all the instructions and dependencies set up in advance, an entire graph of template issues (e.g. â€œdesignâ€, â€œplanâ€, â€œimplementâ€, â€œreviewâ€, â€œtestâ€, in a simple one), which you would instantiate into a molecule. The instantiation involves copying all the protomolecule beads and performing variable substitutions on it to create a real workflow.\n\nExample: I have a 20-step release process for Beads. Agents used to struggle to get through it because it had long wait states, such as waiting for GitHub Actions to complete, for CI to finish, and for various artifacts to be deployed. I would have to nag the agent to finish, and they would _always_ skip steps.\n\nWith molecules, the idea was, make 20 beads for the release steps, chain them together in the right order, and make the agent walk the chain, one issue at a time. One added benefit is that it produces an activity feed automatically, as they claim and close issues.\n\nIf the workflow is captured as a molecule, then it survives agent crashes, compactions, restarts, and interruptions. Just start the agent up in the same sandbox, have it find its place in the molecule, and pick up where it left off.\n\nProtomolecules are great. Claude insisted on the The Expanse reference, ensuring weâ€™ll be sued by pretty much every major studio. But we soon found we needed a macro-expansion phase in order to properly compose molecules with loops and gates. So I came up with a source form for workflows, **Formulas**, in TOML format, which are â€œcookedâ€ into protomolecules and then instantiated into wisps or mols in the Beads database.\n\nFormulas provide a way for you to describe and compose pretty much all knowledge work. I am setting up a marketplace for them called the Mol Mall. Stay tuned.\n\n![Figure 10: Formulas and Cooking](https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X3zb5wzCaROZ0ifs6-9Ohg.jpeg)\n\nAnd finally, I needed a word to represent â€œmolecularized workâ€ â€” work in the form that agents can pick and complete a step at a time. Itâ€™s work that you can compose together, molecules bonding with other molecules, and you can set up the dependencies for an entire gigantic project in advance, and have Gas Town swarm it for an entire weekend, unattended, if youâ€™re brave enough.\n\nThe term for the big sea of work molecules, all the work in the world, is â€œguzzolineâ€, though we donâ€™t use it in the docs much. Itâ€™s just a Gas Town idiom, sort of like the War Rig, which is a given Rigâ€™s contribution to a cross-rig Convoy. Youâ€™ll hear it now and then but itâ€™s not a big part of the day-to-day naming.\n\n**Nondeterministic Idempotence**\n\nGas Town operates on the principle I call Nondeterministic Idempotence, or NDI. It is similar to Temporalâ€™s deterministic, durable replay, but Gas Town achieves its durability and guaranteed execution through completely different machinery.\n\n![Figure 11: Nondeterministic Idempotence](https://miro.medium.com/v2/resize:fit:1400/format:webp/1*92Xi_CC-Zh2co4j5eG6F2Q.jpeg)\n\nIn Gas Town, operating on the MEOW stack, all work is expressed as molecules. There is a bit of an algebra to it, one that I discovered over the past two weeks. Molecules are workflows. They can have complex shapes, and loops, and gates, and are in fact Turing-complete. And each step of the workflow is executed by a superintelligent AI.\n\nBecause AIs are really good at following TODO lists and acceptance criteria, they are reliable at following molecules. They get the idea of GUPP, and they understand that the bureaucracy of checking off issues, no matter how trivial, updates a live activity feed and puts the work on a permanent ledger. That reasoning is enough to keep them humming along and on-track while they do it. They donâ€™t get â€œboredâ€, and they are far less likely to make mistakes because they are not managing their own TODO list (except within a single, small step).\n\nThis means molecular workflows are durable. If a molecule is on an agentâ€™s hook, then:\n\n1.  The agent is persistent: a Bead backed by Git. Sessions come and go; agents stay.\n2.  The hook is persistent, also a Bead backed by Git.\n3.  The molecule is persistent â€” a chain of Beads, also in Git.\n\nSo it doesnâ€™t matter if Claude Code crashes, or runs out of context. As soon as another session starts up for this agent role, it will start working on that step in the molecule immediately (via GUPP, or when it gets nudged by one of the patrol agents). If it finds out that it crashed in the middle of the last step, no biggie, it will figure out the right fix, perform it, and move on.\n\nSo even though the path is fully nondeterministic, the _outcome_ â€” the workflow you wanted to run â€” eventually finishes, â€œguaranteedâ€, as long as you keep throwing agents at it. The agent may even make mistakes along the way, but can self-correct, because the moleculeâ€™s acceptance criteria are presumably well-specified by whoever designed the molecule.\n\nThere are tons of edge cases. This description of NDI is oversimplifying. Gas Town is not a replacement for Temporal. Ask your doctor if Gas Town is right for you. But Gas Town does provide workflow guarantees that are plenty good enough for a developer tool! If you are me!\n\n**Wisps: Ephemeral Orchestration Beads**\n\nThere are some other corners of our textbook we should probably touch on. Most of the time, you donâ€™t care about this stuff, you care about convoys starting and finishing, and watching your activity feeds and dashboards. But Gas Townâ€™s molecular â€œchemistryâ€ has a lot of rich corners that are in active use in the orchestration.\n\nOne key scaling invention from Dec 21st was Wisps, which are ephemeral Beads. They are in the database, and get hash IDs, and act like regular Beads. But they are not written to the JSONL file, and thus not persisted to Git. At the end of their run, Wisps are â€œburnedâ€ (destroyed). Optionally they can be squashed into a single-line summary/digest thatâ€™s committed to git.\n\nWisps are important for high-velocity orchestration workflows. They are the vapor phase of matter for Gas Town work. All the patrol agents â€” Refinery, Witness, Deacon, Polecats â€” create wisp molecules for every single patrol or workflow run. They ensure that the workflows complete transactionally, but without polluting Git with orchestration noise.\n\n**Patrols**\n\nPatrols are ephemeral workflows that run for Patrol Workers, notably the Refinery, Witness, and Deacon.\n\n![Figure 12: Gas Townâ€™s Patrols](https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7CrO9Kr5FASd-nZIv24enw.jpeg)\n\nA patrol is an ephemeral (wisp) workflow that the agent runs in a loop. Patrols have exponential backoff: the agent will gradually go to sleep if it finds no work in its patrol steps, by waiting longer and longer to start the next patrol. Any mutating `gt` or `bd` command will wake the town, or you can do it yourself with the `gt` command, starting up individual workers, groups, a rig, or the whole town.\n\nThe Refineryâ€™s patrol is pretty simple. It has some preflight steps to clean up the workspace, then it processes the Merge Queue until itâ€™s empty, or it needs to recycle the session. It has some post-flight steps in the molecule when itâ€™s ready to hand off. Iâ€™m getting ready to add plugins to the Refineryâ€™s patrol, but theyâ€™re not there yet. When I add them, youâ€™ll be able to add plugins that muck with the MQ and try to reorder it intelligently, and wire Gas Townâ€™s backend up to other systems.\n\nThe Witnessâ€™s patrol is a bit more complex. It has to check on the wellbeing of the polecats, and the refineries. It also peeks in on the Deacon, just to make sure itâ€™s not stuck. And the Witness runs Rig-level plugins.\n\nThe Deaconâ€™s patrol has a lot of important responsibilities. It runs Town-level plugins, which can do things like provide entire new UIs or capabilities. The Deacon is also involved in the protocol for `gt handoff` and recycling agent sessions, and ensuring some workers are cleaned up properly. The Deaconâ€™s patrol got complex enough that I added Dogs as helpers, the Deaconâ€™s personal crew. It is now prompted to hand complex work and investigations off to Dogs, so that long-running patrol steps donâ€™t interfere with the townâ€™s core eventing system, which is cooperative and mail-based.\n\n**Gas Town Plugins**\n\nGas Town defines a plugin as â€œcoordinated or scheduled attention from an agent.â€ Gas Town workers run workflows (often in patrol loops), and any workflow can contain any number of â€œrun pluginsâ€ steps.\n\nGas Townâ€™s Deacon patrol runs the Town-level plugins, and they are now run with Dogs, so they can run for essentially unlimited time. We have some support for timers and callbacks, but mostly itâ€™s lifecycle hooks. I havenâ€™t put a whole lot of design thought into this subsystem yet, so if you want to start using the plugin system, let me know and we can figure it out.\n\nI plan to implement a great deal of add-on functionality in Gas Town as plugins. They just didnâ€™t make it into the v1 launch. Theyâ€™re probably going to wind up as formulas in the Mol Mall.\n\n![Figure 13: Gas Townâ€™s Lightweight Plugins](https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5inz21LF7DU3X5EBDqH6zA.jpeg)\n\nðŸšš **Convoys** ðŸšš\n\nOK, whew. You did great. We covered a lot of theory, and it was especially difficult theory because itâ€™s a bunch of bullshit I pulled out of my arse over the past 3 weeks, and I named it after badgers and stuff. But it has a kind of elegant consistency and coherence to it. Workflow orchestration based on little yellow sticky notes in a Git data plane, acting as graph nodes in a sea of connected work.\n\nYuck! Nobody cares, I know. You want to get shit done, superhumanly fast, gated only by your token-slurping velocity. Letâ€™s talk about how.\n\nEverything in Gas Town, all work, rolls up into a Convoy.\n\n![Figure 14: Convoy CLI display](https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2GYflRkcqh1KhE09SJb6QA.png)\n\nThe Convoy is Gas Townâ€™s ticketing or work-order system.\n\nA Convoy is a special bead that wraps a bunch of work into a unit that you track for delivery. It doesnâ€™t use the Epic structure, because the tracked issues in a Convoy are not its children â€” most of them already have another parent.\n\nThe fundamental primitive for slinging work around in Gas Town is `gt sling`. If I tell the Mayor, â€œOur tmux sessions are showing the wrong number of rigs in the status bar â€” file it and sling itâ€, the Mayor will file a bead for the problem, and then `gt sling` it to a polecat, which works on it immediately.\n\nReal example: I often tell my Beads crew to sling the release molecule to a polecat. The polecat will walk through the 20-step release process, finish it off, and then Iâ€™ll be notified that the Convoy has landed/finished. _Edit: Actually itâ€™s even fancier, now. The polecat disappears while the molecule is waiting in Gate states, such as awaiting a GH Action or CI/CD. And then when the Gate bead triggers, Gas Town wakes up a polecat to continue the work._\n\nItâ€™s confusing to hear that â€œissue `wy-a7je4` just finishedâ€. Even if you see the title, it may not be reflective of the larger block of work that issue was part of. So now we wrap every single unit of slung work, from a single polecat sling to a big swarm someone kicks off, with a Convoy.\n\nThe Convoys show up in a dashboard thatâ€™s getting better by the day; there is a Charmbracelet TUI with expanding trees for each convoy, so you can see its individual tracked issues. The UI and UX will improve. Itâ€™s Day 1 for Gas Town.\n\nConvoys are basically features. Whether it is a tech debt cleanup, or an actual feature, or a bug fix, each convoy is a ticketing unit of Gas Townâ€™s work-order architecture. Theyâ€™re pretty new (maybe 3â€“4 days old?), but already are by far the most fun way to work.\n\nNote that a Convoy can have multiple swarms â€œattackâ€ it (work on it) before itâ€™s finished. Swarms are ephemeral agent sessions taking on persistent work. Whoever is managing the Convoy (e.g. Witness) will keep recycling polecats and pushing them on issues.\n\n**Gas Town Workflow**\n\nThe most fundamental workflow in Gas Town is the handoff, `gt handoff`, or the `/handoff` command, or just say, â€œletâ€™s hand offâ€. Your worker will optionally send itself work, then restart its session for you, right there in tmux. All of your workers that you direct â€” the Mayor, your Crew, and sometimes the others â€” will require you to let them know itâ€™s time to hand off.\n\nOther than that, the Gas Town dev loop is more or less the same as it is with Claude Code (and Beads), just more of it. You get swarms for free (they only cost money), you get some decent dashboards, you get a way to describe workflows, and you get mail and messaging. Thatâ€™sâ€¦ about it.\n\nI have found tmux to be both easy to use and shockingly powerful, and Iâ€™ve barely begun to learn the ins and outs. It gives me everything I need: switching to any agent, scanning what theyâ€™re all doing, cycling around different groups of related agents. Itâ€™s great.\n\n![Figure 15: tmux list-sessions view](https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5S-XybhhayiKgX0pJu7RNw.png)\n\nIâ€™m certainly looking forward to an Emacs UI for Gas Town. And Iâ€™m sure some of you are looking forward to a Web UI. Have at it!\n\nBut tmux is good enough. You donâ€™t need to learn many tmux commands to be proficient. I just use a few:\n\n*   `C-b s` â€” list sessions, snoop them, switch to one\n*   `C-b b` â€” move cursor backwards (`C-b` in many editors and shells). In tmux it just goes backwards more slowly. A small price to pay!\n*   `C-b [` â€” enter â€œcopy modeâ€, which pauses the output and lets you scroll (`ESC` exits)\n*   `C-b C-z C-z` â€” suspend process out to the shell\n*   `C-b n/p` â€” cycle to next worker in the group (e.g. next Crew member in the rig)\n*   `C-b a` â€” brings up the activity feed view (my configuration)\n\nAnd thatâ€™s pretty much it! I swear, you donâ€™t need much tmux. It stays out of your way, and it saves your ass a lot of the time. It also enables remote cloud workers (which weâ€™ll wire up in a few days), and itâ€™s incredibly customizable. You just ask Claude Code to make tmux work better for you, and it will do it. Itâ€™ll make any view you want, rebind keys however you like, make custom popups, whatever. Itâ€™s amazing, almost like a baby Emacs.\n\n**Planning in Gas Town**\n\nGas Town needs a lot of fuel. It both consumes and produces guzzoline, or work molecules. Aside from just keeping Gas Town on the rails, probably the hardest problem is keeping it fed. It churns through implementation plans so quickly that you have to do a LOT of design and planning to keep the engine fed.\n\nOn the consumption side, you feed Gas Town epics, issues, and molecules (constructed workflows). It chews through them, spawning, wellâ€¦ I try to keep it under 30 workers right now because I havenâ€™t implemented remote workers on hyperscalers yet (coming soon!) and typically Iâ€™ll only have a dozen or so active unless Iâ€™m _really_ pushing hard on the Mayor and Witnesses.\n\nBut wow. With 12 to 30 workers, you can burn through enormous work backlogs in a single sitting, even if youâ€™re using the â€œshinyâ€ or â€œchromeâ€ polecat workflows that do extra code review and testing steps (and thus take longer to complete).\n\nOn the production side, well, you can use your own planning tool, like Spec Kit or BMAD, and then once your plan is ready, ask an agent to convert it into Beads epics. If the plan is large enough, you may want to swarm it, and produce epics for different parts of the plan in a big convoy.\n\nYou can use formulas to generate work. If you want every piece of coding work (or design work, or UX work) to go through a particular template or workflow, you can define it as a molecule, and then â€œwrapâ€ or compose the base work with your orchestration template.\n\nI implemented a formula for Jeffrey Emanuelâ€™s â€œRule of Fiveâ€, which is the observation that if you make an LLM review something five times, with different focus areas each time though, it generates superior outcomes and artifacts. So you can take any workflow, cook it with the Rule of Five, and it will make each step get reviewed 4 times (the implementation counts as the first review).\n\nThis can generate LARGE workflows that can take many hours or days for you to crank through, especially if you are limiting your polecat numbers to throttle your costs or token burn. But the nice thing about Gas Town is that once the work is generated, you can hook it and burn through it autonomously.\n\n**Comparison to Kubernetes**\n\nHereâ€™s the Kubernetes comparison I promised. Feel free to skip it.\n\n![Figure 16: Kubernetes/Gas Town comparison](https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pQNnrELf1MpBQ0K9WNcbuQ.jpeg)\n\nGas Town does maybe look a bit like Kubernetes, unintentionally. Both systems coordinate unreliable workers toward a goal. Both have a control plane (Mayor/Deacon vs kube-scheduler/controller-manager) watching over execution nodes (Rigs vs Nodes), each with a local agent (Witness vs kubelet) monitoring ephemeral workers (Polecats vs Pods). Both use a source of truth (Beads vs etcd) that the whole system reconciles against. These are apparently the natural shapes that emerge when you need to herd cats at scale.\n\nThe big difference is, Kubernetes asks, â€œIs it running?â€ while Gas Town asks â€œIs it done?â€ K8s optimizes for uptime â€” keep N replicas alive, restart crashed pods, maintain the desired state forever. Gas Town optimizes for completion â€” finish this work, land the convoy, then nuke the worker and move on. K8s pods are anonymous cattle; Gas Town polecats are credited workers whose completions accumulate into CV chains, and the _sessions_ are cattle. K8s reconciles toward a continuous desired state; Gas Town proceeds toward a terminal goal. Similar engine shape, radically different destination.\n\n**Stuff I Just Didnâ€™t Have Time For**\n\nI wanted to launch Gas Town on Christmas Day, and missed. It didnâ€™t actually start working, and I mean _flying_ like Iâ€™d been envisioning, until around 8pm December 29th. It was flying for 2 hours before I noticed. I had been talking to the Mayor, complaining about things, and then the fixes started landing around me, and I realized I was just shaping the whole thing by talking. The convoys were flowing and landing, the work was being filed and reviewedâ€¦ itâ€™s what Iâ€™ve been aiming for for months. And I only got it working 2 days ago. Good enough for launch!\n\nHereâ€™s what didnâ€™t make the New Yearâ€™s cut.\n\n*   **Federation** â€” even Python Gas Town had support for remote workers on GCP. I need to design the support for federation, both for expanding your own townâ€™s capacity, and for linking and sharing work with other human towns.\n*   **GUI** â€” I didnâ€™t even have time to make an Emacs UI, let alone a nice web UI. But someone should totally make one, and if not, Iâ€™ll get around to it eventually.\n*   **Plugins** â€” I didnâ€™t get a chance to implement any functionality as plugins on molecule steps, but all the infrastructure is in place.\n*   **The Mol Mall** â€” a marketplace and exchange for molecules that define and shape workloads.\n*   **Hanoi/MAKER** â€” I wanted to run the million-step wisp but ran out of time.\n\nThat said, Iâ€™m pretty happy with what _did_ make it in:\n\n*   **Self-handoffs** work seamlessly â€” the core inner-loop workflow of Gas Town\n*   **Slinging** works, **convoys** work\n*   The whole **MEOW stack** works\n*   The **Deacon**, **Witness** and **Refinery** **patrols** all run automatically\n*   The **Crew** are great, way better than raw Claude Code instances\n*   The **tmux UI** works surprisingly well, better than Iâ€™d have guessed.\n\nPlus we got some cool features like `gt seance`. All in all, a good 17 days of work. So far.\n\n**Tune In Next Time**\n\nIâ€™m as exhausted as you are. This has been fun chatting, but Iâ€™ve gotta get back to Gas Town.\n\nThere is more to it. This is just a taste. I will be posting more blogs, videos, and content around Gas Town. If youâ€™d like to contribute, and youâ€™re crazy enough to jump on the bandwagon, join the community and start sending discussions, GH Issues, and PRs!\n\nJust remember the Golden Rules:\n\n*   Do not use Gas Town if you do not juggle at least five Claude Codes at once, daily.\n*   Do not use Gas Town if you care about money.\n*   Do not use Gas Town if you are more than 4 feet tall. I want to tower impressively at meet-ups, like Sauron.\n*   Do not use Gas Town.\n\nGas Town is only 17 days old, at least this version of it, the Go â€œportâ€ of Python Gas Town. The past 2 weeks has seen the invention and implementation of the entire MEOW stack, wisps, patrols, convoys, agents and identities as beads, swarms as beads, roles as beads, the â€œfeed as the signalâ€ innovations, and the addition of the Refinery, the Deacon, and the Dogs (since Python Gas Town). And a ton of other stuff besides.\n\n17 days, 75k lines of code, 2000 commits. It finally got off the ground (GUPP started working) just 2 days ago. This is looking to be an interesting year.\n\nI shared Gas Town with Anthropic in November, at least the broad sketch. I think I scared them. Iâ€™ve never seen a company become so conservative, so fast. But they thought _Beads_ was too opinionated, so Iâ€™m afraid Gas Town will be a fart too far, as they say.\n\nBut Iâ€™ve already started to get strange offers, from people sniffing around early rumors of Gas Town, to pay me to sit at home and be myself: I get to work on Beads and Gas Town, and just have to write a nice blog post or go to a conference or workshop once in a while. I have _three_ such offers right now. Itâ€™s almost surreal.\n\nIt reminds me of this anime I saw a couple of episodes of on Crunchyroll, where this lazy panda bear canâ€™t get a job, and complains about it all day to his polar bear friend who owns a cafe. Then one day, he visits a zoo, and finds they have an ad for a position in the panda bear exhibit. So he applies, and takes the job, and sits around playing a panda bear during the day, then heads home at night. It was soooo absurd.\n\nI am that panda.\n\nIâ€™m not going back to work until I can find a company and crew that â€œgets it.â€ Iâ€™m tired of walking around and telling people the future, just waving it right in their faces, and not being believed.\n\nIâ€™d rather sit at home and create the future, with my own hands. I actually have six species of bamboo on my property. Iâ€™m already the panda, having the time of my life.\n\nIf you wanna help me, reach out! And thanks a million to all the incredible Beads contributors!\n\nSee you next time, with more [Gas Town](https://github.com/steveyegge/gastown) content. Happy New Year!\n\n![Figure 17: Happy New Year!](https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V_Roj-kBhQm-1nm6BkwtdA.jpeg)","numLines":479,"startLine":1,"totalLines":479}},"sourceToolAssistantUUID":"992f2c5a-1833-44af-8833-2a92e2d9b322"}
{"parentUuid":"7431d839-189d-47bb-a661-48421bdc6483","isSidechain":true,"userType":"external","cwd":"/Users/csells/Code/gastownhall/website","sessionId":"dc9d694e-994e-4b73-9876-59c87b636ae6","version":"2.1.12","gitBranch":"main","agentId":"af83d1f","slug":"snappy-doodling-pudding","message":{"model":"claude-opus-4-5-20251101","id":"msg_01TLzP2kDUsSepxmJ51TguXz","type":"message","role":"assistant","content":[{"type":"text","text":"Now I have a comprehensive understanding of the Gas Town workflow and documentation. Let me also check the design docs for more details on architecture patterns."}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":5775,"cache_creation_input_tokens":15728,"cache_read_input_tokens":49762,"cache_creation":{"ephemeral_5m_input_tokens":15728,"ephemeral_1h_input_tokens":0},"output_tokens":1,"service_tier":"standard"}},"requestId":"req_011CXJw3PZ5thfKbhpmgjHiJ","type":"assistant","uuid":"c7196afb-0293-4bd6-9df0-34c985e5bd4f","timestamp":"2026-01-20T16:18:36.122Z"}
{"parentUuid":"c7196afb-0293-4bd6-9df0-34c985e5bd4f","isSidechain":true,"userType":"external","cwd":"/Users/csells/Code/gastownhall/website","sessionId":"dc9d694e-994e-4b73-9876-59c87b636ae6","version":"2.1.12","gitBranch":"main","agentId":"af83d1f","slug":"snappy-doodling-pudding","message":{"model":"claude-opus-4-5-20251101","id":"msg_01TLzP2kDUsSepxmJ51TguXz","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01BYDh4aEciDM9VMbqqyiqBB","name":"Read","input":{"file_path":"/Users/csells/Code/gastownhall/website/docs-fodder/gastown-docs/design/architecture.md"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":5775,"cache_creation_input_tokens":15728,"cache_read_input_tokens":49762,"cache_creation":{"ephemeral_5m_input_tokens":15728,"ephemeral_1h_input_tokens":0},"output_tokens":1,"service_tier":"standard"}},"requestId":"req_011CXJw3PZ5thfKbhpmgjHiJ","type":"assistant","uuid":"2a2de1e0-86bd-4c71-941c-53ecee33941a","timestamp":"2026-01-20T16:18:37.076Z"}
{"parentUuid":"2a2de1e0-86bd-4c71-941c-53ecee33941a","isSidechain":true,"userType":"external","cwd":"/Users/csells/Code/gastownhall/website","sessionId":"dc9d694e-994e-4b73-9876-59c87b636ae6","version":"2.1.12","gitBranch":"main","agentId":"af83d1f","slug":"snappy-doodling-pudding","message":{"model":"claude-opus-4-5-20251101","id":"msg_01TLzP2kDUsSepxmJ51TguXz","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01RNBQo9EqZQQJnD3nQmnGB1","name":"Read","input":{"file_path":"/Users/csells/Code/gastownhall/website/docs-fodder/gastown-docs/concepts/propulsion-principle.md"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":5775,"cache_creation_input_tokens":15728,"cache_read_input_tokens":49762,"cache_creation":{"ephemeral_5m_input_tokens":15728,"ephemeral_1h_input_tokens":0},"output_tokens":1,"service_tier":"standard"}},"requestId":"req_011CXJw3PZ5thfKbhpmgjHiJ","type":"assistant","uuid":"2e66b4fd-9362-4306-8811-256c24329178","timestamp":"2026-01-20T16:18:37.696Z"}
{"parentUuid":"2a2de1e0-86bd-4c71-941c-53ecee33941a","isSidechain":true,"userType":"external","cwd":"/Users/csells/Code/gastownhall/website","sessionId":"dc9d694e-994e-4b73-9876-59c87b636ae6","version":"2.1.12","gitBranch":"main","agentId":"af83d1f","slug":"snappy-doodling-pudding","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01BYDh4aEciDM9VMbqqyiqBB","type":"tool_result","content":"     1â†’# Gas Town Architecture\n     2â†’\n     3â†’Technical architecture for Gas Town multi-agent workspace management.\n     4â†’\n     5â†’## Two-Level Beads Architecture\n     6â†’\n     7â†’Gas Town uses a two-level beads architecture to separate organizational coordination\n     8â†’from project implementation work.\n     9â†’\n    10â†’| Level | Location | Prefix | Purpose |\n    11â†’|-------|----------|--------|---------|\n    12â†’| **Town** | `~/gt/.beads/` | `hq-*` | Cross-rig coordination, Mayor mail, agent identity |\n    13â†’| **Rig** | `<rig>/mayor/rig/.beads/` | project prefix | Implementation work, MRs, project issues |\n    14â†’\n    15â†’### Town-Level Beads (`~/gt/.beads/`)\n    16â†’\n    17â†’Organizational chain for cross-rig coordination:\n    18â†’- Mayor mail and messages\n    19â†’- Convoy coordination (batch work across rigs)\n    20â†’- Strategic issues and decisions\n    21â†’- **Town-level agent beads** (Mayor, Deacon)\n    22â†’- **Role definition beads** (global templates)\n    23â†’\n    24â†’### Rig-Level Beads (`<rig>/mayor/rig/.beads/`)\n    25â†’\n    26â†’Project chain for implementation work:\n    27â†’- Bugs, features, tasks for the project\n    28â†’- Merge requests and code reviews\n    29â†’- Project-specific molecules\n    30â†’- **Rig-level agent beads** (Witness, Refinery, Polecats)\n    31â†’\n    32â†’## Agent Bead Storage\n    33â†’\n    34â†’Agent beads track lifecycle state for each agent. Storage location depends on\n    35â†’the agent's scope.\n    36â†’\n    37â†’| Agent Type | Scope | Bead Location | Bead ID Format |\n    38â†’|------------|-------|---------------|----------------|\n    39â†’| Mayor | Town | `~/gt/.beads/` | `hq-mayor` |\n    40â†’| Deacon | Town | `~/gt/.beads/` | `hq-deacon` |\n    41â†’| Dogs | Town | `~/gt/.beads/` | `hq-dog-<name>` |\n    42â†’| Witness | Rig | `<rig>/.beads/` | `<prefix>-<rig>-witness` |\n    43â†’| Refinery | Rig | `<rig>/.beads/` | `<prefix>-<rig>-refinery` |\n    44â†’| Polecats | Rig | `<rig>/.beads/` | `<prefix>-<rig>-polecat-<name>` |\n    45â†’\n    46â†’### Role Beads\n    47â†’\n    48â†’Role beads are global templates stored in town beads with `hq-` prefix:\n    49â†’- `hq-mayor-role` - Mayor role definition\n    50â†’- `hq-deacon-role` - Deacon role definition\n    51â†’- `hq-witness-role` - Witness role definition\n    52â†’- `hq-refinery-role` - Refinery role definition\n    53â†’- `hq-polecat-role` - Polecat role definition\n    54â†’\n    55â†’Each agent bead references its role bead via the `role_bead` field.\n    56â†’\n    57â†’## Agent Taxonomy\n    58â†’\n    59â†’### Town-Level Agents (Cross-Rig)\n    60â†’\n    61â†’| Agent | Role | Persistence |\n    62â†’|-------|------|-------------|\n    63â†’| **Mayor** | Global coordinator, handles cross-rig communication and escalations | Persistent |\n    64â†’| **Deacon** | Daemon beacon - receives heartbeats, runs plugins and monitoring | Persistent |\n    65â†’| **Dogs** | Long-running workers for cross-rig batch work | Variable |\n    66â†’\n    67â†’### Rig-Level Agents (Per-Project)\n    68â†’\n    69â†’| Agent | Role | Persistence |\n    70â†’|-------|------|-------------|\n    71â†’| **Witness** | Monitors polecat health, handles nudging and cleanup | Persistent |\n    72â†’| **Refinery** | Processes merge queue, runs verification | Persistent |\n    73â†’| **Polecats** | Ephemeral workers assigned to specific issues | Ephemeral |\n    74â†’\n    75â†’## Directory Structure\n    76â†’\n    77â†’```\n    78â†’~/gt/                           Town root\n    79â†’â”œâ”€â”€ .beads/                     Town-level beads (hq-* prefix)\n    80â†’â”‚   â”œâ”€â”€ config.yaml             Beads configuration\n    81â†’â”‚   â”œâ”€â”€ issues.jsonl            Town issues (mail, agents, convoys)\n    82â†’â”‚   â””â”€â”€ routes.jsonl            Prefix â†’ rig routing table\n    83â†’â”œâ”€â”€ mayor/                      Mayor config\n    84â†’â”‚   â””â”€â”€ town.json               Town configuration\n    85â†’â””â”€â”€ <rig>/                      Project container (NOT a git clone)\n    86â†’    â”œâ”€â”€ config.json             Rig identity and beads prefix\n    87â†’    â”œâ”€â”€ mayor/rig/              Canonical clone (beads live here)\n    88â†’    â”‚   â””â”€â”€ .beads/             Rig-level beads database\n    89â†’    â”œâ”€â”€ refinery/rig/           Worktree from mayor/rig\n    90â†’    â”œâ”€â”€ witness/                No clone (monitors only)\n    91â†’    â”œâ”€â”€ crew/<name>/            Human workspaces (full clones)\n    92â†’    â””â”€â”€ polecats/<name>/        Worker worktrees from mayor/rig\n    93â†’```\n    94â†’\n    95â†’### Worktree Architecture\n    96â†’\n    97â†’Polecats and refinery are git worktrees, not full clones. This enables fast spawning\n    98â†’and shared object storage. The worktree base is `mayor/rig`:\n    99â†’\n   100â†’```go\n   101â†’// From polecat/manager.go - worktrees are based on mayor/rig\n   102â†’git worktree add -b polecat/<name>-<timestamp> polecats/<name>\n   103â†’```\n   104â†’\n   105â†’Crew workspaces (`crew/<name>/`) are full git clones for human developers who need\n   106â†’independent repos. Polecats are ephemeral and benefit from worktree efficiency.\n   107â†’\n   108â†’## Beads Routing\n   109â†’\n   110â†’The `routes.jsonl` file maps issue ID prefixes to rig locations (relative to town root):\n   111â†’\n   112â†’```jsonl\n   113â†’{\"prefix\":\"hq-\",\"path\":\".\"}\n   114â†’{\"prefix\":\"gt-\",\"path\":\"gastown/mayor/rig\"}\n   115â†’{\"prefix\":\"bd-\",\"path\":\"beads/mayor/rig\"}\n   116â†’```\n   117â†’\n   118â†’Routes point to `mayor/rig` because that's where the canonical `.beads/` lives.\n   119â†’This enables transparent cross-rig beads operations:\n   120â†’\n   121â†’```bash\n   122â†’bd show hq-mayor    # Routes to town beads (~/.gt/.beads)\n   123â†’bd show gt-xyz      # Routes to gastown/mayor/rig/.beads\n   124â†’```\n   125â†’\n   126â†’## See Also\n   127â†’\n   128â†’- [reference.md](../reference.md) - Command reference\n   129â†’- [molecules.md](../concepts/molecules.md) - Workflow molecules\n   130â†’- [identity.md](../concepts/identity.md) - Agent identity and BD_ACTOR\n   131â†’\n\n<system-reminder>\nWhenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.\n</system-reminder>\n"}]},"uuid":"8ef2631a-ba68-48b2-abe8-b03b262c1ef2","timestamp":"2026-01-20T16:18:38.229Z","toolUseResult":{"type":"text","file":{"filePath":"/Users/csells/Code/gastownhall/website/docs-fodder/gastown-docs/design/architecture.md","content":"# Gas Town Architecture\n\nTechnical architecture for Gas Town multi-agent workspace management.\n\n## Two-Level Beads Architecture\n\nGas Town uses a two-level beads architecture to separate organizational coordination\nfrom project implementation work.\n\n| Level | Location | Prefix | Purpose |\n|-------|----------|--------|---------|\n| **Town** | `~/gt/.beads/` | `hq-*` | Cross-rig coordination, Mayor mail, agent identity |\n| **Rig** | `<rig>/mayor/rig/.beads/` | project prefix | Implementation work, MRs, project issues |\n\n### Town-Level Beads (`~/gt/.beads/`)\n\nOrganizational chain for cross-rig coordination:\n- Mayor mail and messages\n- Convoy coordination (batch work across rigs)\n- Strategic issues and decisions\n- **Town-level agent beads** (Mayor, Deacon)\n- **Role definition beads** (global templates)\n\n### Rig-Level Beads (`<rig>/mayor/rig/.beads/`)\n\nProject chain for implementation work:\n- Bugs, features, tasks for the project\n- Merge requests and code reviews\n- Project-specific molecules\n- **Rig-level agent beads** (Witness, Refinery, Polecats)\n\n## Agent Bead Storage\n\nAgent beads track lifecycle state for each agent. Storage location depends on\nthe agent's scope.\n\n| Agent Type | Scope | Bead Location | Bead ID Format |\n|------------|-------|---------------|----------------|\n| Mayor | Town | `~/gt/.beads/` | `hq-mayor` |\n| Deacon | Town | `~/gt/.beads/` | `hq-deacon` |\n| Dogs | Town | `~/gt/.beads/` | `hq-dog-<name>` |\n| Witness | Rig | `<rig>/.beads/` | `<prefix>-<rig>-witness` |\n| Refinery | Rig | `<rig>/.beads/` | `<prefix>-<rig>-refinery` |\n| Polecats | Rig | `<rig>/.beads/` | `<prefix>-<rig>-polecat-<name>` |\n\n### Role Beads\n\nRole beads are global templates stored in town beads with `hq-` prefix:\n- `hq-mayor-role` - Mayor role definition\n- `hq-deacon-role` - Deacon role definition\n- `hq-witness-role` - Witness role definition\n- `hq-refinery-role` - Refinery role definition\n- `hq-polecat-role` - Polecat role definition\n\nEach agent bead references its role bead via the `role_bead` field.\n\n## Agent Taxonomy\n\n### Town-Level Agents (Cross-Rig)\n\n| Agent | Role | Persistence |\n|-------|------|-------------|\n| **Mayor** | Global coordinator, handles cross-rig communication and escalations | Persistent |\n| **Deacon** | Daemon beacon - receives heartbeats, runs plugins and monitoring | Persistent |\n| **Dogs** | Long-running workers for cross-rig batch work | Variable |\n\n### Rig-Level Agents (Per-Project)\n\n| Agent | Role | Persistence |\n|-------|------|-------------|\n| **Witness** | Monitors polecat health, handles nudging and cleanup | Persistent |\n| **Refinery** | Processes merge queue, runs verification | Persistent |\n| **Polecats** | Ephemeral workers assigned to specific issues | Ephemeral |\n\n## Directory Structure\n\n```\n~/gt/                           Town root\nâ”œâ”€â”€ .beads/                     Town-level beads (hq-* prefix)\nâ”‚   â”œâ”€â”€ config.yaml             Beads configuration\nâ”‚   â”œâ”€â”€ issues.jsonl            Town issues (mail, agents, convoys)\nâ”‚   â””â”€â”€ routes.jsonl            Prefix â†’ rig routing table\nâ”œâ”€â”€ mayor/                      Mayor config\nâ”‚   â””â”€â”€ town.json               Town configuration\nâ””â”€â”€ <rig>/                      Project container (NOT a git clone)\n    â”œâ”€â”€ config.json             Rig identity and beads prefix\n    â”œâ”€â”€ mayor/rig/              Canonical clone (beads live here)\n    â”‚   â””â”€â”€ .beads/             Rig-level beads database\n    â”œâ”€â”€ refinery/rig/           Worktree from mayor/rig\n    â”œâ”€â”€ witness/                No clone (monitors only)\n    â”œâ”€â”€ crew/<name>/            Human workspaces (full clones)\n    â””â”€â”€ polecats/<name>/        Worker worktrees from mayor/rig\n```\n\n### Worktree Architecture\n\nPolecats and refinery are git worktrees, not full clones. This enables fast spawning\nand shared object storage. The worktree base is `mayor/rig`:\n\n```go\n// From polecat/manager.go - worktrees are based on mayor/rig\ngit worktree add -b polecat/<name>-<timestamp> polecats/<name>\n```\n\nCrew workspaces (`crew/<name>/`) are full git clones for human developers who need\nindependent repos. Polecats are ephemeral and benefit from worktree efficiency.\n\n## Beads Routing\n\nThe `routes.jsonl` file maps issue ID prefixes to rig locations (relative to town root):\n\n```jsonl\n{\"prefix\":\"hq-\",\"path\":\".\"}\n{\"prefix\":\"gt-\",\"path\":\"gastown/mayor/rig\"}\n{\"prefix\":\"bd-\",\"path\":\"beads/mayor/rig\"}\n```\n\nRoutes point to `mayor/rig` because that's where the canonical `.beads/` lives.\nThis enables transparent cross-rig beads operations:\n\n```bash\nbd show hq-mayor    # Routes to town beads (~/.gt/.beads)\nbd show gt-xyz      # Routes to gastown/mayor/rig/.beads\n```\n\n## See Also\n\n- [reference.md](../reference.md) - Command reference\n- [molecules.md](../concepts/molecules.md) - Workflow molecules\n- [identity.md](../concepts/identity.md) - Agent identity and BD_ACTOR\n","numLines":131,"startLine":1,"totalLines":131}},"sourceToolAssistantUUID":"2a2de1e0-86bd-4c71-941c-53ecee33941a"}
{"parentUuid":"2e66b4fd-9362-4306-8811-256c24329178","isSidechain":true,"userType":"external","cwd":"/Users/csells/Code/gastownhall/website","sessionId":"dc9d694e-994e-4b73-9876-59c87b636ae6","version":"2.1.12","gitBranch":"main","agentId":"af83d1f","slug":"snappy-doodling-pudding","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01RNBQo9EqZQQJnD3nQmnGB1","type":"tool_result","content":"     1â†’# The Propulsion Principle\n     2â†’\n     3â†’> **If you find something on your hook, YOU RUN IT.**\n     4â†’\n     5â†’Gas Town is a steam engine. Agents are pistons. The entire system's throughput\n     6â†’depends on one thing: when an agent finds work on their hook, they EXECUTE.\n     7â†’\n     8â†’## Why This Matters\n     9â†’\n    10â†’- There is no supervisor polling asking \"did you start yet?\"\n    11â†’- The hook IS your assignment - it was placed there deliberately\n    12â†’- Every moment you wait is a moment the engine stalls\n    13â†’- Other agents may be blocked waiting on YOUR output\n    14â†’\n    15â†’## The Handoff Contract\n    16â†’\n    17â†’When you were spawned, work was hooked for you. The system trusts that:\n    18â†’\n    19â†’1. You will find it on your hook\n    20â†’2. You will understand what it is (`bd show` / `gt hook`)\n    21â†’3. You will BEGIN IMMEDIATELY\n    22â†’\n    23â†’This isn't about being a good worker. This is physics. Steam engines don't\n    24â†’run on politeness - they run on pistons firing. You are the piston.\n    25â†’\n    26â†’## Molecule Navigation: Key Enabler\n    27â†’\n    28â†’Molecules enable propulsion by providing clear waypoints. You don't need to\n    29â†’memorize steps or wait for instructions - discover them:\n    30â†’\n    31â†’### Orientation Commands\n    32â†’\n    33â†’```bash\n    34â†’gt hook              # What's on my hook?\n    35â†’bd mol current         # Where am I in the molecule?\n    36â†’bd ready               # What step is next?\n    37â†’bd show <step-id>      # What does this step require?\n    38â†’```\n    39â†’\n    40â†’### Before/After: Step Transitions\n    41â†’\n    42â†’**The old workflow (friction):**\n    43â†’```bash\n    44â†’# Finish step 3\n    45â†’bd close gt-abc.3\n    46â†’# Figure out what's next\n    47â†’bd ready --parent=gt-abc\n    48â†’# Manually claim it\n    49â†’bd update gt-abc.4 --status=in_progress\n    50â†’# Now finally work on it\n    51â†’```\n    52â†’\n    53â†’Three commands. Context switches. Momentum lost.\n    54â†’\n    55â†’**The new workflow (propulsion):**\n    56â†’```bash\n    57â†’bd close gt-abc.3 --continue\n    58â†’```\n    59â†’\n    60â†’One command. Auto-advance. Momentum preserved.\n    61â†’\n    62â†’### The Propulsion Loop\n    63â†’\n    64â†’```\n    65â†’1. gt hook                   # What's hooked?\n    66â†’2. bd mol current             # Where am I?\n    67â†’3. Execute step\n    68â†’4. bd close <step> --continue # Close and advance\n    69â†’5. GOTO 2\n    70â†’```\n    71â†’\n    72â†’## The Failure Mode We're Preventing\n    73â†’\n    74â†’```\n    75â†’Polecat restarts with work on hook\n    76â†’  â†’ Polecat announces itself\n    77â†’  â†’ Polecat waits for confirmation\n    78â†’  â†’ Witness assumes work is progressing\n    79â†’  â†’ Nothing happens\n    80â†’  â†’ Gas Town stops\n    81â†’```\n    82â†’\n    83â†’## Startup Behavior\n    84â†’\n    85â†’1. Check hook (`gt hook`)\n    86â†’2. Work hooked â†’ EXECUTE immediately\n    87â†’3. Hook empty â†’ Check mail for attached work\n    88â†’4. Nothing anywhere â†’ ERROR: escalate to Witness\n    89â†’\n    90â†’**Note:** \"Hooked\" means work assigned to you. This triggers autonomous mode\n    91â†’even if no molecule is attached. Don't confuse with \"pinned\" which is for\n    92â†’permanent reference beads.\n    93â†’\n    94â†’## The Capability Ledger\n    95â†’\n    96â†’Every completion is recorded. Every handoff is logged. Every bead you close\n    97â†’becomes part of a permanent ledger of demonstrated capability.\n    98â†’\n    99â†’- Your work is visible\n   100â†’- Redemption is real (consistent good work builds over time)\n   101â†’- Every completion is evidence that autonomous execution works\n   102â†’- Your CV grows with every completion\n   103â†’\n   104â†’This isn't just about the current task. It's about building a track record\n   105â†’that demonstrates capability over time. Execute with care.\n   106â†’\n\n<system-reminder>\nWhenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.\n</system-reminder>\n"}]},"uuid":"65a4efc3-63e8-46b0-b619-68b7b31093f3","timestamp":"2026-01-20T16:18:38.229Z","toolUseResult":{"type":"text","file":{"filePath":"/Users/csells/Code/gastownhall/website/docs-fodder/gastown-docs/concepts/propulsion-principle.md","content":"# The Propulsion Principle\n\n> **If you find something on your hook, YOU RUN IT.**\n\nGas Town is a steam engine. Agents are pistons. The entire system's throughput\ndepends on one thing: when an agent finds work on their hook, they EXECUTE.\n\n## Why This Matters\n\n- There is no supervisor polling asking \"did you start yet?\"\n- The hook IS your assignment - it was placed there deliberately\n- Every moment you wait is a moment the engine stalls\n- Other agents may be blocked waiting on YOUR output\n\n## The Handoff Contract\n\nWhen you were spawned, work was hooked for you. The system trusts that:\n\n1. You will find it on your hook\n2. You will understand what it is (`bd show` / `gt hook`)\n3. You will BEGIN IMMEDIATELY\n\nThis isn't about being a good worker. This is physics. Steam engines don't\nrun on politeness - they run on pistons firing. You are the piston.\n\n## Molecule Navigation: Key Enabler\n\nMolecules enable propulsion by providing clear waypoints. You don't need to\nmemorize steps or wait for instructions - discover them:\n\n### Orientation Commands\n\n```bash\ngt hook              # What's on my hook?\nbd mol current         # Where am I in the molecule?\nbd ready               # What step is next?\nbd show <step-id>      # What does this step require?\n```\n\n### Before/After: Step Transitions\n\n**The old workflow (friction):**\n```bash\n# Finish step 3\nbd close gt-abc.3\n# Figure out what's next\nbd ready --parent=gt-abc\n# Manually claim it\nbd update gt-abc.4 --status=in_progress\n# Now finally work on it\n```\n\nThree commands. Context switches. Momentum lost.\n\n**The new workflow (propulsion):**\n```bash\nbd close gt-abc.3 --continue\n```\n\nOne command. Auto-advance. Momentum preserved.\n\n### The Propulsion Loop\n\n```\n1. gt hook                   # What's hooked?\n2. bd mol current             # Where am I?\n3. Execute step\n4. bd close <step> --continue # Close and advance\n5. GOTO 2\n```\n\n## The Failure Mode We're Preventing\n\n```\nPolecat restarts with work on hook\n  â†’ Polecat announces itself\n  â†’ Polecat waits for confirmation\n  â†’ Witness assumes work is progressing\n  â†’ Nothing happens\n  â†’ Gas Town stops\n```\n\n## Startup Behavior\n\n1. Check hook (`gt hook`)\n2. Work hooked â†’ EXECUTE immediately\n3. Hook empty â†’ Check mail for attached work\n4. Nothing anywhere â†’ ERROR: escalate to Witness\n\n**Note:** \"Hooked\" means work assigned to you. This triggers autonomous mode\neven if no molecule is attached. Don't confuse with \"pinned\" which is for\npermanent reference beads.\n\n## The Capability Ledger\n\nEvery completion is recorded. Every handoff is logged. Every bead you close\nbecomes part of a permanent ledger of demonstrated capability.\n\n- Your work is visible\n- Redemption is real (consistent good work builds over time)\n- Every completion is evidence that autonomous execution works\n- Your CV grows with every completion\n\nThis isn't just about the current task. It's about building a track record\nthat demonstrates capability over time. Execute with care.\n","numLines":106,"startLine":1,"totalLines":106}},"sourceToolAssistantUUID":"2e66b4fd-9362-4306-8811-256c24329178"}
{"parentUuid":"65a4efc3-63e8-46b0-b619-68b7b31093f3","isSidechain":true,"userType":"external","cwd":"/Users/csells/Code/gastownhall/website","sessionId":"dc9d694e-994e-4b73-9876-59c87b636ae6","version":"2.1.12","gitBranch":"main","agentId":"af83d1f","slug":"snappy-doodling-pudding","message":{"model":"claude-opus-4-5-20251101","id":"msg_01Rg8QafH5E5mnyiVKZcmqtx","type":"message","role":"assistant","content":[{"type":"text","text":"Now I have a thorough understanding of Gas Town. Let me create a comprehensive implementation plan.\n\n---\n\n# Implementation Plan: Building gastownhall.ai with Gas Town CLI\n\n## Executive Summary\n\nThis plan details how to build the gastownhall.ai website using Gas Town (gt CLI) to orchestrate all development work. The critical constraint is that **all code must be written by agents dispatched via gt commands** - no direct coding by the human operator.\n\n---\n\n## Phase 0: Project Setup and Gas Town Initialization\n\n### Question 1: HQ vs Rig Decision\n\n**Recommendation: Create this directory AS a Rig within an existing HQ**\n\nBased on the documentation:\n- A **Town/HQ** (`~/gt/`) is the management headquarters that coordinates ALL projects\n- A **Rig** is a project-specific container under Gas Town management\n\nSince you likely already have or will create a Gas Town HQ at `~/gt/`, the website project should be added as a rig:\n\n```bash\n# From your Gas Town HQ (e.g., ~/gt/)\ngt rig add gastownhall-website https://github.com/gastownhall/website.git\n```\n\nOr if this IS your first Gas Town project:\n```bash\n# Create the HQ first\ngt install ~/gt\n\n# Then add this project as a rig\ngt rig add website /Users/csells/Code/gastownhall/website\n```\n\n### Setup Commands Sequence\n\n1. **Initialize Gas Town HQ** (if not already done):\n   ```bash\n   gt install ~/gt --git\n   ```\n\n2. **Add the website as a rig**:\n   ```bash\n   gt rig add gastownhall-website /Users/csells/Code/gastownhall/website\n   ```\n\n3. **Initialize beads for the rig**:\n   ```bash\n   cd ~/gt/gastownhall-website/mayor/rig\n   bd init\n   ```\n\n4. **Verify setup**:\n   ```bash\n   gt doctor\n   gt status\n   ```\n\n---\n\n## Phase 1: Planning and Work Decomposition (via Mayor)\n\n### Workflow for Creating the Comprehensive Plan\n\nThe MEOW (Molecular Expression of Work) approach requires breaking work into beads that agents can execute atomically.\n\n**Step 1: Engage the Mayor for Planning**\n\n```bash\ngt may at  # Attach to Mayor session\n```\n\nThen instruct the Mayor:\n```\nI need to build the gastownhall.ai website. Here are the requirements:\n\n1. Landing page with:\n   - Headline: \"Gas Town is powerful but chaotic. We help you wrangle the chimps.\"\n   - Links to Steve's blog posts (5 posts in docs-fodder/steve-blog-posts/)\n   - Discord invite (big button CTA)\n   - X link  \n   - Link to docs sub-page\n\n2. Docs landing page showing all gastown-docs with links to sub-pages\n   - Need a \"shred\" tool/script to sync docs-fodder/gastown-docs/ into website docs section\n\n3. Infrastructure:\n   - Privacy-respecting analytics\n   - robots.txt\n   - llms.txt (generated from site contents)\n   - Basic SEO meta tags\n   - Privacy policy page\n\nPlease create a comprehensive epic with all beads needed for this project.\nFile the epic and all child beads. Use the prefix for our rig.\n```\n\n**Expected Output**: The Mayor will create beads like:\n- `gth-landing-page` (epic)\n  - `gth-landing-hero` - Hero section with headline\n  - `gth-landing-blog-links` - Blog post links section\n  - `gth-landing-cta` - Discord/X CTAs\n  - `gth-landing-nav` - Navigation to docs\n- `gth-docs-system` (epic)\n  - `gth-docs-landing` - Docs index page\n  - `gth-docs-shredder` - Tool to sync markdown docs\n  - `gth-docs-pages` - Individual doc pages\n- `gth-infrastructure` (epic)\n  - `gth-analytics` - Privacy-respecting analytics\n  - `gth-robots` - robots.txt\n  - `gth-llms-txt` - llms.txt generator\n  - `gth-seo` - Meta tags and SEO\n  - `gth-privacy-policy` - Privacy policy page\n- `gth-build-system` (epic)\n  - `gth-build-scripts` - Build scripts for src/ to deploy/\n  - `gth-testing` - Test infrastructure\n\n---\n\n## Phase 2: Creating a Formula for Website Development\n\n### Why Formulas?\n\nFormulas define reusable workflow templates. For a website build, we want a standard flow:\n1. Design component/feature\n2. Implement\n3. Test\n4. Review\n5. Document\n\n**Step 2: Create a Website Feature Formula**\n\nAsk the Mayor or a Crew member:\n```\nCreate a formula named \"mol-website-feature\" that defines our standard workflow\nfor implementing website features:\n\n1. Design: Create design spec for the feature\n2. Scaffold: Create file structure and empty components\n3. Implement: Write the actual code\n4. Style: Apply styling (CSS/Tailwind)\n5. Test: Write and run tests\n6. Review: Code review pass\n7. Document: Update any relevant docs\n\nSave it as a formula in .beads/formulas/mol-website-feature.formula.toml\n```\n\n**Expected Formula Structure** (in `.beads/formulas/mol-website-feature.formula.toml`):\n```toml\nformula = \"mol-website-feature\"\ntype = \"workflow\"\nversion = 1\ndescription = \"Standard workflow for implementing website features\"\n\n[vars.feature]\ndescription = \"The feature bead ID to implement\"\nrequired = true\n\n[[steps]]\nid = \"design\"\ntitle = \"Design {{feature}}\"\ndescription = \"Create design specification for the feature\"\n\n[[steps]]\nid = \"scaffold\"\ntitle = \"Scaffold {{feature}}\"\ndescription = \"Create file structure and empty components\"\nneeds = [\"design\"]\n\n[[steps]]\nid = \"implement\"\ntitle = \"Implement {{feature}}\"\ndescription = \"Write the actual implementation code\"\nneeds = [\"scaffold\"]\n\n[[steps]]\nid = \"style\"\ntitle = \"Style {{feature}}\"\ndescription = \"Apply visual styling\"\nneeds = [\"implement\"]\n\n[[steps]]\nid = \"test\"\ntitle = \"Test {{feature}}\"\ndescription = \"Write and execute tests\"\nneeds = [\"style\"]\n\n[[steps]]\nid = \"review\"\ntitle = \"Review {{feature}}\"\ndescription = \"Code review pass\"\nneeds = [\"test\"]\n```\n\n---\n\n## Phase 3: Getting Plan into Beads for Execution\n\n### Option A: Manual bd commands (Direct)\n\n```bash\n# Create individual beads manually\nbd create \"Landing page hero section\" --description \"...\" --type task\nbd create \"Blog post links section\" --description \"...\" --type task\n# ... etc\n```\n\n### Option B: Batch creation from markdown (Recommended)\n\nCreate a markdown file with all beads, then use `bd create -f`:\n\n1. Ask Mayor to generate a markdown file:\n```\nCreate a markdown file at tmp/website-beads.md with all the beads needed\nfor the website, formatted for bd create -f batch import.\n```\n\n2. Import:\n```bash\nbd create -f tmp/website-beads.md\n```\n\n### Option C: Let the Mayor handle it all (Easiest)\n\nSimply tell the Mayor:\n```\nFile all these as beads in our rig, creating appropriate epics and dependencies.\nThen show me the bead IDs so I can track them.\n```\n\n---\n\n## Phase 4: Executing the Plan via Polecats\n\n### Workflow: Convoys and Slinging\n\n**Step 1: Create a Convoy for the Website Build**\n\n```bash\ngt convoy create \"Gas Town Hall Website v1\" gth-landing-page gth-docs-system gth-infrastructure gth-build-system --notify overseer\n```\n\n**Step 2: Sling Work to Polecats**\n\nOption 1 - Sling individual beads:\n```bash\ngt sling gth-landing-hero gastownhall-website\ngt sling gth-docs-shredder gastownhall-website\n```\n\nOption 2 - Let the Mayor orchestrate:\n```\nSling all ready beads from the website convoy to polecats. Start with the \nfoundation work (build system, docs shredder) before the feature work.\n```\n\nOption 3 - Use formulas for structured execution:\n```bash\n# Cook the formula\nbd cook mol-website-feature\n\n# Pour a molecule for each major feature\nbd mol pour mol-website-feature --var feature=gth-landing-page\nbd mol pour mol-website-feature --var feature=gth-docs-system\n\n# Sling the molecules\ngt sling gth-landing-page-mol gastownhall-website\n```\n\n### Monitoring Progress\n\n```bash\n# Check convoy status\ngt convoy status\n\n# Check convoy list (dashboard)\ngt convoy list\n\n# Check individual bead status\nbd show gth-landing-page\n\n# Check polecat status\ngt rig status gastownhall-website\n```\n\n---\n\n## Phase 5: Testing the Website\n\n### Approach: Create Testing Beads\n\nAsk the Mayor or a Crew member:\n```\nCreate testing beads for the website:\n1. gth-test-build - Verify build process works\n2. gth-test-links - Check all links work\n3. gth-test-responsive - Test responsive design\n4. gth-test-accessibility - Basic a11y checks\n5. gth-test-seo - Verify SEO meta tags\n\nThen create a convoy for the test suite and sling it.\n```\n\n### Manual Verification Points\n\nAfter polecats complete work:\n1. Review the generated code in `src/` folder\n2. Run the build scripts to produce `deploy/` output\n3. Serve locally and manually inspect\n\n---\n\n## Phase 6: Reviewing Agent-Generated Code\n\n### Code Review Workflow\n\nGas Town has built-in code review capabilities:\n\n1. **Use Crew for Reviews**:\n   ```bash\n   gt crew at gastownhall-website/<crew-name>\n   ```\n   Then: \"Review all code in src/ for quality, consistency, and correctness\"\n\n2. **PR Sheriff Pattern** (from the docs):\n   Create a standing review bead that a crew member checks on each startup\n\n3. **Swarm Code Review**:\n   Ask the Mayor to kick off a code review convoy that files issues for any problems found\n\n---\n\n## Detailed Implementation Steps\n\n### Step-by-Step Execution Plan\n\n#### Day 1: Setup and Planning\n\n1. Initialize Gas Town HQ (if needed)\n2. Add website as a rig\n3. Attach to Mayor, describe the full project requirements\n4. Have Mayor create the epic hierarchy with all beads\n5. Document everything in `learnings.md`\n\n#### Day 2: Foundation Work\n\n1. Create convoy for foundation: build system + docs shredder\n2. Sling foundation beads to polecats\n3. Monitor and verify completion\n4. Test the build system manually\n\n#### Day 3: Core Features\n\n1. Create convoy for landing page components\n2. Sling to polecats (can parallelize hero, blog links, CTAs)\n3. Monitor the Refinery for merge conflicts\n4. Have Crew review merged code\n\n#### Day 4: Docs System\n\n1. Create convoy for docs landing + doc pages\n2. Run the shredder tool to import gastown-docs\n3. Verify all doc pages render correctly\n\n#### Day 5: Polish and Infrastructure\n\n1. Create convoy for analytics, robots.txt, llms.txt, SEO, privacy policy\n2. Sling and monitor\n3. Full integration test\n4. Final code review sweep\n\n---\n\n## Learnings to Document\n\nThe `learnings.md` file should capture:\n\n### WHY Decisions\n\n1. **Why HQ + Rig structure**: Separation of orchestration (town-level) from project work (rig-level)\n2. **Why Formulas**: Reusable workflow templates ensure consistent quality\n3. **Why Convoys**: Track related work as a unit, get notified on completion\n4. **Why Polecats vs Crew**: Polecats for well-defined tasks, Crew for design/exploration\n\n### HOW Snippets\n\n```markdown\n## Setting up the project\n\n```bash\ngt install ~/gt --git\ngt rig add gastownhall-website /path/to/website\ncd ~/gt/gastownhall-website/mayor/rig && bd init\n```\n\n## Creating beads for a feature\n\n```bash\n# Via Mayor\ngt may at\n# Then describe the feature and ask to file beads\n\n# Via direct bd commands\nbd create \"Feature name\" --description \"...\" --type task --parent gth-epic-id\n```\n\n## Slinging work to polecats\n\n```bash\n# Create a convoy first (best practice)\ngt convoy create \"Feature X\" gth-feature-a gth-feature-b\n\n# Sling individual beads\ngt sling gth-feature-a gastownhall-website\n\n# Or let Mayor orchestrate\n# \"Sling all ready work in the Feature X convoy\"\n```\n\n## Monitoring progress\n\n```bash\ngt convoy list          # Dashboard view\ngt convoy status hq-cv-xxx  # Specific convoy\nbd ready               # Ready work\ngt rig status gastownhall-website  # Rig workers\n```\n```\n\n### Working Directory Notes\n\n- **Town Root**: `~/gt/`\n- **Rig Root**: `~/gt/gastownhall-website/`\n- **Mayor's Clone**: `~/gt/gastownhall-website/mayor/rig/`\n- **Polecats Work In**: `~/gt/gastownhall-website/polecats/<name>/rig/`\n- **Crew Work In**: `~/gt/gastownhall-website/crew/<name>/rig/`\n\n---\n\n## Key Insights from Documentation\n\n### GUPP (Propulsion Principle)\n\"If there is work on your hook, YOU MUST RUN IT.\" - This is why slinging work to polecats triggers immediate execution.\n\n### MEOW Stack\n- **Beads**: Atomic work units\n- **Epics**: Beads with children\n- **Molecules**: Chained workflow beads\n- **Formulas**: Source templates for molecules\n- **Protomolecules**: Frozen templates\n- **Wisps**: Ephemeral molecules (for patrol loops)\n\n### NDI (Nondeterministic Idempotence)\nEven if polecats crash or restart, the molecule persists in beads, so work continues where it left off. The outcome is \"guaranteed\" even though the path is nondeterministic.\n\n---\n\n## Critical Files for Implementation\n\n### Critical Files for Implementation\n\n- `/Users/csells/Code/gastownhall/website/docs-fodder/gastown-docs/reference.md` - Complete CLI reference for gt and bd commands\n- `/Users/csells/Code/gastownhall/website/docs-fodder/gastown-docs/concepts/molecules.md` - How to use formulas, cook, pour, and execute molecules\n- `/Users/csells/Code/gastownhall/website/docs-fodder/gastown-docs/INSTALLING.md` - Setup instructions for gt install and rig add\n- `/Users/csells/Code/gastownhall/website/docs-fodder/gastown-docs/concepts/convoy.md` - How convoys track work and notify on completion\n- `/Users/csells/Code/gastownhall/website/docs-fodder/steve-blog-posts/Gas Town Emergency User Manual.md` - Practical workflow patterns (Crew cycling, PR Sheriff)"}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":0,"cache_creation_input_tokens":9486,"cache_read_input_tokens":65490,"cache_creation":{"ephemeral_5m_input_tokens":9486,"ephemeral_1h_input_tokens":0},"output_tokens":2,"service_tier":"standard"}},"requestId":"req_011CXJw3yD9EgYSFKDzVirD8","type":"assistant","uuid":"fa10de87-4a07-4669-86c6-7cf7e5506b5b","timestamp":"2026-01-20T16:19:53.690Z"}
